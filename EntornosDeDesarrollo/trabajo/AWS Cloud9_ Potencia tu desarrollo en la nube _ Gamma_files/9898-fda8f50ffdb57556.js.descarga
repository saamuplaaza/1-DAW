"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9898],{69232:function(e,n,t){t.d(n,{W:function(){return a}});var r=t(47457),o=t(91012),i=t(49929),s=t(52322),a=function(e){var n=e.length,t=e.idealLength,a=e.maxLength;return(0,s.jsxs)(o.x,{fontSize:"xs",color:n>=a?"red.400":"gray.500",children:[n>=a&&(0,s.jsx)(i.G,{icon:r.e7})," ",n,"/",t]})}},87796:function(e,n,t){t.d(n,{U:function(){return o},V:function(){return i}});var r=t(95148),o=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n?e||"Untitled":e?"".concat(e," | Gamma"):"Gamma"},i=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e||(n?"":r.D)}},21061:function(e,n,t){t.d(n,{Av:function(){return S},U8:function(){return k}});var r=t(95235),o=t(393),i=t(11919),s=t(2784),a=t(43997),c=t(58118),l=t(46358),d=t(13720),u=t(72043),f=t(53738),p=t(12436),h=t.n(p),x=t(73062),m=t(52322);function v(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function g(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?v(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):v(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var j=function(e){var n=e.setWidth,t=e.width,r=e.position,o=e.onClose,a=e.panelRef,l=e.initialWidth,d=e.isDragging,u=e.setIsDragging,p=(0,s.useMemo)(function(){return(0,x.n)()},[])>0&&"right"===r,v=(0,s.useState)(t),j=v[0],b=v[1],C=(0,s.useState)(null),y=C[0],O=C[1],w=h()(function(e){var n,t=Math.min(Math.max(n="left"===r?e.clientX:-((e.clientX-y)*1)+j,c.pn),c.ZQ);n<=c.Nh?(a.current.style.transitionProperty="width",a.current.style.transitionDuration="var(--chakra-transition-duration-normal)",t=0):t>c.pn&&(a.current.style.transitionProperty="",a.current.style.transitionDuration=""),a.current.style.width="".concat(t,"px")},30),k=function e(){u(!1),O(null);var t=a.current.style.width;"0px"===t?(o(),n(l)):n(parseInt(t.replace("px",""),10)),a.current.style.transitionProperty="",a.current.style.transitionDuration="",window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",e)};(0,s.useEffect)(function(){return y&&(window.addEventListener("mousemove",w),window.addEventListener("mouseup",k)),function(){window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",k)}},[y]);var S={};return S="left"===r?{right:-4,position:"absolute"}:p?{position:"relative"}:{left:-4,position:"absolute"},(0,m.jsx)(i.k,g(g({h:"100%",bg:p?"gray.200":d?"blackAlpha.200":"rgba(0,0,0,0)",w:p?2:4,justifyContent:"center",alignItems:"center",cursor:"col-resize",_hover:{bg:p?"gray.400":"blackAlpha.200"},transitionProperty:"common",transitionDuration:"normal",role:"group",onMouseDown:function(e){e.preventDefault(),u(!0),O(e.clientX),b(t)},position:"absolute",display:["none","none","none","flex"]},S),{},{children:!p&&(0,m.jsx)(f.xu,{bg:"white",borderRadius:"full",w:1,h:10,opacity:d?1:".5",transitionProperty:"common",transitionDuration:"normal",_groupHover:{opacity:1}})}))},b=t(59115);function C(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?C(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):C(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var O={ifPanelHasRoomToOpen:function(e,n){return{base:n,xl:e}}},w=function(e){var n,t=e.position,f=e.panelLifecycle,p=(0,s.useRef)(),h=(0,s.useState)(!1),x=h[0],v=h[1],g=(0,a.I0)(),C=(0,l.CG)((0,b.SL)(t)),w=(0,l.CG)((0,b.Fw)(t)),k=(0,l.CG)((0,b.CO)(t)),S=(0,l.CG)((0,b.eh)(t)),I=null!==(n=null==S?void 0:S.canCollapse)&&void 0!==n&&n,P=(0,s.useCallback)(function(){g((0,b.sR)({position:t}))},[g,t]),E=(0,s.useCallback)(function(){g((0,b.Yp)({component:S}))},[S,g]),D=(0,s.useCallback)(function(e){g((0,b.UG)({width:e,position:t})),f.emit("resize",{})},[g,f,t]),A=(0,r.Z)({zIndex:Number((0,o.dQ)("zIndices","overlay"))+1,position:O.ifPanelHasRoomToOpen("relative","fixed"),height:"100%",top:0,bottom:0},t,0);w||x||(A.transitionProperty="width",A.transitionDuration="normal"),(0,s.useEffect)(function(){var e=function(e){"width"===e.propertyName&&f.emit("resize",{})};return p.current.addEventListener("transitionend",e),function(){p.current&&p.current.removeEventListener("transitionend",e)}},[f,p]);var T=(0,d.i)(O.ifPanelHasRoomToOpen(!0,!1))||!1;return(0,s.useEffect)(function(){C&&!T&&I&&P()},[T,C,P,I]),(0,m.jsxs)(i.k,y(y({ref:p},A),{},{style:{width:C||I?k:0},maxW:"100%","data-print-hidden":!0,children:[C&&"right"===t&&(0,m.jsx)(j,{isDragging:x,setIsDragging:v,position:t,width:k,setWidth:D,panelRef:p,onClose:P,initialWidth:c.Ld}),(0,m.jsx)(u.Mn.Provider,{value:f,children:S&&(C||I)&&(0,m.jsx)(S,{isDragging:x,isOpen:C,closePanel:P,openPanel:E,panelRef:p,lifecycle:f,hasRoomToOpen:T})}),C&&"left"===t&&(0,m.jsx)(j,{isDragging:x,setIsDragging:v,position:t,width:k,setWidth:D,panelRef:p,onClose:P,initialWidth:c.X9})]}))},k=(0,s.memo)(function(e){return(0,m.jsx)(w,y({position:"right"},e))});k.displayName="RightPanelContainer";var S=(0,s.memo)(function(e){return(0,m.jsx)(w,y({position:"left"},e))});S.displayName="LeftPanelContainer"},53923:function(e,n,t){t.d(n,{Pp:function(){return d},UV:function(){return l},Xy:function(){return u},nO:function(){return c}});var r=t(2784),o=t(43997),i=t(46358),s=t(72043),a=t(59115),c=function(){return(0,i.CG)((0,a.CO)("left"))},l=function(){return(0,i.CG)((0,a.CO)("right"))},d=function(e){var n=e.panelPosition,t=(0,o.I0)(),s=(0,i.CG)((0,a.OC)(e)),c=(0,r.useCallback)(function(){t((0,a.uJ)({component:e}))},[e,t]);return{togglePanel:(0,r.useCallback)(function(r){var o=!s;(null==r?void 0:r.override)==="open"?o=!0:(null==r?void 0:r.override)==="closed"&&(o=!1),o?t((0,a.Yp)({component:e,disableTransition:!!(null==r?void 0:r.disableTransition)})):t((0,a.sR)({position:n}))},[e,n,s,t]),initPanel:c,isPanelOpen:s}},u=function(){var e=(0,r.useMemo)(function(){return new s.st},[]),n=(0,r.useMemo)(function(){return new s.st},[]),t=(0,r.useMemo)(function(){return new s.st},[]);return(0,r.useEffect)(function(){if(t&&e&&n){var r=e.pipe(t),o=n.pipe(t);return function(){r(),o()}}},[e,n,t]),{leftPanelLifecycle:e,rightPanelLifecycle:n,globalPanelLifecycle:t}}},97873:function(e,n,t){t.d(n,{q:function(){return w}});var r=t(95235),o=t(20406),i=t(81333),s=t(31145),a=t(76035),c=t(28526),l=t.n(c),d=t(55452),u=t(55479),f=t(53738),p=t(8283),h=t(91012),x=t(45650),m=t(97907),v=t(49929),g=t(2784),j=t(21010),b=t(42879),C=t(52322);function y(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function O(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?y(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):y(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var w=function(e){var n,t,r,c,y=e.doc,w=e.site,k=e.path,S=(0,u.p)(),I=(0,j.zU5)(),P=(0,i.Z)(I,1)[0],E=(0,j.sIg)(),D=(0,i.Z)(E,1)[0],A=(0,j.odt)(),T=(0,i.Z)(A,1)[0],_=(0,j.L24)(),R=(0,i.Z)(_,1)[0],L=(0,j.kui)(),z=(0,i.Z)(L,2),M=z[0],G=z[1].loading,N=(0,j.V$$)(),Z=(0,i.Z)(N,2),F=Z[0],W=Z[1].loading,U=null==y?void 0:y.id,V=null==y?void 0:null===(r=y.organization)||void 0===r?void 0:r.id,B=(0,b.mn)({domain:null==w?void 0:null===(c=w.domains)||void 0===c?void 0:c[0],path:k}),H=null==w?void 0:w.id,q=(0,g.useCallback)((0,o.Z)(l().mark(function e(){return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(U){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,b.iL)(U);case 4:return e.next=6,D({variables:{id:U},refetchQueries:["GetDoc"]}).then(function(){S({render:function(){return(0,C.jsx)(f.xu,{color:"white",p:3,bg:"green.500",shadow:"md",borderRadius:"md",children:(0,C.jsxs)(p.U,{spacing:4,children:[(0,C.jsx)(f.xu,{children:(0,C.jsx)(v.G,{icon:a.faCircleCheck})}),(0,C.jsx)(h.x,{fontWeight:"semibold",children:"Your changes have been published."}),B&&(0,C.jsx)(x.z,{variant:"plain",as:"a",target:"_blank",_hover:{textDecoration:"none",color:"trueblue.500"},href:B,rightIcon:(0,C.jsx)(v.G,{icon:s.faArrowUpRightFromSquare}),children:"View site"}),(0,C.jsx)(m.P,{onClick:function(){return S.closeAll()}})]})})},status:"success",position:"top",duration:5e3,isClosable:!0})}).catch(function(e){S({title:(0,C.jsx)(d.cC,{id:"DD5mqk"}),status:"error",position:"top",isClosable:!0}),console.error("Error publishing site:",e.message)});case 6:case"end":return e.stop()}},e)})),[U,D,S,B]);return{publishSite:(0,g.useCallback)((0,o.Z)(l().mark(function e(){return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(H){e.next=2;break}return e.abrupt("return");case 2:if(!U){e.next=5;break}return e.next=5,(0,b.iL)(U);case 5:return e.next=7,P({variables:{id:H},update:function(e,n){var t=n.data,r=null==t?void 0:t.publishSite;r&&r.routes.forEach(function(n){e.updateQuery({query:j.yE1,variables:{id:n.docId}},function(e){var t,r,o;return(e||console.log("%c Publish doc _data is undefined or null","color: red; font-size: 16px"),null!=e&&e.doc)?{doc:O(O({},e.doc),{},{publishedTime:null===(t=n.doc)||void 0===t?void 0:t.publishedTime,publishedSnapshotId:null===(r=n.doc)||void 0===r?void 0:r.publishedSnapshotId,currentSnapshotId:null===(o=n.doc)||void 0===o?void 0:o.currentSnapshotId})}:e})})}}).then(function(){S({render:function(){return(0,C.jsx)(f.xu,{color:"white",p:3,bg:"green.500",shadow:"md",borderRadius:"md",children:(0,C.jsxs)(p.U,{spacing:4,children:[(0,C.jsx)(f.xu,{children:(0,C.jsx)(v.G,{icon:a.faCircleCheck})}),(0,C.jsx)(h.x,{fontWeight:"semibold",children:"Your changes have been published."}),B&&(0,C.jsx)(x.z,{variant:"plain",as:"a",target:"_blank",_hover:{textDecoration:"none",color:"trueblue.500"},href:B,rightIcon:(0,C.jsx)(v.G,{icon:s.faArrowUpRightFromSquare}),children:"View site"}),(0,C.jsx)(m.P,{onClick:function(){return S.closeAll()}})]})})},status:"success",position:"top",duration:5e3,isClosable:!0})}).catch(function(e){S({title:(0,C.jsx)(d.cC,{id:"DD5mqk"}),status:"error",position:"top",isClosable:!0}),console.error("Error publishing site:",e.message)});case 7:case"end":return e.stop()}},e)})),[H,U,P,S,B]),publishDoc:q,addDomain:(0,g.useCallback)((n=(0,o.Z)(l().mark(function e(n){return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!H||!U)){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,M({variables:{input:{siteId:H,name:n}},refetchQueries:["GetSites","GetDoc"]});case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(2),console.error("Error adding domain:",e.t0),S({status:"error",title:(0,C.jsx)(d.cC,{id:"HugOMA"}),isClosable:!0,position:"top"});case 11:case"end":return e.stop()}},e,null,[[2,7]])})),function(e){return n.apply(this,arguments)}),[M,U,H,S]),isAddingDomain:G,createSite:(0,g.useCallback)((t=(0,o.Z)(l().mark(function e(n){return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(U){e.next=2;break}return e.abrupt("return");case 2:F({variables:{input:{workspaceId:V,name:n,routes:[]}},refetchQueries:["GetSites","GetDoc"]}).catch(function(e){console.error("Error creating site:",e.message)});case 3:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),[U,V,F]),isCreatingSite:W,unpublishDoc:(0,g.useCallback)((0,o.Z)(l().mark(function e(){var n;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!H||!U)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,R({variables:{id:U},update:function(e,n){var t=n.data,r=null==t?void 0:t.unpublishDoc;r&&e.updateQuery({query:j.yE1,variables:{id:r.id}},function(e){return null!=e&&e.doc?{doc:O(O({},e.doc),{},{publishedSnapshotId:null})}:e})}}).then(function(){return T({variables:{input:{siteId:H,routes:(0,b.kj)({docId:U,routes:(null==w?void 0:w.routes)||[],path:null})}}})}).then(function(){S({description:null!=w&&w.name?(0,C.jsx)(d.cC,{id:"Qv0Wgn",values:{0:null==w?void 0:w.name}}):(0,C.jsx)(d.cC,{id:"3fkTmP"}),status:"success",position:"top",duration:5e3,isClosable:!0})}).catch(function(e){S({title:(0,C.jsx)(d.cC,{id:"uMOlnl"}),status:"error",position:"top",isClosable:!0}),console.error("Error unpublishing site:",e.message)});case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}},e)})),[H,U,R,null==w?void 0:w.routes,null==w?void 0:w.name,T,S]),updateRoutes:(0,g.useCallback)((0,o.Z)(l().mark(function e(){var n;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!U||!H)){e.next=2;break}return e.abrupt("return");case 2:return n=(0,b.kj)({routes:(null==w?void 0:w.routes)||[],docId:U,path:k}),e.next=5,T({variables:{input:{siteId:H,routes:n}}});case 5:case"end":return e.stop()}},e)})),[T,U,null==w?void 0:w.routes,H,k])}}},42048:function(e,n,t){t.d(n,{B:function(){return D}});var r=t(55452),o=t(87254),i=t(78116),s=t(56915),a=t(16796),c=t(64827),l=t(92619),d=t(2167),u=t(80353),f=t(45650),p=t(55966),h=t(2784),x=t(95235),m=t(82269),v=t(2046),g=t(70287),j=t(60807),b=t(53738),C=t(98666),y=t(69297),O=t(52322),w=["label","initialValue","updateValue","helperText","language"];function k(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var S=function(e){var n=e.label,r=e.initialValue,o=e.updateValue,i=e.helperText,s=e.language,a=(0,m.Z)(e,w),c=(0,h.useState)(void 0===r?"":r),l=c[0],d=c[1],u=(0,h.useState)(null),f=u[0],p=u[1],S=(0,C.Kt)(o,100),I=(0,h.useState)(),P=I[0],E=I[1];(0,h.useEffect)(function(){"css"===s?Promise.all([t.e(8917),t.e(7120),t.e(6214)]).then(t.bind(t,65284)).then(function(e){E(e.css())}):"html"===s&&Promise.all([t.e(8917),t.e(7120),t.e(6214),t.e(4100),t.e(2163)]).then(t.bind(t,22163)).then(function(e){E(e.html())})},[s]),(0,C.vm)(function(){p(null),S(l)},[l,S],[l]);var D=[P].filter(Boolean);return(0,O.jsxs)(v.NI,{isInvalid:!!f,children:[(0,O.jsx)(g.l,{children:n}),f&&(0,O.jsx)(j.J1,{children:f}),i&&(0,O.jsx)(v.Q6,{children:i}),(0,O.jsx)(b.xu,{border:"1px solid",borderColor:"gray.200",fontSize:"md",position:"relative",children:(0,O.jsx)(h.Suspense,{fallback:(0,O.jsx)("span",{}),children:(0,O.jsx)(y.B,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?k(Object(t),!0).forEach(function(n){(0,x.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):k(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({value:l,extensions:D,onChange:d},a))})})]})},I=t(46358),P=t(62141),E=t(21529),D=(0,h.memo)(function(e){var n=e.isOpen,t=e.onClose,x=e.editor,m=(0,E.A)(x),v=(0,I.CG)(P.$p).bodyStart,g=(0,h.useCallback)(function(e){null==x||x.commands.updateNestedAttributesAtPos(0,{customCode:{bodyStart:e}})},[x]);return(0,O.jsx)(p.Wk,{isDark:!1,children:(0,O.jsxs)(i.d,{returnFocusOnClose:!1,isOpen:n,placement:"right",onClose:t,size:"lg",children:[(0,O.jsx)(s.Z,{background:"none"}),(0,O.jsxs)(a.s,{onKeyDown:m,"data-testid":"custom-code-drawer",motionProps:{variants:{enter:{x:"0%",transition:{duration:.2}},exit:{x:"100%",transition:{duration:.1}}}},children:[(0,O.jsx)(c.o,{}),(0,O.jsx)(l.x,{children:(0,O.jsx)(r.cC,{id:"E16GGw"})}),(0,O.jsx)(d.f,{overflowX:"hidden",children:(0,O.jsx)(S,{label:o.ag._({id:"fC5kYg"}),helperText:o.ag._({id:"0AZNtw"}),initialValue:v,updateValue:g,language:"html",height:"600px"})}),(0,O.jsx)(u.m,{children:(0,O.jsx)(f.z,{w:"100%",variant:"solid",onClick:t,children:(0,O.jsx)(r.cC,{id:"DPfwMq"})})})]})]})})});D.displayName="CustomCodeDrawer"},77005:function(e,n,t){t.d(n,{k:function(){return h}});var r=t(81333),o=t(2784),i=t(98875),s=t(46358),a=t(74418),c=t(39057),l=t(62141),d=t(93858),u=t(49392),f=t(65470);function p(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var h=function(e){var n=e.scrollingParentSelector,t=e.editor,h=(0,i.ye)("editorAnimationsEnabled"),x=(0,d._)(u.H.editorAnimationsEnabled,!1),m=(0,r.Z)(x,2),v=m[0],g=m[1],j=(0,s.CG)(function(e){return(0,l.P7)(e)&&!(0,l.hN)(e)}),b=(0,c.K)(),C=(0,s.CG)(l.nz),y=(0,s.CG)(l.Oi),O=(0,s.CG)(l.i2)||"",w=(0,o.useRef)(null),k=!C&&!y,S=h||v,I=j&&S;return(0,o.useEffect)(function(){g(h)},[h,g]),(0,o.useEffect)(function(){null==t||t.commands.enableAnimations(I)},[t,I]),(0,o.useEffect)(function(){if(b&&t&&!k){var e=document.querySelectorAll(".".concat(f.GD,", .").concat(f.VM)),r=C?(0,a.U8)(O):n;console.debug("[useAnimateOnLoad] Setting up animations:",{isPresentMode:C,isDocMode:y,presentingCardId:O,rootSelectorEl:document.querySelector(r),rootSelector:r,elements:e,editorId:t.editorId}),(null===w.current||w.current!==C&&C)&&t.commands.resetAnimationPositions(!0),w.current=C;var o=new IntersectionObserver(function(e){var n,r=[],i=function(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return p(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if("Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return p(e,n)}}(e))){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==t.return||t.return()}finally{if(a)throw i}}}}(e);try{for(i.s();!(n=i.n()).done;){var s=n.value;if(s.isIntersecting){var a=Number(s.target.getAttribute("data-pos"));a&&(0,f.jJ)(s.target);var c=a||t.view.posAtDOM(s.target,0),l=(0,f.PY)(t,c);console.debug("[useAnimateOnLoad] animate isIntersecting",{pos:c,dataPos:a,$closestAnimatablePos:l,dataAttrPos:s.target.getAttribute("data-pos")},s.target),a?r.push(a):l&&r.push(l.pos),o.unobserve(s.target)}}}catch(e){i.e(e)}finally{i.f()}t.commands.addAnimationPositions(r,C)},{root:document.querySelector(r),rootMargin:"-50px"});return e.forEach(function(e){o.observe(e)}),function(){e.forEach(function(e){o.unobserve(e)})}}},[b,t,C,k,y,O,n]),{editorAnimationsClass:I?"editor-animations-enabled":""}}},99083:function(e,n,t){t.d(n,{n:function(){return a}});var r=t(46358),o=t(3915),i=t(51823),s=t(62141),a=function(){var e,n,t=(0,r.CG)(s.yx),a=(0,o.SE)().user,c=(0,o.py)("manage",t)&&!!a,l=null==t?void 0:null===(e=t.docGenerateInput)||void 0===e?void 0:e.docGeneration;if(t&&l&&(null===(n=t.createdBy)||void 0===n?void 0:n.id)===(null==a?void 0:a.id)&&c)return(0,i.Xn)(l)}},59734:function(e,n,t){t.d(n,{_i:function(){return A._},eT:function(){return J}});var r,o,i,s,a,c=t(95235),l=t(81333),d=t(55452),u=t(55479),f=t(67904),p=t(5632),h=t(2784),x=t(23313),m=t(77381),v=t(70204),g=t(46358),j=t(10710),b=t(68941),C=t(69209),y=function(e){var n=(0,g.TL)(),t=(0,j.SE)().currentWorkspace;(0,h.useEffect)(function(){if(e)return b.VH.updateWorkspaceInLdContext(e).then(function(){n((0,C.vH)({isDocWorkspaceSet:!0}))}),function(){b.VH.updateWorkspaceInLdContext(t).then(function(){n((0,C.vH)({isDocWorkspaceSet:!1}))})}},[t,n,e])},O=t(1368),w=t(7328),k=t(57981),S=(0,k.Ps)(r||(r=(0,w.Z)(["\n  fragment DefaultCardFields on Card {\n    id\n    archived\n    docId\n    title\n    text\n    previewUrl\n    createdTime\n    updatedTime\n  }\n"])));(0,k.Ps)(o||(o=(0,w.Z)(["\n  mutation CreateCard($id: ID!, $docId: ID!) {\n    createCard(id: $id, docId: $docId) {\n      id\n    }\n  }\n"]))),(0,k.Ps)(i||(i=(0,w.Z)(["\n  ","\n  query GetCard($id: ID!, $docId: ID!) {\n    card(id: $id, docId: $docId) {\n      ...DefaultCardFields\n    }\n  }\n"])),S),(0,k.Ps)(s||(s=(0,w.Z)(["\n  ","\n  query GetCards($docId: ID!) {\n    docCards(docId: $docId, archived: false) {\n      ...DefaultCardFields\n    }\n  }\n"])),S);var I=(0,k.Ps)(a||(a=(0,w.Z)(["\n  ","\n  subscription SubscribeToCards($docId: ID!) {\n    docCards(docId: $docId) {\n      ...DefaultCardFields\n    }\n  }\n"])),S),P=t(51823),E=t(61701),D=t(68197),A=t(46732),T=t(75944),_=t(46988),R=t(20010),L=t(56915),z=t(48273),M=t(92619),G=t(64827),N=t(2167),Z=t(71354),F=t(91012),W=t(80353),U=t(76648),V=t(45650),B=t(52322),H=t(29677),q=function(e){var n,t=(null===(n=(0,g.CG)((0,_.oH)(e||"")))||void 0===n?void 0:n.status)==="running",r=(0,h.useRef)(t);r.current=t;var o=(0,h.useState)(function(){return new H.B}),i=o[0],s=o[1],a=(0,h.useCallback)(function(){i.resolve()},[i]),c=(0,T.q)(),l=c.isOpen,d=c.onOpen,u=c.onClose;return{confirmNavigationFn:(0,h.useCallback)(function(){if(!r.current)return Promise.resolve();var e=new H.B;return s(e),d(),e.promise},[d]),confirmNavigationModalProps:{isOpen:l,onClose:u,onConfirm:a}}},K=function(e){var n=e.isOpen,t=e.onClose,r=e.onConfirm;return(0,B.jsxs)(R.u_,{onClose:t,isOpen:n,isCentered:!0,children:[(0,B.jsx)(L.Z,{}),(0,B.jsxs)(z.h,{children:[(0,B.jsx)(M.x,{children:(0,B.jsx)(d.cC,{id:"YeK6T+"})}),(0,B.jsx)(G.o,{}),(0,B.jsx)(N.f,{children:(0,B.jsxs)(Z.K,{spacing:4,children:[(0,B.jsx)(F.x,{fontWeight:"bold",children:(0,B.jsx)(d.cC,{id:"Wr6Y7m"})}),(0,B.jsx)(F.x,{children:(0,B.jsx)(d.cC,{id:"n0Fn6S"})})]})}),(0,B.jsx)(W.m,{children:(0,B.jsxs)(U.h,{children:[(0,B.jsx)(V.z,{variant:"ghost",onClick:t,children:(0,B.jsx)(d.cC,{id:"dEgA5A"})}),(0,B.jsx)(V.z,{variant:"ghost",color:"red.600",onClick:r,children:(0,B.jsx)(d.cC,{id:"QxM8i/"})})]})})]})]})};function Y(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function Q(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Y(Object(t),!0).forEach(function(n){(0,c.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Y(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var X=function(e){var n=e.children,t=(0,u.p)(),r=(0,j.we)(),o=(0,g.CG)(D.XV),i=(0,j.SE)(),s=i.user,a=i.userStatus,c=(0,h.useRef)(null),b=(0,g.TL)(),C=(0,p.useRouter)(),w=C.push,k=C.replace,S=(0,g.CG)(D.yx),T=(0,P.NO)(),_=(0,l.Z)(T,3),R=_[0],L=_[1],z=_[2],M=L&&L.match(P.sg),G=M?M[0]:null,N=q(G),Z=N.confirmNavigationFn,F=N.confirmNavigationModalProps,W=(0,h.useState)({isUnauthorized:void 0,setCollaborativeEditorInstance:function(e){c.current=e,V(function(n){return Q(Q({},n),{},{editor:e})})},getCollaborativeEditorInstance:function(){return c.current},confirmNavigation:Z,editor:void 0}),U=W[0],V=W[1];(0,m.ts)(S),y(null==S?void 0:S.organization);var H=(0,x.WMx)({variables:{id:G},returnPartialData:!0,nextFetchPolicy:"cache-only"}),Y=(0,l.Z)(H,2),X=Y[0],J=Y[1],$=J.data,ee=J.loading,en=J.called,et=J.subscribeToMore,er=(0,j.py)("view",null==$?void 0:$.doc),eo=(0,j.Is)("edit",null==$?void 0:$.doc);(0,j.$K)(X),(0,h.useEffect)(function(){if(et&&U.docId&&en)return et({document:E.dU,variables:{id:U.docId},updateQuery:function(e,n){var t=n.subscriptionData;return t.data&&t.data.doc&&e.doc?{doc:Q(Q(Q({},e.doc),t.data.doc),{},{__typename:"Doc"})}:e}})},[U.docId,et,en]);var ei=(0,x.WBF)({variables:{docId:G},returnPartialData:!0,nextFetchPolicy:"cache-only"}),es=(0,l.Z)(ei,2),ea=es[0],ec=es[1],el=ec.data,ed=ec.called,eu=ec.subscribeToMore;return((0,v.p)(null==el?void 0:el.docCards,U.editor),(0,h.useEffect)(function(){if(eu&&U.docId&&ed)return eu({document:I,variables:{docId:U.docId},updateQuery:function(e,n){var t=n.subscriptionData;return t.data&&t.data.docCards?t.data:e}})},[U.docId,eu,ed]),(0,h.useEffect)(function(){if(U.docId!==G&&L){if(!G){t({id:"invalid_doc_id_error",title:(0,B.jsx)(d.cC,{id:"742lf1"}),description:"",status:"error",position:"top",isClosable:!1,duration:null});return}X(),ea(),V(function(e){return Q(Q({},e),{},{docId:G})})}},[U.docId,L,G,X,ea,b,t]),(0,h.useEffect)(function(){if("loading"!==a&&en&&!ee&&L){if(!$||!$.doc||!1===er){"loggedOut"===a&&w("/signin?redirect_to=".concat(encodeURIComponent(window.location.href))),V(function(e){return Q(Q({},e),{},{isUnauthorized:!0})});return}if($&&null===$.doc.currentSnapshotId&&eo){V(function(e){return Q(Q({},e),{},{isUnauthorized:!0})});return}if(!o&&$.doc.archived){k("/");return}V(function(e){return!1===e.isUnauthorized?e:Q(Q({},e),{},{isUnauthorized:!1})}),b((0,D.pl)({doc:$.doc}))}},[r,er,eo,$,ee,L,en,o,a,w,b,k,s]),(0,h.useEffect)(function(){return function(){b((0,D.mc)())}},[b]),(0,h.useEffect)(function(){if(S&&G){var e="".concat(S.title?"".concat((0,f.lV)(S.title),"-"):"").concat(G);L!==e&&(0,O.lO)({pathname:"".concat(R,"/").concat(e).concat(z||""),emitChange:!1})}},[S,G,L,R,z]),U.docId)?(0,B.jsxs)(A.r.Provider,{value:U,children:[n,(0,B.jsx)(K,Q({},F))]}):(0,B.jsx)(B.Fragment,{})};function J(e){return(0,h.memo)(function(n){return(0,B.jsx)(X,{children:(0,B.jsx)(e,Q({},n))})})}},30174:function(e,n,t){t.d(n,{m:function(){return s}});var r=t(11919);t(2784);var o=t(35910),i=t(52322),s=function(e){var n=e.children;return(0,i.jsxs)(r.k,{alignSelf:"stretch",position:"relative",height:"var(--100vh)",direction:"column",children:[(0,i.jsx)(o.Y,{}),n]})}},1005:function(e,n,t){t.d(n,{m:function(){return F}});var r=t(81333),o=t(55452),i=t(87254),s=t(11919),a=t(53738),c=t(94659),l=t(36895),d=t(50390),u=t(91012),f=t(55966),p=t(2784),h=t(23313),x=t(43602),m=t(9846),v=t(46358),g=t(80318),j=t(6010),b=t(62141),C=t(10710),y={src:"/_next/static/media/Sal-Fishing-2x.1a2d0290.png"},O=t(81188),w=t(83906),k=t(9088),S=t(30893),I=t(45650),P=t(40771),E=t(63849),D=t(2575),A=t(97907),T=t(65903),_=t.n(T),R=t(52322),L=function(e){var n=e.count,t=e.onClose,r=e.commentStatusFilter,a=e.setCommentStatusFilter,c=r===h.Ux9.Open?i.ag._({id:"Kz1TxG"}):i.ag._({id:"kywJax"});return(0,R.jsxs)(s.k,{width:"100%",px:6,py:4,justifyContent:"space-between",alignItems:"center",h:16,tabIndex:0,outline:"none",children:[(0,R.jsx)(d.X,{size:"md",flex:1,noOfLines:1,children:(0,R.jsx)(o.cC,{id:"eiUA4k",values:{count:n}})}),(0,R.jsxs)(k.v,{closeOnSelect:!0,children:[(0,R.jsx)(S.j,{as:I.z,size:"sm",rightIcon:(0,R.jsx)(w.v,{}),mr:8,children:_()(c)}),(0,R.jsx)(P.q,{zIndex:3,children:(0,R.jsxs)(E._,{defaultValue:r,title:i.ag._({id:"0cVgUw"}),type:"radio",children:[(0,R.jsx)(D.i,{onClick:function(){return a(h.Ux9.Open)},value:"open",children:(0,R.jsx)(o.cC,{id:"1TNIig"})}),(0,R.jsx)(D.i,{onClick:function(){return a(h.Ux9.Closed)},value:"closed",children:(0,R.jsx)(o.cC,{id:"D87pha"})})]})})]}),(0,R.jsx)(A.P,{position:"absolute",top:2,right:2,onClick:t,"data-comment-feed-close-button":!0})]})},z=t(95235),M=t(50350);function G(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?G(Object(t),!0).forEach(function(n){(0,z.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):G(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Z=function(e){var n=e.user,t=e.editor,r=(0,p.useState)(function(){var e=(0,g.W1)(t,M.Et);return e&&e.length?e[0]:(0,g.xN)(function(){return M.Et},t,"")}),o=r[0],i=r[1];(0,p.useEffect)(function(){if(o&&t)return function(){var e,n;null===(e=(n=t.commands).createDraftComment)||void 0===e||e.call(n,o)}},[o,t]);var s=(0,g.iZ)({draftComment:o,clearDraftComment:function(){o&&(null===(r=(s=t.commands).removeDraftComments)||void 0===r||r.call(s,[o]));var e,n,r,s,a=(0,g.xN)(function(){return M.Et},t,"");null===(e=(n=t.commands).createDraftComment)||void 0===e||e.call(n,a),i(a)},editor:t}),a=(0,p.useCallback)(function(e){var n=e.editor;i(function(e){return e?N(N({},e),{},{json:n.view.state.doc.toJSON(),text:n.view.state.doc.textContent}):e})},[]);return(0,R.jsx)(g.Ag,{draftComment:o,user:n,onCommentDraftUpdate:a,onCommentSave:s,commentIdToHighlight:null})},F=function(e){var n,t=e.onClose,w=e.editor,k=(0,v.CG)(b.yx),S=(0,h.$gs)().isConnected,I=(0,p.useState)(h.Ux9.Open),P=I[0],E=I[1],D=null==k?void 0:k.comments,A=null==k?void 0:null===(n=k.comments)||void 0===n?void 0:n.filter(function(e){return e.status===P}),T=(0,v.CG)(b.gh),_=(0,C.py)("comment",k)&&S,z=(0,C.SE)().user,M=(0,x.$m)(k,z),G=(0,p.useMemo)(function(){return(0,O.yd)({items:A||[],sortBy:O.Yz,latestTimeGetterFn:O.z3})},[A]);return D&&k&&w?(0,R.jsxs)(s.k,{direction:"column",h:"100%",overflowX:"hidden",className:j.G,w:"100%",children:[(0,R.jsx)(L,{commentStatusFilter:P,setCommentStatusFilter:E,count:(null==A?void 0:A.length)||0,onClose:t}),(0,R.jsxs)(s.k,{direction:"column",className:"comments-list",flex:1,overflowY:"auto",tabIndex:0,outline:"none",children:[(0,R.jsx)(m.V,{label:(0,R.jsx)(o.cC,{id:"pQvCbR"}),isConnected:S,mx:6}),M&&!z&&k&&(0,R.jsx)(g.IZ,{doc:k,accessLink:M}),_&&(0,R.jsx)(a.xu,{px:6,py:2,children:(0,R.jsx)(Z,{user:z,editor:w})}),!(null!=A&&A.length)&&(0,R.jsxs)(c.g,{align:"center",p:6,textAlign:"center",spacing:8,children:[(0,R.jsx)(a.xu,{w:"80%",maxW:"300px",mb:6,alignContent:"center",children:(0,R.jsx)(l.E,{src:y.src,width:"640px",alt:"Sal, the Gamma mascot, fishing extraterrestrially"})}),(0,R.jsxs)(a.xu,{children:[(0,R.jsx)(d.X,{size:"xs",mb:2,children:"open"===P?(0,R.jsx)(o.cC,{id:"W7i5f5"}):(0,R.jsx)(o.cC,{id:"mpDN1V"})}),(0,R.jsx)(u.x,{fontSize:"sm",children:(0,R.jsx)(o.cC,{id:"iB9OEi"})})]})]}),Object.entries(G).filter(function(e){return(0,r.Z)(e,2)[1].length}).map(function(e){var n=(0,r.Z)(e,2),o=n[0],a=n[1];return(0,R.jsxs)(s.k,{direction:"column",children:[(0,R.jsx)(f.NZ,{px:6,pt:4,pb:2,position:"sticky",top:-2,bg:"white",zIndex:2,children:{today:i.ag._({id:"ecUA8p"}),thisWeek:i.ag._({id:"yByRxz"}),earlier:i.ag._({id:"HPqZkW"})}[o]}),(0,R.jsx)(s.k,{direction:"column",children:a.map(function(e){return(0,R.jsx)(g.q5,{instanceType:"feed",userCanComment:_,editor:w,comment:e,selfUser:z,docId:null==k?void 0:k.id,editorMode:T,onClose:t,isRootComment:!0,pt:6,px:6,pb:4},e.id)})})]},o)})]})]}):null}},80405:function(e,n,t){t.d(n,{s:function(){return x}});var r=t(95235),o=t(82269),i=t(2784),s=t(56692),a=t(76903),c=t(2875),l=t(46732),d=t(1005),u=t(52322),f=["closePanel"];function p(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function h(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?p(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var x=function(e){var n=e.closePanel,t=(0,o.Z)(e,f),r=(0,l._)().editor;return(0,i.useEffect)(function(){var e=function(e){e.open&&n()};return c.pw.on(c.TI.POPUP_COMMENT_TOGGLED,e),function(){c.pw.on(c.TI.POPUP_COMMENT_TOGGLED,e)}},[n]),(0,i.useEffect)(function(){return s.F7.on("keydown","COMMENT_FEED_PANEL",function(e){return!!document.activeElement.closest('[data-panelid="comment-feed-panel"]')&&("Escape"===e.key&&n(),!0)})},[n]),(0,u.jsx)(a.s,h(h({},t),{},{bgColor:"white","data-panelid":"comment-feed-panel",children:(0,u.jsx)(d.m,{onClose:n,editor:r})}))};x.panelPosition="right"},3476:function(e,n,t){t.d(n,{Rr:function(){return ex},QK:function(){return eh}});var r=t(95235),o=t(82269),i=t(11919),s=t(87202),a=t(2784),c=t(98875),l=t(56692),d=t(76903),u=t(46358),f=t(2875),p=t(62141),h=t(46732),x=t(71961),m=t(64629),v=t(55452),g=t(71354),j=t(76648),b=t(67887),C=t(49929),y=t(55966),O=t(39097),w=t.n(O),k=t(19674),S=t(75085),I=t(30341),P=t(32333),E=t(17033),D=t(99083),A=t(9734),T=t(86733),_=t(36895),R=t(91012),L=t(45650),z=t(72360),M=t(66724),G=t(18751),N=t(88299),Z=t(52322),F=function(e){var n=e.onClose;return(0,Z.jsxs)(g.K,{flex:1,align:"center",justify:"center",p:6,spacing:6,children:[(0,Z.jsx)(_.E,{src:"https://cdn.gamma.app/zc87vhr30n8uf3n/b4b04402416f4ec8b5c1dc24f4c2a3d6/optimized/Sal-Spaceship-Riding.png",px:12}),(0,Z.jsx)(N.K,{children:(0,Z.jsx)(R.x,{children:(0,Z.jsx)(v.cC,{id:"jVQv+Q"})})}),(0,Z.jsx)(L.z,{variant:"ghost",colorScheme:"blackAlpha",leftIcon:(0,Z.jsx)(C.G,{icon:T.faXmark}),onClick:n,children:(0,Z.jsx)(v.cC,{id:"pqZJT2"})})]})},W=function(){return(0,Z.jsxs)(z.b,{status:"warning",mt:12,minH:20,flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",borderRadius:"lg",borderWidth:"1px",children:[(0,Z.jsx)(M.C,{children:(0,Z.jsx)(v.cC,{id:"rvbk/4"})}),(0,Z.jsx)(G.X,{children:(0,Z.jsx)(v.cC,{id:"XNkIFY"})})]})},U=t(12677),V=t(87254),B=t(8283),H=t(21891),q=t(25793),K=t(94659),Y=t(27191),Q=t(68740),X=t(95498),J=t(74586),$=t(21819),ee="40px",en=function(e){var n=e.value,t=e.onChange,r=e.onSubmit,o=e.isLoading,i=e.editor;e.resetMessages,(0,$.F1)(i);var s=i.state,c=s.selection,l=s.doc.textBetween(c.from,c.to,"\n"),d=(0,X.q)().hasEnoughCreditsToChat,u=(0,J.fg)(),f=(0,a.useRef)(null),p=(0,a.useState)(!1),h=p[0],x=p[1],m=c instanceof Y.qv,v=c instanceof Y.Bs,g=m&&"card"===c.node.type.name,j=c.empty||g?V.ag._({id:"XrfE9D"}):m?V.ag._({id:"CsUli9"}):v&&l?V.ag._({id:"+NPPZN",values:{0:l.length>50?l.slice(0,50)+"...":l}}):V.ag._({id:"/fY1js"}),O=(0,a.useCallback)(function(){f.current&&(f.current.style.height=ee,f.current.style.height="".concat(f.current.scrollHeight,"px"))},[]);return(0,a.useEffect)(function(){return i.on("selectionUpdate",O),function(){i.off("selectionUpdate",O)}},[i,O]),(0,a.useEffect)(function(){h?O():setTimeout(function(){x(!0),O()},400)},[h,j,O,n]),(0,Z.jsxs)(B.U,{align:"end",children:[(0,Z.jsx)(H.B,{size:"md",children:(0,Z.jsx)(q.g,{"data-gamma-child-tiptap-editor":!0,id:"ai-chat-input",h:ee,minH:ee,ref:f,resize:"none",maxH:h?32:ee,bg:"white",shadow:"md",autoFocus:!0,isDisabled:!d,placeholder:j,value:n,onKeyPress:function(e){"Enter"===e.key&&n.length>0&&!o&&(e.preventDefault(),r())},onChange:function(e){return t(e.target.value)},pr:12})}),(0,Z.jsx)(y.kH,{placement:"top",label:(0,Z.jsxs)(K.g,{spacing:0,children:[(0,Z.jsx)(R.x,{children:"Send request"}),!u&&(0,Z.jsxs)(R.x,{color:"gray.400",children:[(0,Z.jsx)(Q.J,{type:"chatSuggestion",ml:0})," if successful"]}),(0,Z.jsx)(y.f2,{shortcut:"Enter"})]}),children:(0,Z.jsx)(b.h,{"aria-label":"Send message",isDisabled:!n||o,size:"sm",h:ee,w:ee,variant:"solid",icon:(0,Z.jsx)(C.G,{icon:U.Fz,fixedWidth:!0}),onClick:r})})]})},et=t(76949),er=t(70548),eo=t(27563);function ei(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var es=function(e){var n=e.editor,t=e.scrollSelector,o=e.onClose,s=(0,a.useState)(""),l=s[0],d=s[1],f=(0,c.ye)("openAiStatus"),p=(0,u.TL)(),h=(0,I.As)("editor"),O=(0,u.qr)(),T=(0,u.CG)(er.AZ),_=(0,u.CG)(er.Q_),R=(0,a.useState)(null),L=R[0],z=R[1],M=(0,a.useCallback)(function(){return(0,er.AZ)(O.getState())},[O]),G=(0,a.useCallback)(function(e){var n=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ei(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ei(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({timestamp:Date.now()},e);p((0,er.Hz)({message:n}))},[p]),N=(0,a.useCallback)(function(){p((0,er.mc)())},[p]),U=(0,eo.n)({addMessage:G,getMessageHistory:M,editor:n}),V=U.status,B=U.sendMessage;(0,a.useEffect)(function(){var e=t&&document.querySelector(t);e&&requestAnimationFrame(function(){e.scrollTop=e.scrollHeight})},[t,T]);var H="idle"!==V;(0,a.useEffect)(function(){if(_.length&&!H){var e=_[0],n=e.task,t=e.id;!1===n.submit?d(n.message):B({message:n.message}),p((0,er.VB)({id:t}))}},[H,B,p,_]);var q=(0,a.useCallback)(function(){if(L&&n){var e=document.querySelector('[data-card-id="'.concat(L,'"]')),t=(0,I.v4)(e,100);null!=t&&t.yAxisInView||h.scrollElementIntoView({element:e})}},[n,h,L]),K=(0,a.useCallback)(function(e){q(),B({message:e})},[q,B]),Y=(0,a.useCallback)(function(){K(l),d("")},[K,l]);(0,a.useEffect)(function(){if(n){var e=function(){var e=(0,E.AQ)(n,n.state.selection.from);e&&z(e.node.attrs.id)};return e(),n.on("selectionUpdate",e),function(){n.off("selectionUpdate",e)}}},[n]);var Q=(0,D.n)();return n?"DOWN"===f?(0,Z.jsx)(F,{onClose:o}):(0,Z.jsxs)(i.k,{direction:"column",h:"100%",w:"100%",px:6,pb:2,children:["DEGRADED"===f&&(0,Z.jsx)(W,{}),(0,Z.jsx)(et.rN,{scrollSelector:t,messages:T,editor:n,sendMessage:K,isLoading:H,onClose:o}),(0,Z.jsxs)(g.K,{pos:"sticky",bottom:0,py:2,pt:4,bg:"gray.50",children:[(0,Z.jsx)(en,{editor:n,value:l,onChange:d,onSubmit:Y,isLoading:H,resetMessages:N}),(0,Z.jsx)(k.r,{modalId:"ai-credits-modal-message-list",variant:"ghost",justify:"flex-end",segmentEvent:P.AA.GAMMA_UPSELL_CALLOUT_AI_CREDITS_CHAT})]}),(0,Z.jsxs)(j.h,{position:"absolute",left:4,top:1,variant:"ghost",colorScheme:"blackAlpha",children:[(0,Z.jsx)(y.kH,{label:(0,Z.jsx)(v.cC,{id:"5eg0kp"}),placement:"top",children:(0,Z.jsx)(b.h,{color:"currentColor","aria-label":"reset-chat",icon:(0,Z.jsx)(C.G,{icon:m.Yc}),onClick:N,isRound:!0})}),Q&&(0,Z.jsx)(y.kH,{label:(0,Z.jsx)(v.cC,{id:"JrXBQr",values:{GAMMA_ARTIFACT_PROPER_NOUN:S.Yc}}),placement:"top",children:(0,Z.jsx)(b.h,{color:"currentColor","aria-label":"source-prompt",icon:(0,Z.jsx)(C.G,{icon:x.Fz}),as:w(),href:Q,target:(0,A.Q5)()?"_self":"_blank",isRound:!0})})]})]}):null},ea=t(81234),ec=t(97907),el=function(e){var n=e.onClose;return(0,Z.jsx)(i.k,{width:"100%",px:6,py:4,justifyContent:"space-between",alignItems:"center",h:8,tabIndex:0,outline:"none",position:"absolute",top:0,children:(0,Z.jsx)(ec.P,{"data-design-partner-close-button":!0,position:"absolute",top:2,right:6,zIndex:1,onClick:n})})},ed=["closePanel"];function eu(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function ef(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?eu(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):eu(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var ep="design-partner-panel-wrapper",eh=function(e){var n=e.toggleDesignPartnerPanel,t=e.isDesignPartnerPanelOpen,r=e.editor,o=(0,c.ye)("aiChat"),i=(0,u.TL)();(0,a.useEffect)(function(){return function(){i((0,er.mc)())}},[]);var d=(0,u.CG)(p.hN);(0,a.useEffect)(function(){!d&&t&&n()},[d,t,n]),(0,a.useEffect)(function(){var e,n;r&&(null===(e=(n=r.commands).setSalOpen)||void 0===e||e.call(n,t))},[r,t]),(0,a.useEffect)(function(){if(o)return ea.T.on("toggle",function(e){n(e.config)})},[n,o]),(0,a.useEffect)(function(){if(o)return f.pw.on("queueDesignPartnerTask",function(e){i((0,er.Lj)({task:e})),n({disableTransition:!1,override:"open"}),console.log("queueDesignPartnerTask",e)})},[i,o,n]),(0,a.useEffect)(function(){if(o&&d){var e=(0,s.ZP)("mod+shift+S");return l.F7.on("keydown","DESIGN_PARTNER_PANEL",function(t){return!!e(t)&&(n(),!0)})}},[n,o,d])},ex=function(e){var n=e.closePanel,t=(0,o.Z)(e,ed),r=(0,h._)().editor;return(0,a.useEffect)(function(){return l.F7.on("keydown","DESIGN_PARTNER_PANEL",function(e){return!!document.activeElement.closest('[data-panelid="design-partner-panel"]')&&"Escape"===e.key&&(n(),!0)})},[n]),(0,Z.jsx)(d.s,ef(ef({},t),{},{bgColor:"gray.50","data-panelid":"design-partner-panel",borderLeftWidth:"1px",children:(0,Z.jsxs)(i.k,{direction:"column",h:"100%",overflowY:"auto",overflowX:"hidden",className:ep,w:"100%",children:[(0,Z.jsx)(el,{onClose:n}),(0,Z.jsx)(es,{editor:r,scrollSelector:".".concat(ep),onClose:n})]})}))};ex.panelPosition="right"},92761:function(e,n,t){t.d(n,{m:function(){return $}});var r,o=t(95235),i=t(82269),s=t(55452),a=t(11919),c=t(76648),l=t(45650),d=t(84103),u=t(36895),f=t(55966),p=t(2784),h=t(75085),x=t(74586),m=t(32333),v=t(96368),g=t(59734),j=t(9734),b=t(12741),C=t(81333),y=t(73906),O=t(87254),w=t(75944),k=t(67887),S=t(55479),I=t(34638),P=t(20010),E=t(56915),D=t(48273),A=t(92619),T=t(64827),_=t(2167),R=t(71354),L=t(91012),z=t(49248),M=t(78361),G=t(49747),N=t(25793),Z=t(80353),F=t(49929),W=t(21010),U=t(93858),V=t(49392),B=t(52322),H=(r={},(0,o.Z)(r,W.pyi.Spam,{title:(0,B.jsx)(s.cC,{id:"Y5QK1F"})}),(0,o.Z)(r,W.pyi.Inappropriate,{title:(0,B.jsx)(s.cC,{id:"Zeb01n"})}),(0,o.Z)(r,W.pyi.Other,{title:(0,B.jsx)(s.cC,{id:"/IX/7x"})}),r),q=[W.pyi.Spam,W.pyi.Inappropriate,W.pyi.Other],K=function(e){var n=e.docId,t=(0,U._)(V.H.abuseReports,[]),r=(0,C.Z)(t,1)[0],o=(0,p.useState)(r.includes(n)),i=o[0],a=o[1],c=(0,w.q)({id:"report-page-modal"}),l=c.isOpen,d=c.onOpen,u=c.onClose,h=(0,p.useCallback)(function(){a(!0),u()},[u]),x=!i;return(0,B.jsxs)(B.Fragment,{children:[x&&l&&(0,B.jsx)(Y,{isOpen:!0,onClose:u,onSubmit:h}),x&&(0,B.jsx)(f.kH,{label:(0,B.jsx)(s.cC,{id:"ch68HI"}),children:(0,B.jsx)(k.h,{"aria-label":"Report this page",borderLeftWidth:"0px",color:"gray.600",variant:"plain",size:"sm",borderLeftRadius:0,icon:(0,B.jsx)(F.G,{icon:y.L1,size:"sm"}),onClick:d})})]})},Y=function(e){var n=e.isOpen,t=e.onClose,r=e.onSubmit,o=(0,U._)(V.H.abuseReports,[]),i=(0,C.Z)(o,2),a=i[0],d=i[1],u=(0,p.useState)(),h=u[0],x=u[1],m=(0,W.mvg)(),v=(0,C.Z)(m,1)[0],j=(0,p.useState)(),y=j[0],w=j[1],k=(0,S.p)(),F=(0,g._i)().docId,K=(0,p.useCallback)(function(){h&&v({variables:{input:{docId:F,reason:h,description:y}}}).then(function(){d([].concat((0,b.Z)(a),[F])),k({title:(0,B.jsx)(s.cC,{id:"7sBcV9"}),description:(0,B.jsx)(s.cC,{id:"m02YqD"}),status:"success",duration:5e3,isClosable:!0,position:"top"}),r()})},[h,v,F,y,d,a,k,r]),Y=(0,I.ff)("gray.800","gray.200");return(0,B.jsxs)(P.u_,{isOpen:n,onClose:t,trapFocus:!1,children:[(0,B.jsx)(E.Z,{}),(0,B.jsxs)(D.h,{color:Y,children:[(0,B.jsx)(A.x,{children:(0,B.jsx)(s.cC,{id:"ch68HI"})}),(0,B.jsx)(T.o,{}),(0,B.jsx)(_.f,{children:(0,B.jsxs)(R.K,{spacing:0,children:[(0,B.jsx)(L.x,{mb:6,children:(0,B.jsx)(s.cC,{id:"oNyQYO"})}),(0,B.jsx)(z.E,{onChange:function(e){x(e)},value:h,children:(0,B.jsx)(R.K,{children:q.map(function(e){var n=H[e];return(0,B.jsx)(M.Y,{value:e,children:null==n?void 0:n.title},e)})})}),(0,B.jsx)(G.U,{in:h===W.pyi.Other,children:(0,B.jsx)(N.g,{onChange:function(e){w(e.target.value)},maxLength:200,placeholder:O.ag._({id:"1ULmtx"}),mt:4})})]})}),(0,B.jsx)(Z.m,{children:(0,B.jsxs)(c.h,{children:[(0,B.jsx)(l.z,{colorScheme:"gray",onClick:t,variant:"ghost",children:(0,B.jsx)(s.cC,{id:"dEgA5A"})}),(0,B.jsx)(f.kH,{label:(0,B.jsx)(s.cC,{id:"h7+4yF"}),isDisabled:!!h,shouldWrapChildren:!0,children:(0,B.jsx)(l.z,{onClick:K,variant:"plain",colorScheme:"red.400",color:"red",_hover:{color:"red.600"},isDisabled:!h,children:(0,B.jsx)(s.cC,{id:"ovTgfk"})})})]})})]})]})},Q=["docWorkspace","forceShow","abuseReportingEnabled"];function X(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function J(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?X(Object(t),!0).forEach(function(n){(0,o.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):X(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var $=function(e){var n=e.docWorkspace,t=e.forceShow,r=e.abuseReportingEnabled,o=(0,i.Z)(e,Q),b=(0,g._i)().docId,C=(0,v.Yy)(),y=(0,m.z$)(),O=(0,p.useCallback)(function(){null==y||y.track(m.AA.MADE_WITH_GAMMA_CLICKED,{doc_id:b})},[y,b]),w=(0,x.dU)(n);return!1===(void 0!==t&&t)&&!1!==w?null:(0,B.jsx)(a.k,J(J(J({},(0,j.s2)()?{display:"flex",justifyContent:"center",m:6,position:"relative"}:{position:"fixed",right:[1,6],bottom:[1,4]}),o),{},{children:(0,B.jsx)(f.Wk,{isDark:C,children:(0,B.jsxs)(c.h,{isAttached:!0,sx:{".chakra-button":{borderRightRadius:"none","&:last-child":{borderRightRadius:"md"}}},children:[(0,B.jsx)(l.z,{as:d.r,onClick:O,variant:"plain",target:"_blank",href:"https://gamma.app/?utm_source=made-with-gamma&utm_medium=content",textDecoration:"none !important",leftIcon:(0,B.jsx)(u.E,{src:"/_next/static/media/GammaLogoGradient.43edb67f.svg",h:"1em"}),size:"sm",children:(0,B.jsx)(s.cC,{id:"vo61Ld",values:{GAMMA_PROPER_NOUN:h.N6}})}),(void 0===r||r)&&(0,B.jsx)(K,{docId:b})]})})}))}},96302:function(e,n,t){t.d(n,{VN:function(){return f},rJ:function(){return d},us:function(){return u}});var r=t(2784),o=t(98875),i=t(46358),s=t(74418),a=t(62141),c=t(14115),l="disable-card-size-animations",d=function(){var e=(0,o.ye)("autoZoomToFit"),n=(0,i.CG)(a.Kk);return null!=n?n:e},u=function(){var e=(0,i.CG)(a.i2),n=(0,r.useRef)(),t=d(),o=!c.Pv&&t;(0,r.useEffect)(function(){var t=!n.current;n.current=e;var r=t?s.nY:s.id/4;e&&o&&setTimeout(function(){document.body.classList.add(l),f(),setTimeout(function(){document.body.classList.remove(l)},s.id/2)},r)},[e,o])},f=function(){var e=(0,i.bh)(),n=document.documentElement.clientHeight,t=document.querySelector('[data-animate-value="presentCurrent"][data-card-scroll-element]');t&&(e.dispatch((0,a.Ic)({zoomLevel:1})),setTimeout(function(){var r=t.scrollHeight,o=n/r;if(c.QX)o=Math.max(n/r,.7);else{if(o<.7)return;o=Math.floor(10*o)/10}e.dispatch((0,a.Ic)({zoomLevel:o})),console.debug("[zoomPresentModeToFit] zooming",JSON.stringify({viewportHeight:n,cardHeight:r,targetZoom:o}))}))}},50376:function(e,n,t){t.d(n,{Z:function(){return en}});var r=t(81333),o=t(55452),i=t(87254),s=t(81927),a=t(8848),c=t(24798),l=t(11919),d=t(91012),u=t(4036),f=t(53738),p=t(73848),h=t(45650),x=t(55479),m=t(78116),v=t(56915),g=t(16796),j=t(64827),b=t(92619),C=t(2167),y=t(89190),O=t(80353),w=t(76648),k=t(55966),S=t(65742),I=t(31807),P=t(65903),E=t.n(P),D=t(2784),A=t(24021),T=t(23313),_=t(75085),R=t(8388),L=t(51331),z=t(49922),M=t(32333),G=t(36738),N=t(74418),Z=t(35910);function F(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var W=function(e,n){var t=[];return!function e(r){if(n(r)&&t.push(r),r.content){var o,i=function(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return F(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if("Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return F(e,n)}}(e))){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==t.return||t.return()}finally{if(a)throw i}}}}(r.content);try{for(i.s();!(o=i.n()).done;){var s=o.value;e(s)}}catch(e){i.e(e)}finally{i.f()}}}(e),t},U=t(59734),V=t(81188),B=t(67453),H=t(52322),q=function(){return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(s.O,{w:"350px",h:12}),(0,H.jsx)(a.N,{mt:3,w:64,noOfLines:1})]})},K=function(e){var n=e.createdTime,t=e.editors,r=e.isLatest,i=e.onClick,s=e.showPaywall,a=e.paywallCount;if(!t||!t.length)return(0,H.jsx)(H.Fragment,{});var p=s?"linear-gradient(rgb(0, 0, 0) 15%, transparent 100%)":"",h=(0,H.jsxs)(c.O,{flexDirection:"row",borderRadius:"base",style:{WebkitMaskImage:p,maskImage:p},border:"none",isDisabled:s,opacity:"1 !important",onClick:i,alignItems:"flex-start",width:"100%",textAlign:"left",children:[(0,H.jsxs)(l.k,{w:"100%",direction:"column",children:[(0,H.jsx)(d.x,{fontSize:"sm",children:E()((0,V.P9)(n))}),(0,H.jsx)(d.x,{fontSize:"xs",flex:1,children:t[0].displayName})]}),r&&(0,H.jsx)(u.C,{colorScheme:"green",py:"0.5",fontSize:"0.65em",children:(0,H.jsx)(o.cC,{id:"wL3cK8"})})]});return s?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(k.kH,{placement:"top",isDisabled:!s,label:s?(0,H.jsx)(o.cC,{id:"PYTBm5",values:{paywallCount:a}}):void 0,children:(0,H.jsx)(f.xu,{mb:4,children:h})}),(0,H.jsx)(z.m,{isNarrow:!0,segmentEvent:M.AA.GAMMA_PRO_UPSELL_CALLOUT_CHANGE_HISTORY,description:(0,H.jsx)(o.cC,{id:"mVKYtH"})})]}):h},Y=function(e){var n,t=(0,L.Yt)(),r=(0,D.useMemo)(function(){if("unlimited"===t)return{items:e,paywalledItems:[]};var n=parseInt(t),r=e.filter(function(e,t){return 0===t||(0,I.Z)(e.createdTime)>=new Date(Date.now()-864e5*n)}),o=e.slice(r.length,e.length),i=o.length?o[0]:null;return{items:r.concat(i?[i]:[]),paywalledItems:o}},[t,e]),o=r.items,i=r.paywalledItems;return{groupedSnapshots:(0,D.useMemo)(function(){return(0,V.yd)({items:o,sortBy:"createdTime"})},[o]),paywalledSnapshotId:null===(n=i[0])||void 0===n?void 0:n.id,paywallCount:i.length}},Q=function(e){var n=e.groupedSnapshots,t=e.paywalledSnapshotId,s=e.paywallCount,a=e.onClick,c=e.showFetchMore,l=e.onFetchMoreClick,d=e.isFetchingMore;return(0,H.jsxs)(p.t,{w:"100%",children:[Object.entries(n).filter(function(e){return(0,r.Z)(e,2)[1].length}).map(function(e,n){var o=(0,r.Z)(e,2),c=o[0],l=o[1];return(0,H.jsxs)(D.Fragment,{children:[(0,H.jsx)(k.NZ,{px:4,py:2,mx:0,mt:2,children:{today:i.ag._({id:"ecUA8p"}),thisWeek:i.ag._({id:"yByRxz"}),earlier:i.ag._({id:"HGg4T/"})}[c]}),l.map(function(e,r){var o=e.createdTime,i=e.editors,c=e.id;return(0,H.jsx)(K,{onClick:function(){return a(c)},isLatest:0===n&&0===r,createdTime:o,editors:i,showPaywall:t===c,paywallCount:s},c)})]},c)}),c&&(0,H.jsx)(h.z,{isLoading:d,onClick:l,children:(0,H.jsx)(o.cC,{id:"yQ2kGp"})})]})},X=function(){return(0,H.jsxs)(p.t,{w:"100%",children:[(0,H.jsx)(s.O,{h:16}),(0,H.jsx)(s.O,{h:16,mt:2}),(0,H.jsx)(s.O,{h:16,mt:2}),(0,H.jsx)(s.O,{h:16,mt:2}),(0,H.jsx)(s.O,{h:16,mt:2}),(0,H.jsx)(s.O,{h:16,mt:2}),(0,H.jsx)(s.O,{h:16,mt:2}),(0,H.jsx)(s.O,{h:16,mt:2})]})},J=function(e){var n=e.title,t=e.createdBy,r=e.createdTime,i=e.numSnapshots;return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(d.x,{mt:1,children:(0,H.jsx)(o.cC,{id:"yf//Op",values:{0:(0,R.Dw)(r),1:(0,R.Dw)(r),numSnapshots:i}})}),(0,H.jsx)(d.x,{color:"gray.500",fontSize:"sm",fontWeight:"normal",letterSpacing:"normal",children:(0,H.jsx)(o.cC,{id:"JVHTIo",values:{0:null!=t&&t.displayName?null==t?void 0:t.displayName:"Unknown",1:(0,R.p6)(r,"PPp"),title:n}})})]})},$="snapshot-editor-root",ee=function(e){var n=e.id,t=e.doc,r=e.content,o=(0,D.useMemo)(function(){if(r)return W(r,function(e){return e.type===N.W4}).map(function(e){var n;return{__typename:"Card",id:(null===(n=e.attrs)||void 0===n?void 0:n.id)||"",docId:t.id,title:(0,S.getCardTitle)(e),createdTime:t.createdTime,updatedTime:t.updatedTime,archived:!1}})},[r,t]);return(0,H.jsx)(G.fb,{reduxData:{cards:o},initialContent:r,doc:t,docId:t.id,scrollingParentSelector:".".concat($),isInsideDrawer:!0},n)},en=function(e){var n=e.isOpen,t=e.onClose,i=e.doc,s=(0,x.p)(),a=(0,U._i)().getCollaborativeEditorInstance,c=(0,D.useState)(!1),d=c[0],u=c[1],p=(0,T.pfN)({variables:{docId:i.id,first:25},skip:!i||!n,fetchPolicy:"network-only",nextFetchPolicy:"network-only"}),S=p.loading,I=p.data,P=p.called,E=p.fetchMore,L=(0,T.opq)({nextFetchPolicy:"cache-only"}),z=(0,r.Z)(L,2),M=z[0],G=z[1],N=G.loading,F=G.data,W=(null==I?void 0:I.snapshots.edges.map(function(e){return e.node}))||[],V=Y(W),K=V.groupedSnapshots,en=V.paywalledSnapshotId,et=V.paywallCount,er=null==I?void 0:I.snapshots.pageInfo,eo=!!(!en&&P&&(null==er?void 0:er.hasNextPage)&&(null==er?void 0:er.endCursor)),ei=(0,D.useCallback)(function(){null!=er&&er.hasNextPage&&null!=er&&er.endCursor&&(u(!0),E({variables:{after:er.endCursor}}).finally(function(){u(!1)}))},[E,null==er?void 0:er.endCursor,null==er?void 0:er.hasNextPage]),es=W[0];(0,D.useEffect)(function(){null!=es&&es.id&&M({variables:{snapshotId:es.id,docId:i.id}})},[i.id,M,null==es?void 0:es.id]);var ea=(0,B.$)(null==i?void 0:i.title),ec=null==i?void 0:i.createdBy,el=null==i?void 0:i.createdTime,ed=null==F?void 0:F.snapshot,eu=ed&&ed.id===i.currentSnapshotId;return(0,H.jsx)(k.Wk,{isDark:!1,children:(0,H.jsxs)(m.d,{placement:"bottom",onClose:t,isOpen:n,trapFocus:!0,isFullHeight:!0,blockScrollOnMount:!1,children:[(0,H.jsx)(v.Z,{}),(0,H.jsxs)(g.s,{borderTopRadius:"xl",h:"calc(var(--100vh) - 24px)",transform:"none !important",children:[(0,H.jsx)(j.o,{}),(0,H.jsxs)(b.x,{borderBottom:"1px solid #000",borderColor:"gray.200",children:[S&&(0,H.jsx)(q,{}),i&&W&&(0,H.jsx)(J,{numSnapshots:(null==W?void 0:W.length)||0,createdBy:ec,createdTime:el,title:ea})]}),(0,H.jsx)(C.f,{p:0,h:"100%",children:(0,H.jsxs)(l.k,{direction:"row",h:"100%",children:[(0,H.jsx)(f.xu,{p:2,w:"17rem",overflowY:"auto",bg:"gray.50",children:(0,H.jsxs)(y.m,{variant:"soft-rounded",orientation:"vertical",size:"md",children:[S&&(0,H.jsx)(X,{}),!S&&W&&(0,H.jsx)(Q,{onClick:function(e){M({variables:{snapshotId:e,docId:i.id}})},groupedSnapshots:K,paywalledSnapshotId:en,paywallCount:et,showFetchMore:eo,onFetchMoreClick:ei,isFetchingMore:d})]})}),(0,H.jsx)(l.k,{flex:1,bg:"gray.100",overflowY:"scroll",justifyContent:"center",alignContent:"center",alignItems:"flex-start",width:"100%",height:"100%",className:$,css:{"--editor-width":"100%"},children:(0,H.jsxs)(l.k,{direction:"column",position:"relative",width:"100%",height:"100%",children:[(0,H.jsx)(Z.Y,{}),(!ed||N)&&(0,H.jsx)(A.AA,{}),ed&&!N&&(0,H.jsx)(ee,{id:ed.id,doc:i,content:null==ed?void 0:ed.content.default})]})})]})}),(0,H.jsx)(O.m,{borderTop:"1px solid #000",borderColor:"gray.200",children:(0,H.jsxs)(w.h,{spacing:4,children:[(0,H.jsx)(h.z,{variant:"ghost",onClick:t,children:(0,H.jsx)(o.cC,{id:"dEgA5A"})}),(0,H.jsx)(k.kH,{label:eu?(0,H.jsx)(o.cC,{id:"HJo72u"}):(0,H.jsx)(o.cC,{id:"sonTm1"}),shouldWrapChildren:!0,children:(0,H.jsx)(h.z,{variant:"solid",isDisabled:!ed||eu,onClick:function(){if(ed){var e,n=null==W?void 0:null===(e=W.find(function(e){return e.id===ed.id}))||void 0===e?void 0:e.createdTime,r=a();if(r){r.commands.setContent(ed.content.default,!0);var i=ed.content.annotationsAbsolute;i?r.commands.restoreAnnotations(i):r.commands.clearAnnotations(),t(),s({title:(0,H.jsx)(o.cC,{id:"7ovf4C"}),description:(0,H.jsx)(o.cC,{id:"DTim6X",values:{0:n?(0,R.p6)(n,"PPp"):"selected snapshot",GAMMA_ARTIFACT_PROPER_NOUN:_.Yc}}),status:"success",duration:5e3,isClosable:!0})}}},children:(0,H.jsx)(o.cC,{id:"yKu/3Y"})})})]})})]})]})})}},74624:function(e,n,t){t.d(n,{U:function(){return M}});var r=t(81333),o=t(60670),i=t(54728),s=t(51434),a=t(94301),c=t(91333),l=t(10344),d=t(49929),u=t(2784),f=t(23313),p=t(26087),h=t(2875),x=t(10710),m=t(51839),v=t(23015),g=t(98666),j=t(51823),b=t(25298),C=t(53738),y=t(71354),O=t(41004),w=t(25925),k=t(6563),S=t(52322),I=(0,O.E)(C.xu),P=function(e){var n=e.commentFeedItems,t=e.editor,r=e.doc,o=e.user;return t&&o?(0,S.jsx)(y.K,{p:2,children:(0,S.jsx)(w.M,{initial:!1,children:n.map(function(e){return(0,S.jsx)(I,{layout:!0,initial:{opacity:0,scale:.85},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.85},bg:"gray.100",borderColor:"gray.200",borderWidth:"1px",borderRadius:"md",shadow:"sm",children:(0,S.jsx)(k.q,{comment:e,editor:t,selfUser:o,docId:r.id,userCanComment:!1,instanceType:"notification"},e.id)},e.id)})})}):null},E=t(95235),D=t(55479),A=t(38140),T=t(37914);function _(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function R(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?_(Object(t),!0).forEach(function(n){(0,E.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):_(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var L=function(e){return!!e.comment&&null!==e.timeout},z=function(e){var n=e.user,t=e.docId,o=e.docComments,i=void 0===o?[]:o,s=e.pauseExiration,a=void 0!==s&&s,c=e.duration,l=void 0===c?5e3:c,d=(0,D.p)(),p=null==n?void 0:n.id,h=(0,u.useMemo)(function(){if(!p)return null;var e=new A.default(T.v.KNOCK_PUBLIC_KEY);return e.authenticate(p),e},[p]),x=(0,u.useState)({}),m=x[0],v=x[1],g=(0,u.useRef)(!0),j=(0,u.useRef)(a);j.current=a,(0,u.useEffect)(function(){return function(){g.current=!1}},[]);var b=(0,u.useCallback)(function(){return v({})},[]),C=(0,u.useCallback)(function(e){v(function(n){return Object.entries(n).reduce(function(n,t){var o=(0,r.Z)(t,2),i=o[0],s=o[1];return(!0===e?-1===s.timeout:i===e)||(n[i]=s),n},{})})},[]);return(0,u.useEffect)(function(){a||C(!0)},[C,a]),(0,u.useEffect)(function(){Object.entries(m).forEach(function(e){var n=(0,r.Z)(e,2),t=n[0],o=n[1],s=o.entry;if(null===o.timeout){var a=s.data.commentId,c=null==i?void 0:i.find(function(e){return e.id===a});if(c){var d=setTimeout(function(){g.current&&(j.current?v(function(e){var n=R({},e);return n[t].timeout=-1,n}):C(t))},l);v(function(e){return R(R({},e),{},(0,E.Z)({},t,{entry:s,comment:c,timeout:d}))})}}})},[m,i,l,C]),(0,u.useEffect)(function(){if(h&&t){var e=h.feeds.initialize(T.v.KNOCK_FEED_ID,{source:"new-comment",status:"unseen"}),n=e.listenForUpdates();e.on("messages.new",function(n){var o=n.entries,i=(0,r.Z)(o,1)[0];i.data.docId===t&&(v(function(e){return R(R({},e),{},(0,E.Z)({},i.id,{entry:i,timeout:null}))}),e.markAsSeen(i).then(function(){console.debug("New notification marked as seen")}).catch(function(e){console.error("Unable to mark notification as seen",e)}))});var o=f.C9N.on("status",function(e){var n=e.isConnected,t=h.client();n?t.connectSocket():t.disconnectSocket()});return function(){o(),n()}}},[t,d,h]),{reset:b,comments:Object.values(m).filter(L).map(function(e){return e.comment})}},M=function(e){var n,t=e.toggleCommentsPanel,C=e.isCommentsPanelOpen,y=e.doc,O=e.mode,w=(0,x.SE)().user,k=(0,m._i)().editor,I=(0,g.XI)(),E=(0,r.Z)(I,2),D=E[0],A=E[1],T=z({user:w,docId:null==y?void 0:y.id,docComments:null==y?void 0:y.comments,pauseExiration:A}),_=T.comments,R=T.reset,L=!!(k&&y&&y.comments);(0,u.useEffect)(function(){if(L){var e=(0,j.sY)().commentId;e&&h.pw.emit(h.TI.OPEN_POPUP_COMMENT,{commentId:e,highlightComment:!0})}},[L]),(0,u.useEffect)(function(){(C||O===p.q.SLIDE_VIEW)&&R()},[C,R,O]);var M=!!_.length&&!C&&O!==p.q.SLIDE_VIEW,G=(null==y?void 0:null===(n=y.comments)||void 0===n?void 0:n.filter(function(e){return e.status===f.Ux9.Open}).length)||0;return(0,S.jsxs)(i.J,{isLazy:!0,lazyBehavior:"keepMounted",returnFocusOnClose:!1,isOpen:M,placement:"bottom",children:[(0,S.jsx)(s.x,{children:(0,S.jsx)(b.h,{onMouseDown:v.br,onClick:t,icon:(0,S.jsx)(d.G,{icon:o.Mz}),isActive:C,"aria-label":C?"Hide comments":"Show comments",borderRadius:5,children:G})}),(0,S.jsx)(a.h,{children:y&&(0,S.jsxs)(c.y,{bg:"white",shadow:"lg",border:"none",ref:D,children:[(0,S.jsx)(l.Q,{bg:"white"}),(0,S.jsx)(P,{editor:k,user:w,commentFeedItems:_,doc:y})]})})]})}},5735:function(e,n,t){t.d(n,{u:function(){return u}});var r=t(16686),o=t(55452),i=t(11919),s=t(49929),a=t(55966),c=t(81234),l=t(25298),d=t(52322),u=function(){return(0,d.jsx)(i.k,{children:(0,d.jsx)(a.kH,{closeOnMouseDown:!1,closeOnClick:!1,label:(0,d.jsx)(o.cC,{id:"EVnzPs"}),children:(0,d.jsx)(l.r,{"data-guider-highlight":"design-partner-button","aria-label":"Edit with AI",colorScheme:"trueblue",variant:"plain",onClick:function(){c.T.emit("toggle",{})},icon:(0,d.jsx)(s.G,{icon:r.Jy})})})})}},45390:function(e,n,t){t.d(n,{a:function(){return d}});var r=t(53738),o=t(41004),i=t(25925),s=t(46358),a=t(62141),c=t(52322),l=(0,o.E)(r.xu),d=function(){var e=(0,s.CG)(a.WI),n=(0,s.CG)(a.yn);return(0,c.jsx)(i.M,{initial:!1,children:e&&n&&(0,c.jsx)(l,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},position:"absolute",pointerEvents:"none",borderTop:"solid ".concat(4,"px ").concat(e.color),top:0,left:0,bottom:0,right:0,height:"var(--100vh)"})})}},47090:function(e,n,t){t.d(n,{T:function(){return eB}});var r=t(95235),o=t(60697),i=t(2885),s=t(47557),a=t(55452),c=t(20372),l=t(78116),d=t(56915),u=t(16796),f=t(64827),p=t(92619),h=t(2167),x=t(89190),m=t(73848),v=t(24798),g=t(53738),j=t(84520),b=t(95085),C=t(49929),y=t(55966),O=t(2784),w=t(30118),k=t(46358),S=t(2875),I=t(21529),P=t(62141),E=t(6985),D=t(81333),A=t(8097),T=t(60831),_=t(69943),R=t(97968),L=t(34302),z=t(87254),M=t(71354),G=t(40110),N=t(9088),Z=t(30893),F=t(45650),W=t(40771),U=t(63849),V=t(2575),B=t(91012),H=t(4036),q=t(8283),K=t(50390),Y=t(71193),Q=t(54336),X=t(11919),J=t(81170),$=t(52322);function ee(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function en(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ee(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ee(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var et=function(e){var n=e.updateDocSetting,t=(0,k.CG)(P.US),r=t.defaultFullBleed,o=t.defaultContentWidth,s=t.presentBackdrop,c=t.cardDimensions,l=(0,J.l)(c);return(0,$.jsxs)(M.K,{spacing:5,mt:4,divider:(0,$.jsx)(G.i,{}),children:[(0,$.jsx)(er,{title:z.ag._({id:"jBvtuq"}),description:z.ag._({id:"Q3Qdcd"}),icon:L.qn,control:(0,$.jsxs)(N.v,{isLazy:!0,children:[(0,$.jsx)(Z.j,{minW:36,textAlign:"left",as:F.z,size:"sm",variant:"plain",leftIcon:(0,$.jsx)(C.G,{icon:l.icon,fixedWidth:!0}),rightIcon:(0,$.jsx)(C.G,{icon:A.pt}),style:{marginLeft:"1rem"},children:l.label()}),(0,$.jsx)(W.q,{maxW:"400px",children:(0,$.jsx)(U._,{value:c||"fluid",type:"radio",onChange:function(e){n("cardDimensions",e)},children:Object.entries(J.b).map(function(e){var n=(0,D.Z)(e,2),t=n[0],r=n[1],o=r.label,i=r.description;return(0,$.jsxs)(V.i,{value:t,children:[(0,$.jsxs)(B.x,{children:[o(),"fluid"===t&&(0,$.jsxs)($.Fragment,{children:[" ",(0,$.jsx)(H.C,{colorScheme:"gray",ml:1,children:(0,$.jsx)(a.cC,{id:"ovBPCi"})})]})]}),(0,$.jsx)(B.x,{fontSize:"xs",color:"gray.500",children:i()})]},t)})})})]})}),(0,$.jsx)(er,{title:z.ag._({id:"lklIf1"}),description:z.ag._({id:"aJ+ISV"}),icon:R.dH,value:"lg"===o,onChange:function(e){return n("defaultContentWidth",e?"lg":void 0)}}),(0,$.jsx)(er,{title:z.ag._({id:"lsVq2Z"}),description:z.ag._({id:"u/0NJZ"}),icon:_.r9,value:"full"===r,onChange:function(e){return n("defaultFullBleed",e?"full":void 0)}}),(0,$.jsx)(er,{title:z.ag._({id:"7VfbQM"}),description:z.ag._({id:"XZHPlI"}),icon:i.UH,value:s,onChange:function(e){return n("presentBackdrop",e)}}),(0,$.jsxs)(M.K,{children:[(0,$.jsx)(B.x,{fontSize:"xs",color:"gray.600",children:(0,$.jsx)(a.cC,{id:"ymPKi7"})}),(0,$.jsxs)(q.U,{alignItems:"flex-start",spacing:"4",children:[(0,$.jsx)(ei,{label:z.ag._({id:"wl99H6"}),cardDimensions:l,isWide:"lg"===o,showBackdrop:"full"!==r,scaleCardUp:!1}),(0,$.jsx)(ei,{label:z.ag._({id:"GWjDlt"}),cardDimensions:l,isWide:"lg"===o,showBackdrop:s&&"full"!==r,scaleCardUp:!s||"full"===r})]})]})]})},er=function(e){var n=e.title,t=e.description,r=e.icon,o=e.children,i=e.helpDescription,s=e.value,a=e.onChange,c=e.control;return(0,$.jsxs)(q.U,{alignItems:"flex-start",spacing:2,children:[r&&(0,$.jsx)(B.x,{fontSize:"lg",width:8,maxW:8,children:(0,$.jsx)(C.G,{icon:r,fixedWidth:!0})}),(0,$.jsxs)(M.K,{spacing:4,flex:1,children:[(0,$.jsxs)(M.K,{spacing:1,children:[(0,$.jsxs)(K.X,{size:"sm",fontWeight:"semibold",children:[n," ",i?(0,$.jsx)(y.Yq,{label:i,ml:1}):null]}),(0,$.jsx)(B.x,{fontSize:"xs",color:"gray.600",children:t})]}),o]}),a&&(0,$.jsx)(Y.r,{isChecked:s,onChange:function(e){return a(e.target.checked)}}),c]})},eo=function(e){var n=e.hideExtraLines;return(0,$.jsxs)(M.K,{w:"100%",py:2,px:2.5,children:[(0,$.jsx)(g.xu,{w:20,h:1.5,bg:"gray.200"}),(0,$.jsxs)(q.U,{flex:"1",alignItems:"flex-start",children:[(0,$.jsx)(Q.o,{ratio:4/3,color:"gray.600",w:12,bg:"gray.200",children:(0,$.jsx)(g.xu,{fontSize:"lg",children:(0,$.jsx)(C.G,{icon:T.Vm})})}),(0,$.jsxs)(M.K,{flex:"1",spacing:"1",children:[(0,$.jsx)(g.xu,{h:1,bg:"gray.200"}),(0,$.jsx)(g.xu,{h:1,bg:"gray.200"}),(0,$.jsx)(g.xu,{h:1,bg:"gray.200"}),(0,$.jsx)(g.xu,{w:n?"80%":"100%",h:1,bg:"gray.200"}),!n&&(0,$.jsx)(g.xu,{w:"80%",h:1,bg:"gray.200"})]})]})]})},ei=function(e){var n=e.cardDimensions,t=e.showBackdrop,r=e.isWide,o=e.label,i=e.scaleCardUp,s={boxShadow:"".concat(t?"sm":""),w:"".concat(r?"85%":"65%"),mx:"auto",borderRadius:"sm",bg:"white",transform:"".concat(i?"scale(1.15)":"none")};return(0,$.jsxs)(M.K,{flex:"1",alignItems:"center",sx:{"*":{transition:"all 0.2s ease"}},spacing:1.5,maxW:"50%",mx:"auto",children:[(0,$.jsx)(X.k,{bg:t?"gray.200":"white",borderWidth:"1px",borderColor:"gray.200",width:"100%",minH:32,borderRadius:"sm",alignItems:"center",py:2,overflow:"hidden",children:n.aspectRatio?(0,$.jsx)(Q.o,en(en({},s),{},{ratio:n.aspectRatio,children:(0,$.jsx)(g.xu,{children:(0,$.jsx)(eo,{hideExtraLines:r})})})):(0,$.jsx)(M.K,en(en({},s),{},{children:(0,$.jsx)(eo,{hideExtraLines:r})}))}),(0,$.jsx)(B.x,{fontSize:"xs",color:"gray.700",children:o})]})},es=t(72360),ea=t(48322),ec=t(35634),el=t(74928),ed=t(35258),eu=function(e){var n=e.editor,t=(0,k.CG)(P.Pu),r=(0,k.CG)(P.XV),o=(0,O.useCallback)(function(e){null==n||n.commands.updateNestedAttributesAtPos(0,e)},[n]);return(0,$.jsx)(ed.o,{editor:n,background:r,updateNestedAttributes:o,defaultMessage:(0,$.jsxs)(es.b,{children:[(0,$.jsx)(ea.z,{}),(0,$.jsx)(a.cC,{id:"dyXYfJ"})]}),isDark:(0,ec.wj)(t),isValidSource:el.Rr})},ef=t(2046),ep=t(70287),eh=t(27777),ex=t(25793),em=t(69232),ev=t(23313),eg=t(65185),ej=t(87796),eb=t(51331),eC=t(78308),ey=t(52596),eO=t(85041),ew=t(55479),ek=t(93319),eS=t(21891),eI=t(92936),eP=t(79821),eE=t(76648),eD=t(60807),eA=t(84103),eT=t(67904),e_=t(74586),eR=t(13419),eL=t(42879),ez=t(68197),eM=t(47827),eG=function(e,n){var t;return null==e?void 0:null===(t=e.routes.find(function(e){return e.docId===n}))||void 0===t?void 0:t.path},eN=function(){var e=(0,ew.p)(),n=(0,eM.AA)().openPageSetup,t=(0,e_._O)(),r=(0,k.CG)(ez.yx),o=(0,k.CG)(eR.lH),i=(0,ev.qbt)(),s=(0,D.Z)(i,2),c=s[0],l=s[1].loading,d=eG(o,null==r?void 0:r.id),u=(0,O.useState)(function(){return(0,eL.es)(d||"")}),f=u[0],p=u[1],h=(0,O.useState)(function(){return(0,eL.es)(d||"")}),x=h[0],m=h[1],v=(0,eL.gT)({routes:(null==o?void 0:o.routes)||[],path:(0,eL.fJ)(f),docId:null==r?void 0:r.id}),j=!!v,b=x!==f&&!j,C=(0,O.useCallback)(function(){p(x)},[x]),y=(0,O.useCallback)(function(){if(b){if(!(null!=o&&o.id)||!(null!=r&&r.id)){console.error("Missing site or doc");return}var n=(0,eL.Is)(f);c({variables:{input:{siteId:o.id,docId:r.id,path:n}},refetchQueries:["GetSite"]}).then(function(){m((0,eL.es)(n)),p((0,eL.es)(n))}).catch(function(n){e({status:"error",title:(0,$.jsx)(a.cC,{id:"dl5vwx"}),description:n.message}),console.error("[UrlSlugForm] Error setting route",n.message)})}},[b,null==r?void 0:r.id,f,c,null==o?void 0:o.id,e]);return t?(0,$.jsxs)(M.K,{pb:6,children:[(0,$.jsx)(M.K,{direction:"row",children:(0,$.jsxs)(B.x,{children:[(0,$.jsx)(a.cC,{id:"dq8+qI"})," "]})}),(0,$.jsx)(ek.L,{}),(0,$.jsx)(M.K,{spacing:2,children:(0,$.jsx)(q.U,{spacing:1,children:(0,$.jsxs)(ef.NI,{as:"fieldset",isInvalid:j,children:[(0,$.jsx)(q.U,{children:(0,$.jsxs)(eS.B,{children:[(0,$.jsx)(eI.Ui,{children:"/"}),(0,$.jsx)(eh.I,{isDisabled:l,bg:"white",flex:2,value:f,onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),y())},onChange:function(e){p((0,eT.IR)(e.currentTarget.value))}}),(0,$.jsx)(eP.R,{in:b,unmountOnExit:!0,children:(0,$.jsx)(g.xu,{ml:2,children:(0,$.jsxs)(eE.h,{w:"100%",children:[(0,$.jsx)(F.z,{variant:"solid",isLoading:l,isDisabled:j,onClick:y,children:(0,$.jsx)(a.cC,{id:"tfDRzk"})}),(0,$.jsx)(F.z,{onClick:C,children:(0,$.jsx)(a.cC,{id:"dEgA5A"})})]})})})]})}),v?(0,$.jsx)(eD.J1,{justifyContent:"flex-end",alignItems:"flex-start",children:(0,$.jsx)(B.x,{fontSize:"xs",children:(0,$.jsx)(a.cC,{id:"DQaTdC",components:{0:(0,$.jsx)(eA.r,{textDecoration:"underline",onClick:function(){return n(v.docId,"preview")}})}})})}):(0,$.jsx)(ef.Q6,{fontSize:"sm",children:(0,$.jsx)(M.K,{alignContent:"flex-start",justifyContent:"space-between",direction:"row",w:"100%",children:(0,$.jsx)(M.K,{spacing:1,children:(0,$.jsx)(B.x,{color:"gray.500",children:(0,$.jsx)(a.cC,{id:"ZMlbHK"})})})})})]})})})]}):(0,$.jsx)($.Fragment,{})},eZ=t(98666),eF=function(e){var n=e.updateDocSetting,t=(0,k.CG)(P.US).metaDescription,r=(0,k.CG)(P.yx),o=(0,k.CG)(eg.cn),i=(0,k.CG)(eg.$4),s=(0,O.useState)(function(){return(null==r?void 0:r.title)||""}),c=s[0],l=s[1],d=(0,O.useState)(function(){return t||""}),u=d[0],f=d[1],p=(0,ev.D1_)(),h=(0,D.Z)(p,1)[0],x=(0,O.useCallback)(function(e){r&&h({variables:{id:r.id,title:e}})},[r,h]),m=(0,eZ.Kt)(x,300),v=(0,O.useCallback)(function(e){l(e.target.value.substring(0,eO.S8)),m(e.target.value.substring(0,eO.S8))},[m]),j=(0,O.useCallback)(function(e){n("metaDescription",e)},[n]),b=(0,eZ.Kt)(j,300),C=(0,k.CG)(eg.NN),y=null==C?void 0:C.previewUrl,w=(0,eb.dU)(null==r?void 0:r.organization),S=(0,ej.U)(c||o,w),I=(0,ej.V)(u||i,w);return(0,$.jsxs)(M.K,{spacing:4,children:[(0,$.jsxs)(ef.NI,{children:[(0,$.jsxs)(q.U,{justifyContent:"center",children:[(0,$.jsx)(ep.l,{flex:"1",children:(0,$.jsx)(a.cC,{id:"MHrjPM"})}),(0,$.jsx)(em.W,{length:c.length||0,idealLength:eO.si,maxLength:eO.S8})]}),(0,$.jsx)(eh.I,{value:c,placeholder:o||z.ag._({id:"bTzMt5"}),_placeholder:{opacity:1,color:"gray.500"},onKeyDown:function(e){"Enter"===e.key&&x(c)},onChange:v,"data-title-input":!0})]}),(null==r?void 0:r.site)&&(0,$.jsx)(eN,{}),(0,$.jsxs)(ef.NI,{children:[(0,$.jsxs)(q.U,{justifyContent:"center",children:[(0,$.jsx)(ep.l,{flex:"1",children:(0,$.jsx)(a.cC,{id:"Nu4oKW"})}),(0,$.jsx)(em.W,{length:u.length||0,idealLength:eO.cl,maxLength:eO.Us})]}),(0,$.jsx)(ex.g,{bg:"white",rows:4,value:u,placeholder:i||z.ag._({id:"2VBqT4"}),onChange:function(e){f(e.target.value.substring(0,eO.Us)),b(e.target.value.substring(0,eO.Us))}})]}),(0,$.jsxs)(g.xu,{p:4,pt:3,bg:"gray.100",borderRadius:"md",children:[(0,$.jsxs)(M.K,{spacing:2,mb:4,children:[(0,$.jsx)(B.x,{size:"sm",children:(0,$.jsx)(a.cC,{id:"h8sMnd"})}),(0,$.jsx)(eW,{title:S,description:I,screenshotUrl:y})]}),(0,$.jsxs)(M.K,{spacing:2,children:[(0,$.jsx)(B.x,{size:"sm",children:(0,$.jsx)(a.cC,{id:"d3xOlk"})}),(0,$.jsx)(eU,{title:S,description:I,screenshotUrl:y}),(0,$.jsx)(B.x,{fontSize:"sm",color:"gray.500",children:(0,$.jsx)(a.cC,{id:"Ubf8D8"})})]})]}),(0,$.jsx)(ey.V,{label:(0,$.jsx)(a.cC,{id:"SDyz5I"}),segmentEvent:eC.AA.GAMMA_PRO_UPSELL_PAGE_SETUP_REMOVE_WATERMARK,doc:r})]})},eW=function(e){var n=e.title,t=e.description,r=e.screenshotUrl;return(0,$.jsxs)(g.xu,{cursor:"not-allowed",bg:"white",border:"1px solid",borderColor:"gray.200",borderRadius:"md",overflow:"hidden",children:[(0,$.jsx)(Q.o,{ratio:1200/630,bg:"gray.300",borderBottom:"1px solid",borderColor:"gray.200",children:(0,$.jsx)(g.xu,{bgColor:"gray.200",bgImage:"url(".concat(r,")"),backgroundSize:"cover",position:"relative"})}),(0,$.jsxs)(M.K,{px:4,py:3,spacing:1,children:[(0,$.jsx)(B.x,{fontSize:"md",fontWeight:"bold",noOfLines:2,children:n}),(0,$.jsx)(B.x,{fontSize:"xs",noOfLines:2,children:t})]})]})},eU=function(e){var n=e.title,t=e.description;return(0,$.jsxs)(M.K,{cursor:"not-allowed",bg:"white",border:"1px solid",borderColor:"gray.200",borderRadius:"md",overflow:"hidden",px:4,py:3,spacing:1,pos:"relative",children:[(0,$.jsx)(B.x,{color:"blue.600",fontSize:"lg",lineHeight:1.3,noOfLines:2,children:n}),(0,$.jsx)(B.x,{color:"gray.700",fontSize:"sm",noOfLines:3,children:t})]})},eV=["cards","background","preview"],eB=function(e){var n=e.editor,t=(0,k.CG)(P.ke),D=(0,w.M)({id:"pageSetupDisclosure"}),A=D.isOpen,T=D.onClose,_=D.onOpen,R=(0,O.useState)(0),L=R[0],z=R[1];(0,O.useEffect)(function(){var e=function(e){z(eV.indexOf(e)),_()},n=E.T.on("openPageSetup",e),t=S.pw.on(S.TI.OPEN_PAGE_SETUP,e);return function(){n(),t()}},[_,T]);var M=(0,I.A)(n),G=(0,O.useCallback)(function(e,t){null==n||n.commands.updateNestedAttributesAtPos(0,{settings:(0,r.Z)({},e,t)})},[n]),N=(0,c.S)({base:"calc(100% - 1rem)",lg:"auto"}),Z=(0,c.S)({base:"bottom",lg:"right"})||"right";return(0,$.jsx)(y.Wk,{isDark:!1,children:(0,$.jsxs)(l.d,{returnFocusOnClose:!1,isOpen:A,placement:Z,onClose:T,size:"md",blockScrollOnMount:!1,children:[(0,$.jsx)(d.Z,{background:{base:void 0,lg:"none"}}),(0,$.jsxs)(u.s,{"data-testid":"page-setup-drawer",onKeyDown:M,h:N,borderTopRadius:{base:"xl",lg:"none"},p:0,children:[(0,$.jsx)(f.o,{}),(0,$.jsx)(p.x,{children:(0,$.jsx)(a.cC,{id:"fvaOtb"})}),(0,$.jsx)(h.f,{overflowX:"hidden",children:(0,$.jsxs)(x.m,{variant:"soft-rounded",size:"sm",isFitted:!0,isLazy:!0,index:L,onChange:z,children:[(0,$.jsxs)(m.t,{children:[(0,$.jsxs)(v.O,{children:[(0,$.jsx)(g.xu,{mr:2,children:(0,$.jsx)(C.G,{icon:s.s2})}),(0,$.jsx)(a.cC,{id:"Ccpbzh"})]}),(0,$.jsxs)(v.O,{children:[(0,$.jsx)(g.xu,{mr:2,children:(0,$.jsx)(C.G,{icon:i.UH})}),(0,$.jsx)(a.cC,{id:"GtJbUa"})]}),(0,$.jsxs)(v.O,{children:[(0,$.jsx)(g.xu,{mr:2,children:(0,$.jsx)(C.G,{icon:o.g4})}),(0,$.jsx)(a.cC,{id:"rdUucN"})]})]}),(0,$.jsxs)(j.n,{children:[(0,$.jsx)(b.x,{p:2,mt:4,children:(0,$.jsx)(et,{editor:n,updateDocSetting:G},t)}),(0,$.jsx)(b.x,{p:2,mt:4,children:(0,$.jsx)(eu,{editor:n,updateDocSetting:G},t)}),(0,$.jsx)(b.x,{p:2,mt:4,children:(0,$.jsx)(eF,{editor:n,updateDocSetting:G},t)})]})]})})]})]})})}},10939:function(e,n,t){t.d(n,{OM:function(){return w},Zd:function(){return O},rU:function(){return k}});var r=t(55452),o=t(55479),i=t(11919),s=t(12221),a=t(91012),c=t(54073),l=t.n(c),d=t(18149),u=t.n(d),f=t(2784),p=t(98621),h=t.n(p),x=t(53923),m=t(46358),v=t(30341),g=t(62141),j=t(95472),b=t(59131),C=t(17477),y=t(52322),O=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"body",t=(0,m.TL)(),r=(0,v.As)("editor"),o=(0,x.nO)(),i=(0,m.CG)(g.yn,u()),s=(0,m.CG)(g.k8,u()),a=!!(null==s?void 0:s.pos);(0,f.useEffect)(function(){if(e){var n=l()(function(){i&&t((0,g.Qx)({attached:!1}))},500,{leading:!0}),r=(0,C.B$)({topOffset:100,requiredCookie:"spotlightScrollDebug=true"});return document.addEventListener("wheel",n,!0),function(){r(),n.cancel(),document.removeEventListener("wheel",n,!0)}}},[e,t,i,a,n]);var c=(0,m.CG)(g.ks,u());(0,f.useEffect)(function(){if(e&&!c){var n=l()(function(){if(!r.inProgress){var n=(0,j.lI)(e,100,o);if(!n){console.debug("[useHandleScrollAndSelectionChange][handleScroll] Unable to find topPosPct.");return}t((0,g.Us)(n))}},250,{trailing:!0,maxWait:500}),i=l()(function(){if(!(e.state.selection instanceof b.c)){var n=document.querySelector(r.scrollSelector||""),o=null==n?void 0:n.getBoundingClientRect(),i=e.state.selection.from,s=(0,j.Sh)(e,i);if(!n||!o||!s){console.debug("[useHandleScrollAndSelectionChange][handleSelectionChange] missing data",{domNodeToUse:s});return}var a=s.getBoundingClientRect(),c=parseFloat(((e.view.coordsAtPos(i).top-a.y)/a.height).toFixed(2));t((0,g.Us)({pos:i,pct:c}))}},250,{trailing:!0,maxWait:500});return n(),e.on("selectionUpdate",i),window.addEventListener("scroll",n,!0),function(){e.off("selectionUpdate",i),window.removeEventListener("scroll",n,!0)}}},[e,t,r,c,o])},w=function(){var e=(0,o.p)(),n=(0,m.TL)();return(0,f.useCallback)(function(t){var o=t.collaborator,c=t.localIsFollowing,l=t.localIsAttached,d={attached:!0};c?l?d.following=null:e.closeAll():(d.following=o.sessionId,e.closeAll(),e({duration:2e3,position:"bottom",render:function(){return(0,y.jsxs)(i.k,{bg:"gray.50",p:3,px:6,align:"center",borderRadius:"md",shadow:"md",children:[(0,y.jsx)(s.q,{size:"sm",src:o.profileImageUrl,border:"solid 2px ".concat(o.color),color:h()(o.color).isDark()?"white":"black",bg:o.color}),(0,y.jsx)(a.x,{ml:2,children:(0,y.jsx)(r.cC,{id:"lULvWe",values:{0:o.name}})})]})}})),console.debug("[CollaboratorsPanel] Clicked on collaborator ".concat(o.name,". Setting following to ").concat(d)),n((0,g.Qx)(d))},[e,n])},k=function(e){var n=e.editor,t=e.collaborators,r=e.user,o=(0,f.useRef)(!1),i=w(),s=new URLSearchParams(window.location.search),a=s.get("following_id"),c=s.get("follow_on_start");(0,f.useEffect)(function(){if(!o.current&&c&&(null==r?void 0:r.id)!==a&&n){var e=t.find(function(e){return e.id===a});e&&(i({collaborator:e,localIsAttached:!1,localIsFollowing:!1}),o.current=!0)}},[a,c,n,t,r,i])}},34684:function(e,n,t){t.d(n,{J:function(){return C},P:function(){return b}});var r=t(55452),o=t(55479),i=t(87202),s=t(2784),a=t(46358),c=t(30341),l=t(47592),d=t(34264),u=t(42734),f=t(47191),p=t(62141),h=t(95472),x=t(51839),m=t(17477),v=t(52322),g=(0,i.ZP)("mod+S"),j=(0,i.ZP)("mod+shift+O"),b=function(){var e=(0,o.p)();(0,s.useEffect)(function(){var n=function(n){g(n)&&(n.preventDefault(),e.isActive("save_toast")||e({id:"save_toast",title:(0,v.jsx)(r.cC,{id:"4ebE67"}),status:"success",duration:5e3,isClosable:!0}))},t=(0,m.B$)({requiredCookie:"cardCollapseDebug=true"});return window.addEventListener("keydown",n),function(){null==t||t(),window.removeEventListener("keydown",n)}},[e])},C=function(){var e=(0,a.qr)(),n=(0,a.TL)(),t=(0,x._i)().editor;(0,s.useEffect)(function(){if(t){var r=function(r){if(j(r)){r.preventDefault();var o=e.getState(),i=o.TipTap,s=i.cardIdMap,a=i.cardIds,c=i.memoState.expandedCards,d=(0,p.i2)(o),u=a.reduce(function(e,n){var t=!0===c[n],r=s.parents[n]||[],o=r.length>0,i=!d||r.includes(d);return o&&i&&(e.cardIds.push(n),e.total++,e.expanded+=t?1:0),e},{total:0,expanded:0,cardIds:[]}),f=u.total,h=u.expanded,x=u.cardIds;n((0,p.bj)({disable:!0})),setTimeout(function(){n((0,p.bj)({disable:!1}))},100);var m=f===h;y(t,100,!m),(0,l.Nn)(x,m)}};return window.addEventListener("keydown",r),function(){window.removeEventListener("keydown",r)}}},[n,e,t])},y=function(e,n,t){for(var r=(0,c.cC)("editor"),o=void 0,i=200;i>0;i-=25){var s,a=(0,h.Je)(e,r.scrollSelector,i);if(null!==(s=a.pos)&&void 0!==s&&s.pos){var l=void 0;e.state.doc.nodeAt(a.pos.pos)?l=a.pos.pos:e.state.doc.nodeAt(a.pos.inside)&&(l=a.pos.inside),l&&(!o||l>o)&&(o=l)}}if(!o){console.warn("[pinPageDuringAnimation] No result for getTopCenterIshNode");return}var d=O(e,o,t);if(!d){console.warn("[pinPageDuringAnimation] No element for getElementToPin");return}(0,m.wO)({element:d,requiredCookie:"cardCollapseDebug=true"});var u=+new Date,f=r.scroller.scrollTop,p=(0,m.LY)(d,r.scrollSelector),x=f-p,v=x<0?0:Math.max(x+200,0);!function e(){if(d){var t=(0,m.LY)(d,r.scrollSelector);r.scroller.scroll({top:f+(t-p-v)}),+new Date-u<n&&requestAnimationFrame(e)}}()},O=function(e,n,t){var r,o=e.state.doc.resolve(n),i=e.state.doc.nodeAt(n),s=(0,h.Sh)(e,n);if(!i){console.warn("[getElementToPin] nodeAt null for $pos",o);return}var a=(0,h.nv)(o,function(){return!0}).reverse();for(a.push({start:o.start(o.depth+1),pos:n,depth:o.depth,node:i});a.length;){var c=a.shift();if(c){var l=(0,d.KH)(c.node),p=(0,u.SA)(c.node),x=(0,f.CU)(c.node),m=l||c.node.isAtom?c.pos:c.start;if(s=(0,h.Sh)(e,m),!t&&l&&c.depth>2||p||x)break}}for(;(null===(r=s)||void 0===r?void 0:r.offsetParent)===null&&s.parentElement;)s=s.parentElement;return s}},28615:function(e,n,t){t.d(n,{j:function(){return h}});var r=t(5632),o=t(2784),i=t(1368),s=t(46358),a=t(74418),c=t(28463),l=t(62141),d=t(26087),u=t(43227),f=t(59734),p=t(51823),h=function(){var e=(0,f._i)().editor,n=(0,r.useRouter)(),t=(0,s.qr)();(0,o.useEffect)(function(){if(e){n.beforePopState(function(e){return!e.as.startsWith("/docs/")});var r=i.fI.on("changed",function(n){var r,o=(0,p.sY)(n.url).cardId,i=t.getState(),s=(0,l.gh)(i);if(console.debug("[useHandleCardHash][handleURLChange]",{payload:n,cardId:o}),s===d.q.DOC_VIEW&&null!==(r=n.state)&&void 0!==r&&r.fromPos&&"pop"===n.method){var u=n.state,f=u.fromPos,h=u.fromPct;e.chain().scrollToPositionInCard(f,h||void 0).command(function(e){var n=e.tr;return(0,c.B0)(f)(n),!0}).run()}else{var x=(0,l.xb)(i)[0];(0,a.YS)({cardId:o||x,editor:e})}});return function(){n.beforePopState(function(){return!0}),r()}}},[e,n,t]),(0,o.useEffect)(function(){if(e){var n=(0,p.sY)(window.location.href).cardId;n&&(0,u.D)({cardId:n,method:"replace"})}},[e])}},51839:function(e,n,t){t.d(n,{dM:function(){return uE},Ur:function(){return ud},nz:function(){return uY},_i:function(){return td._i}});var r,o,i,s,a,c,l,d,u,f=t(95235),p=t(93812),h=t(55452),x=t(87254),m=t(11919),v=t(91012),g=t(53738),j=t(34676),b=t(49929),C=t(55966),y=t(97729),O=t.n(y),w=t(2784),k=t(43997),S=t(23313),I=t(43602),P=t(64288),E=t(87796),D=t(11197),A=t(81333),T=t(29106),_=t(75944),R=t(54728),L=t(51434),z=t(67887),M=t(91333),G=t(83897),N=t(96412),Z=t(13089),F=t(41701),W=t(90129),U=t(29017),V=t(48200),B=t(30733),H=t.n(B),q=t(12436),K=t.n(q),Y=function(e){(0,W.Z)(r,e);var n,t=(n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=(0,V.Z)(r);if(n){var o=(0,V.Z)(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return(0,U.Z)(this,e)});function r(){var e;return(0,N.Z)(this,r),e=t.call(this),(0,f.Z)((0,F.Z)(e),"throttled",void 0),e.throttled=K()(function(n){e.emit("move",n)},200,{leading:!0}),document.addEventListener("mousemove",e.throttled),e}return(0,Z.Z)(r,[{key:"cleanup",value:function(){document.removeEventListener("mousemove",this.throttled)}}]),r}(t(98555).v),Q=H()(function(){return new Y}),X=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=Q(),r=(0,w.useState)(!1),o=r[0],i=r[1],s=(0,w.useRef)(n);return(0,w.useEffect)(function(){s.current=n},[n]),(0,w.useEffect)(function(){return t.on("move",function(n){s.current||i(e(n))})},[t,e]),o},J=t(46358),$=t(62141),ee=t(93858),en=t(49392),et=t(8812),er=t(17815),eo=t(35232),ei=t(63613),es=t(80891),ea=t(61374),ec=t(8283),el=t(96530),ed=t(71354),eu=t(50390),ef=t(5766),ep=t(40110),eh=t(45650),ex=t(52322),em=function(e){var n=e.label,t=e.shortcuts;return(0,ex.jsxs)(ec.U,{children:[t.map(function(e,n){return(0,ex.jsx)(el.T,{padding:1,children:e},n)}),(0,ex.jsx)(v.x,{fontSize:"sm",fontWeight:"medium",whiteSpace:"nowrap",children:n})]})},ev=function(e){var n=e.onClose;return(0,ex.jsx)(g.xu,{children:(0,ex.jsxs)(ed.K,{spacing:6,children:[(0,ex.jsxs)(ed.K,{spacing:1,children:[(0,ex.jsxs)(ec.U,{color:"gray.500",children:[(0,ex.jsx)(b.G,{icon:T.UF})," ",(0,ex.jsx)(eu.X,{size:"xs",fontWeight:"normal",children:(0,ex.jsx)(h.cC,{id:"h7MgpO"})})]}),(0,ex.jsx)(eu.X,{size:"md",children:(0,ex.jsx)(h.cC,{id:"UodEcE"})})]}),(0,ex.jsxs)(ef.M,{spacing:3,columns:1,children:[(0,ex.jsx)(em,{label:(0,ex.jsx)(h.cC,{id:"9xCxY6"}),shortcuts:[(0,ex.jsx)(b.G,{icon:ea.ac},"left"),(0,ex.jsx)(b.G,{icon:es.eF},"right")]}),(0,ex.jsx)(em,{label:(0,ex.jsx)(h.cC,{id:"IkakN2"}),shortcuts:["Esc"]}),(0,ex.jsx)(em,{label:(0,ex.jsx)(h.cC,{id:"K0Oq/D"}),shortcuts:["R"]}),(0,ex.jsx)(ep.i,{borderColor:"gray.300"}),(0,ex.jsx)(em,{label:(0,ex.jsx)(h.cC,{id:"CgmvBu"}),shortcuts:["S"]}),(0,ex.jsx)(em,{label:(0,ex.jsx)(h.cC,{id:"/5i2oX"}),shortcuts:[(0,ex.jsx)(b.G,{icon:ei.FP},"up"),(0,ex.jsx)(b.G,{icon:eo.r5},"down")]}),(0,ex.jsx)(em,{label:(0,ex.jsx)(h.cC,{id:"rEj/lx"}),shortcuts:["Enter"]})]}),(0,ex.jsx)(eh.z,{size:"sm",variant:"solid",onClick:n,children:(0,ex.jsx)(h.cC,{id:"76gPWk"})})]})},"coach-bar")};function eg(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function ej(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?eg(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):eg(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var eb=(0,w.memo)(function(){var e=(0,_.q)(),n=e.isOpen,t=e.onToggle,r=e.onClose,o=(0,ee._)(en.H.hasSeenCoachBar,!1),i=(0,A.Z)(o,2),s=i[0],a=i[1],c=(0,J.CG)($.Tf),l=(0,w.useCallback)(function(){s||a(!0),r()},[s,r,a]),d=!s||n,u=X((0,w.useCallback)(function(e){return e.clientX>window.innerWidth-150&&e.clientY>window.innerHeight-150},[]));return(0,ex.jsx)(er.H,{mr:c&&s&&!d&&!u?"-100%":"0px",transitionProperty:"margin-right",transitionDuration:"ultra-slow",transitionTimingFunction:"ease-in-out",children:(0,ex.jsxs)(R.J,{returnFocusOnClose:!1,isOpen:d,onClose:l,closeOnBlur:!0,children:[(0,ex.jsx)(L.x,{children:(0,ex.jsx)(z.h,{onClick:function(){n&&a(!0),t()},"aria-label":"Help",isRound:!0,size:"md",icon:(0,ex.jsx)(b.G,{icon:T.UF})})}),(0,ex.jsx)(M.y,ej(ej({},et.Ro),{},{children:(0,ex.jsx)(G.b,{children:(0,ex.jsx)(ev,{onClose:l})})}))]})})});eb.displayName="PresentModeHelpWidget";var eC=t(75085),ey=t(51331),eO=t(53923),ew=t(21061),ek=t(72043),eS=t(59115),eI=t(15087),eP=t(96368),eE=t(36738),eD=t(77005),eA=t(74637),eT=t(94301),e_=t(35741),eR=t(82269),eL=t(20299),ez=t(46974),eM=t(48798),eG=t(85249),eN=t(20176),eZ=t(36471),eF=t(1410),eW=t(46510),eU=t(80304),eV=t(55479),eB=t(84103),eH=t(49294),eq=t(34638),eK=t(56143),eY=t(65742),eQ=t(50381),eX=t.n(eQ),eJ=t(97705),e$=t(93506),e0=t(41004),e1=t(25925),e2=["children","style"];function e5(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function e3(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?e5(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):e5(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var e4={enter:{visibility:"visible",opacity:1,scale:1,transition:{duration:.2,ease:[.4,0,.2,1]}},exit:{transitionEnd:{visibility:"hidden"},opacity:0,scale:.8,transition:{duration:.1,easings:"easeOut"}}},e6="custom"in e0.E?e0.E.custom(eJ.m.div):(0,e0.E)(eJ.m.div),e8=(0,w.forwardRef)(function(e,n){var t,r,o=e.children,i=e.style,s=(0,eR.Z)(e,e2),a=(0,e$.jC)("Menu",s);return(0,ex.jsx)(eJ.m.div,e3(e3({ref:n,__css:{zIndex:null!==(t=e.zIndex)&&void 0!==t?t:null===(r=a.list)||void 0===r?void 0:r.zIndex},style:e3({},i)},s),{},{children:(0,ex.jsx)(e1.M,{children:(0,ex.jsx)(e6,{className:(0,j.cx)("chakra-menu__menu-list"),variants:e4,style:{transformOrigin:"top left"},initial:e4.exit,animate:e4.enter,exit:e4.exit,__css:e3({outline:0},a.list),children:o})})}))}),e7=t(17107),e9=["type"],ne=["icon","iconSpacing","command","commandSpacing","children"],nn=["className","children"],nt=["className"];function nr(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function no(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?nr(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):nr(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var ni=(0,e7.G)(function(e,n){var t=e.type,r=(0,eR.Z)(e,e9),o=(0,e$.jC)("Menu",r),i=r.as?null!=t?t:void 0:"button",s=no({textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0},o.item);return(0,ex.jsx)(eJ.m.button,no(no({ref:n,type:i},r),{},{__css:s,_hover:o.item._focus}))}),ns=(0,e7.G)(function(e,n){var t=e.icon,r=e.iconSpacing,o=e.command,i=e.commandSpacing,s=e.children,a=(0,eR.Z)(e,ne),c=t||o?(0,ex.jsx)("span",{style:{pointerEvents:"none",flex:1},children:s}):s;return(0,ex.jsxs)(ni,no(no({},a),{},{className:(0,j.cx)("chakra-menu__menuitem"),children:[t&&(0,ex.jsx)(na,{fontSize:"0.8em",marginEnd:void 0===r?"0.75rem":r,children:t}),c,o&&(0,ex.jsx)(nc,{marginStart:void 0===i?"0.75rem":i,children:o})]}))});ns.displayName="MenuItem";var na=function(e){var n=e.className,t=e.children,r=(0,eR.Z)(e,nn),o=w.Children.only(t),i=w.isValidElement(o)?w.cloneElement(o,{focusable:"false","aria-hidden":!0,className:(0,j.cx)("chakra-menu__icon",o.props.className)}):null,s=(0,j.cx)("chakra-menu__icon-wrapper",n);return(0,ex.jsx)(eJ.m.span,no(no({className:s},r),{},{__css:{flexShrink:0},children:i}))};na.displayName="MenuIcon";var nc=(0,e7.G)(function(e,n){var t=(0,e$.jC)("Menu",e);return(0,ex.jsx)(eJ.m.span,no(no({ref:n},e),{},{__css:t.command,className:"chakra-menu__command"}))});nc.displayName="MenuCommand";var nl=function(e){var n=e.className,t=(0,eR.Z)(e,nt),r=(0,e$.jC)("Menu",e);return(0,ex.jsx)(eJ.m.hr,no(no({role:"separator","aria-orientation":"horizontal",className:(0,j.cx)("chakra-menu__divider",n)},t),{},{__css:r.divider}))};nl.displayName="MenuDivider";var nd=t(23015),nu=t(583),nf=t(81212),np=t(29787),nh=["editor","openStyleDrawer","cardUrl","getPos","isNested","isFirstCard","isCollapsed","hasCardBackground","onClose","updateAttributes","previewContent"];function nx(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function nm(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?nx(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):nx(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var nv=(0,ex.jsx)(b.G,{icon:eU.TX,fixedWidth:!0}),ng=(0,ex.jsx)(b.G,{icon:eW.WM,fixedWidth:!0}),nj=(0,ex.jsx)(b.G,{icon:eF.O4,fixedWidth:!0}),nb=(0,ex.jsx)(b.G,{icon:eZ.$,fixedWidth:!0}),nC=(0,ex.jsx)(b.G,{icon:eN.FP,fixedWidth:!0}),ny=(0,ex.jsx)(b.G,{icon:eG.oK,fixedWidth:!0}),nO=(0,ex.jsx)(b.G,{icon:eM.re,fixedWidth:!0}),nw=(0,ex.jsx)(b.G,{icon:ez.z1,fixedWidth:!0}),nk=(0,ex.jsx)(b.G,{icon:eL.UP,fixedWidth:!0}),nS=(0,w.forwardRef)(function(e,n){var t=e.editor,r=e.openStyleDrawer,o=e.cardUrl,i=e.getPos,s=e.isNested,a=e.isFirstCard,c=e.isCollapsed,l=e.hasCardBackground,d=e.onClose,u=e.updateAttributes,f=e.previewContent,p=(0,eR.Z)(e,nh);console.debug("%c [<ManageCardMenu />] RENDER","background-color: limegreen");var g=(0,eV.p)(),j=(0,np.K)(),b=(0,w.useCallback)(function(){u&&u({previewContent:null===f?"":null})},[u,f]),C=(0,w.useCallback)(function(){var e=i();if(e&&t){var n=t.state.doc.nodeAt(e),r=n&&(0,eY.getCardTitle)(n.toJSON());t.chain().deleteCard(e).focus().run();var o=x.ag._({id:"0MWv65",values:{displayTitle:r?'"'.concat(r,'"'):"card"}}),s=x.ag._({id:"9uI/rE"}),a=g({title:(0,ex.jsxs)(ec.U,{children:[(0,ex.jsx)(v.x,{noOfLines:1,children:o}),(0,ex.jsx)(eB.r,{textDecoration:"underline",onClick:function(){(0,eK.Yw)(t.state),g.close(a)},children:s})]}),status:"info",duration:3e3,position:"top"})}},[t,i,g]),y=(0,w.useCallback)(function(){var e=i();e&&(null==t||t.commands.duplicateCard(e))},[t,i]),O=(0,w.useCallback)(function(){var e=i();e&&(null==t||t.commands.unnestCard(e))},[t,i]),k=(0,w.useCallback)(function(){var e=i();e&&(null==t||t.chain().mergeCardsAtPos(e).focus().run())},[t,i]),S=(0,w.useCallback)(function(){r(0)},[r]),I=(0,w.useCallback)(function(){r(1)},[r]),P=(0,J.CG)($.hN),E=(0,eH.V)(o).onCopy,D=(0,eq.ff)("red.500","red.300"),A=(0,w.useCallback)(function(e){var n;if(e.target&&null!==(n=e.target)&&void 0!==n&&n.closest('[data-testid="open-share"]')){e.preventDefault();return}E(),g({title:x.ag._({id:"h5GS+N"}),status:"success",duration:3e3,position:"top"})},[E,g]),T=(0,w.useCallback)(function(){var e=i();if(e&&t){var n=(0,nu.PZ)(t,e);if(!n){g({title:x.ag._({id:"FntfNT"}),status:"error",duration:3e3,position:"top"});return}eX()(n,{format:"text/html"}),g({title:x.ag._({id:"LHDpRL"}),status:"success",duration:3e3,position:"top"})}},[t,i,g]);return(0,ex.jsxs)(e8,nm(nm({},p),{},{zIndex:"popover",ref:n,onClick:d,"data-testid":"manage-card-menu",children:[(0,ex.jsx)(ns,{icon:(0,ex.jsx)(nf.x,{isLocked:!j}),onClick:A,"data-testid":"copy-card-link",children:(0,ex.jsx)(h.cC,{id:"F0YmUY"})}),(0,ex.jsx)(ns,{icon:nj,onClick:T,children:(0,ex.jsx)(h.cC,{id:"Bq0HJ4"})}),(0,ex.jsxs)(m.k,{direction:"column",display:P?"flex":"none",children:[(0,ex.jsx)(nl,{}),(0,ex.jsx)(ns,{icon:ng,onClick:y,"data-testid":"duplicate-card",children:(0,ex.jsx)(h.cC,{id:"euc6Ns"})}),u&&s&&c&&(0,ex.jsx)(ns,{icon:""===f?nw:nk,onClick:b,"data-testid":"hide-preview",children:""===f?(0,ex.jsx)(h.cC,{id:"dK2evu"}):(0,ex.jsx)(h.cC,{id:"691flv"})}),r&&void 0!==l&&!c&&(0,ex.jsx)(ns,{icon:nO,onClick:S,onMouseDown:nd.br,"data-testid":"card-background",children:l?(0,ex.jsx)(h.cC,{id:"sIpTuZ"}):(0,ex.jsx)(h.cC,{id:"T6eZ9z"})}),r&&!c&&(0,ex.jsx)(ns,{icon:nv,onClick:I,onMouseDown:nd.br,"data-testid":"card-style",children:(0,ex.jsx)(h.cC,{id:"k7zVgS"})}),s?(0,ex.jsx)(ns,{icon:ny,onClick:O,"data-testid":"merge-into-parent-card",children:(0,ex.jsx)(h.cC,{id:"b+J8Wt"})}):!1!=s||a?null:(0,ex.jsx)(ns,{icon:nC,onClick:k,"data-testid":"merge-into-card-above",children:(0,ex.jsx)(h.cC,{id:"kV34zB"})}),(0,ex.jsx)(nl,{}),(0,ex.jsx)(ns,{icon:nb,color:D,onClick:C,"data-testid":"delete-card",children:(0,ex.jsx)(h.cC,{id:"cnGeoo"})})]})]}))}),nI=t(62490);function nP(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function nE(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?nP(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):nP(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var nD=(0,w.memo)(function(e){var n=e.editor,t=(0,J.CG)(nI.tk),r=t.isOpen,o=t.ref,i=t.options,s=(0,w.useState)(null),a=s[0],c=s[1],l=(0,e_.D)(o,a,{placement:"bottom-start",modifiers:[{name:"preventOverflow",enabled:!0,options:{boundary:"clippingParents"}},{name:"offset",options:{offset:[0,8]}}],strategy:"absolute"}).styles,d=(0,k.I0)(),u=(0,w.useCallback)(function(){d((0,nI.kG)({saveRef:!0}))},[d]),f=(0,w.useCallback)(function(){d((0,nI.kG)({saveRef:!1}))},[d]);return(0,eA.O)({ref:{current:a},handler:function(){r&&(u(),setTimeout(function(){d((0,nI.gQ)())},0))}}),(0,w.useEffect)(function(){return function(){return f()}},[]),(0,ex.jsx)(eT.h,{children:r&&i&&(0,ex.jsx)(nS,nE(nE({},i),{},{style:nE({},l.popper),onClose:f,ref:c,editor:n}))})}),nA=t(25756),nT=t(40618),n_=t(32333),nR=t(67769),nL=t(84636),nz=t.n(nL),nM=t(54073),nG=t.n(nM),nN=t(72338),nZ=t(30341),nF=t(34264),nW=t(17477),nU=t(26087),nV=function(e,n,t,r,o){var i=r-t,s=Math.max(i-Math.max(e-t,0)-Math.max(r-n,0),0),a=s/i,c=a>0&&s==n-e;return{overlap:a,viewing:o&&(c||a>.5||s>400),only:c}};function nB(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var nH=function(e,n){var t=(0,nZ.As)("editor"),r=(0,w.useState)(null),o=r[0],i=r[1],s=(0,w.useRef)({presentingCardId:null,scrollTop:0,containerHeight:0,expandedCards:{}}),a=(0,J.CG)($.gh),c=(0,J.CG)($.i2);(0,w.useEffect)(function(){s.current.presentingCardId=null!=c?c:null},[c]);var l=(0,J.CG)($.Q5);(0,w.useEffect)(function(){s.current.expandedCards=l},[l]),(0,w.useEffect)(function(){var e=document.querySelector(t.scrollSelector);if(e){i(e);var n=e.getBoundingClientRect().height;s.current.scrollTop=e.scrollTop,s.current.containerHeight=n}},[t.scrollSelector,s]),(0,w.useEffect)(function(){var e=nG()(function(){o&&(s.current.scrollTop=o.scrollTop)},250,{trailing:!0,maxWait:500});return window.addEventListener("scroll",e,!0),function(){return window.removeEventListener("scroll",e,!0)}},[o]),(0,w.useEffect)(function(){var e=nG()(function(){o&&(s.current.containerHeight=o.getBoundingClientRect().height)},250,{trailing:!0,maxWait:500});return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}},[o]),(0,w.useEffect)(function(){if(e){if(a===nU.q.SLIDE_VIEW){var r=setInterval(function(){n.emit("cardViewed",{cardId:s.current.presentingCardId,interval:1e3})},1e3);return function(){return clearInterval(r)}}var o=setInterval(function(){if(!document.hidden){var r=s.current,o=r.scrollTop,i=r.containerHeight,a=r.expandedCards,c=o+i;nz()((0,nN.N2)(e.state.doc,nF.KH),function(e){return e.node.attrs.id}).map(function(n){var r,i=n.node.attrs.id,s=a[i];if(!s)return null;try{r=e.view.nodeDOM(n.pos)}catch(e){return null}if(r instanceof HTMLElement){var l=(0,nW.LY)(r,t.scrollSelector),d=r.offsetHeight+l;return function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?nB(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):nB(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({id:i},nV(o,c,l,d,s))}return null}).filter(function(e){return!!(null!=e&&e.viewing)}).forEach(function(e){n.emit("cardViewed",{cardId:e.id,interval:1e3})})}},1e3);return function(){return clearInterval(o)}}},[a,e,s,n,t.scrollSelector])},nq=function(e){var n=e.editor,t=e.backoffFactor,r=void 0===t?1:t,o=(0,n_.z$)(),i=(0,w.useState)(15e3),s=i[0],a=i[1];nH(n,nR.f);var c=(0,w.useCallback)(function(){nR.f.flush(),a(Math.min(s*r,12e4))},[r,s]);return(0,w.useEffect)(function(){if(o){nR.f.initialize(),nR.f.on("flush",function(e){for(var n=e.viewed,t=0,r=Object.entries(n);t<r.length;t++){var i=(0,A.Z)(r[t],2),s=i[0],a=i[1];o.trackDocEvent(n_.AA.CARD_VIEWED,{card_id:s,duration:a})}});var e=setInterval(function(){return c()},s);return function(){clearInterval(e),nR.f.destroy()}}},[o,s,c]),null},nK=t(10710),nY=t(46973),nQ=t(7289),nX=t(97907),nJ=t(94659),n$=t(89634),n0=t(76903),n1=t(60075),n2=t(41290),n5=t(6057),n3=function(){var e=(0,w.useState)(null),n=e[0],t=e[1],r=(0,J.CG)(n1.Vy),o=r.destroyEditor,i=r.mountEditor;return((0,w.useEffect)(function(){return i&&t(i()),function(){null==o||o()}},[o,i]),(0,w.useEffect)(function(){n&&n.commands.focus("end")},[n]),n)?(0,ex.jsx)(g.xu,{className:n5.pL,overflowY:"auto",border:"1px solid",borderColor:"gray.200",borderRadius:"sm",py:2,px:3,sx:{".ProseMirror":{flex:1}},children:(0,ex.jsx)(n2.k,{editor:n,className:"highlight-mask",style:{display:"flex",flexDirection:"column"}})}):null},n4=t(18149),n6=t.n(n4),n8=t(8635),n7=t(92147),n9=function(e){var n=(0,J.CG)(n1.AD),t=(0,n8.T)({cardId:n||void 0}).title,r=(0,J.CG)($.pN,function(){return n6().apply(void 0,arguments)}),o=r.indexOf(n||""),i=(0,w.useCallback)(function(n){return function(){if(e){var t,i,s=null!==(t=r[o+(n?1:-1)])&&void 0!==t?t:r[o],a=null===(i=(0,nF.Bw)(e,s))||void 0===i?void 0:i.pos;a&&!(0,n7.vS)(e,a)&&e.commands.selectInsideNodeAtPos(a)}}},[o,e,r]);return{cardId:n,title:t||"Untitled",canGoForward:o<r.length-1,canGoBack:o>0,goToNextCard:i(!0),goToPreviousCard:i(!1)}},te=t(41267),tn=t(98875),tt=t(74418),tr=function(e){var n=(0,te.t)(e).selection,t=(0,tn.ye)("cardNotes");(0,w.useEffect)(function(){if(e&&t){var n=(0,tt.AQ)(e,e.state.selection.from);n&&n.node&&((0,n7.Qp)(n.node)||(0,n7.Fi)(e,n.pos))}},[t,e,n])},to=function(e){var n=e.closePanel,t=(0,td._i)().editor,r=n9(t),o=r.canGoBack,i=r.canGoForward,s=r.title,a=r.goToNextCard,c=r.goToPreviousCard,l=(0,J.TL)();return tr(t),(0,w.useEffect)(function(){return n$.F7.on("keydown","CARD_NOTES_PANEL",function(e){var t=document.activeElement;return!!(t instanceof HTMLElement&&t.closest('[data-panelid="card-notes-panel"]'))&&"Escape"===e.key&&(n(),!0)})},[n,l]),(0,ex.jsx)(n0.s,{bgColor:"white","data-panelid":"card-notes-panel",children:(0,ex.jsxs)(m.k,{direction:"column",h:"100%",flex:1,children:[(0,ex.jsx)(nX.P,{"data-card-notes-close-button":!0,position:"absolute",top:2,right:3,onClick:n}),(0,ex.jsxs)(ec.U,{px:6,py:4,spacing:4,children:[(0,ex.jsx)(eu.X,{fontSize:"3xl",fontWeight:800,letterSpacing:-1,children:"Card notes"}),(0,ex.jsx)(C.Yq,{label:(0,ex.jsx)(h.cC,{id:"us6sYJ"})})]}),(0,ex.jsxs)(nJ.g,{px:6,pb:4,alignItems:"stretch",flex:1,overflowY:"hidden",spacing:4,children:[(0,ex.jsx)(v.x,{fontWeight:"600",color:"gray.700",noOfLines:2,children:s}),(0,ex.jsx)(n3,{}),(0,ex.jsxs)(ec.U,{children:[(0,ex.jsx)(z.h,{"aria-label":x.ag._({id:"nElKO3"}),icon:(0,ex.jsx)(b.G,{icon:nQ.ac}),onClick:c,isDisabled:!o,flex:1}),(0,ex.jsx)(z.h,{"aria-label":x.ag._({id:"zqTURC"}),icon:(0,ex.jsx)(b.G,{icon:nY.eF}),onClick:a,isDisabled:!i,flex:1})]})]})]})})};to.panelPosition="right";var ti=t(95076),ts=t(21819),ta=function(e){var n=e.toggleCardNotesPanel,t=e.isCardNotesPanelOpen,r=(0,J.TL)(),o=(0,tn.ye)("cardNotes"),i=(0,J.CG)($.hN),s=(0,ts.Br)("edit"),a=o&&s&&i;(0,w.useEffect)(function(){t&&!a&&n()},[a,t,n]),(0,w.useEffect)(function(){t||r((0,n1.mK)({isOpen:!1}))},[r,t,n]),(0,w.useEffect)(function(){if(a)return ti.T.on("toggle",function(e){var o=e.config;t||(n(o),r((0,n1.mK)({isOpen:!t})))})},[r,t,a,n])},tc=t(28916),tl=t(62517),td=t(59734),tu=t(68197),tf=t(20406),tp=t(28526),th=t.n(tp),tx=t(78116),tm=t(56915),tv=t(16796),tg=t(64827),tj=t(2167),tb=t(80353),tC=t(76648),ty=t(58125),tO=t(30764),tw=t(24021),tk=t(66825),tS=t(53865),tI=t(35634),tP=t(95876),tE=t(82477),tD=t(91465),tA=t(35910),tT=t(35231),t_=t(98666);function tR(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var tL=w.createContext({enabled:!1,registerEditor:function(e,n){},getAllCards:function(){return[]},userMessage:"",setUserMessage:function(e){}});function tz(){return(0,w.useContext)(tL)}var tM=function(e){var n=e.children,t=(0,w.useRef)(new Map),r=(0,w.useRef)(""),o=(0,w.useRef)(function(e,n){t.current.set(e,n)}),i=(0,w.useRef)(function(){return Array.from(t.current.values()).map(function(e){var n,t;return null===(n=e.state.doc.firstChild)||void 0===n?void 0:null===(t=n.content.toJSON())||void 0===t?void 0:t[0]}).filter(Boolean)}),s=(0,w.useCallback)(function(e){r.current=e},[]);return(0,ex.jsx)(tL.Provider,{value:{enabled:!0,registerEditor:o.current,getAllCards:i.current,userMessage:r.current,setUserMessage:s},children:n})},tG=t(82511),tN=t(69936),tZ=t(56581),tF=t(27302),tW=t(420),tU=t(86297),tV=function(e){var n=e.cardId,t=e.onClick,r=(0,J.CG)((0,tG.NB)(n)),o=(0,J.CG)($.Pu);return r?(0,ex.jsxs)(ed.K,{zIndex:1,mt:"4.5em",width:"180px",bg:"whiteAlpha.500",border:"1px solid",borderColor:"blackAlpha.300",borderRadius:"lg",p:4,sx:{"*":{"backdrop-filter":"none !important","-webkit-backdrop-filter":"none !important"}},children:[r.variants.map(function(e){if(!e)return null;var i=e.label,s=e.card,a=e.id;return(0,ex.jsx)(tB,{theme:o,isSelected:r.selected===a,label:i,card:s,onClick:function(){t({cardId:n,variationId:a})}},a)}),r.variants.length<2&&(0,ex.jsx)(tF.M,{children:(0,ex.jsx)(tW.$,{})})]}):null},tB=function(e){var n=e.label,t=e.card,r=e.theme,o=e.isSelected,i=void 0!==o&&o,s=e.onClick,a=(0,w.useMemo)(function(){return(0,tU.vL)({docFlags:{cardLayoutsEnabled:!0}},[t])},[t]);return(0,ex.jsxs)(ed.K,{align:"start",children:[(0,ex.jsx)(m.k,{borderRadius:"md",bg:"white",shadow:i?"outline":"md",overflow:"hidden",cursor:"pointer",_hover:{bg:"trueblue.50"},transitionProperty:"common",transitionDuration:"fast",onClick:void 0===s?function(){}:s,children:(0,ex.jsx)(m.k,{sx:tD.n,css:{"--editor-font-size":"0.15rem","--editor-width":"150px"},justifyContent:"center",alignItems:"top",pointerEvents:"none",children:(0,ex.jsx)(tD.m,{content:a,theme:r,isThumbnail:!0})})}),(0,ex.jsxs)(v.x,{fontSize:"sm",children:[i&&(0,ex.jsx)(tZ.n,{boxSize:3,mr:2}),n]})]})};function tH(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function tq(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?tH(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):tH(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var tK="ai-wizard-editor-root",tY=function(e){var n=e.doc,t=e.cards,r=e.theme,o=void 0===r?tS.mU:r,i=(0,tT.R5)(o),s=(0,tI.wj)(o),a=(0,tT.wh)(i,s),c=(0,J.TL)(),l=tz().registerEditor;return((0,w.useEffect)(function(){return function(){c((0,tG.mc)())}},[c]),n)?(0,ex.jsxs)(m.k,tq(tq({bg:"gray.100",overflowY:"auto",overflowX:"hidden",justifyContent:"flex-start",alignContent:"center",alignItems:"center",alignSelf:"stretch",direction:"column",width:"100%",height:"100%",position:"relative",className:tK},a),{},{children:[(0,ex.jsx)(tA.Y,{}),t.map(function(e,t){var r,o=null===(r=e.attrs)||void 0===r?void 0:r.id;return o?(0,ex.jsx)(tQ,{doc:n,cardId:o,cardIndex:t,cardJSON:e,onCreate:function(e){l(o,e)}},o):null})]})):null},tQ=function(e){var n=e.cardId,t=e.cardIndex,r=e.cardJSON,o=e.doc,i=e.onCreate,s=(0,J.TL)(),a=(0,w.useState)(null),c=a[0],l=a[1],d=tz().userMessage,u=(0,tN.b)({editor:c});(0,w.useEffect)(function(){c&&u({doc:c.state.doc,cardId:n,message:d})},[u,c,n,t,d]);var f=(0,w.useMemo)(function(){return(0,tP.vL)({docFlags:{cardLayoutsEnabled:!0}},[r])},[r]),p=(0,J.CG)((0,tG.a4)(n));(0,t_.vm)(function(){if(c&&p){var e=(0,nF.Bw)(c,n);e&&c.commands.command(function(n){var t=n.tr,r=tO.NB.fromJSON(c.schema,p.card);return t.replaceWith(e.pos,e.pos+e.node.nodeSize,r),!0})}},[c,p,n],[p]);var h=(0,w.useCallback)(function(e){var t=e.cardId,r=e.variationId;c&&t===n&&s((0,tG.dx)({cardId:n,variantId:r}))},[s,c,n]);return null!=o&&o.id?(0,ex.jsxs)(m.k,{className:"ai-variation-editor-".concat(n),alignItems:"flex-start",sx:tD.n,my:-8,children:[(0,ex.jsx)(tV,{cardId:n,onClick:h}),(0,ex.jsx)(tE.y,{initialContent:f,onCreate:function(e){var n=e.editor;l(n),i(n)},doc:o,docId:o.id,scrollingParentSelector:".".concat(tK),readOnly:!0,isStatic:!0,animationsEnabled:!1,extensions:[],shouldSupportMenus:!1})]}):null},tX=t(30118);function tJ(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function t$(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?tJ(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):tJ(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var t0=function(e){var n=(0,tX.M)({id:"cardSuggestionDrawer"}),t=n.isOpen,r=n.onClose,o=n.onOpen,i=(0,J.CG)($.Pu),s=(0,w.useState)(function(){return(0,ty.xC)({reducer:J.Ct})})[0];return(0,ex.jsx)(k.zt,{store:s,children:(0,ex.jsx)(t1,t$(t$({},e),{},{isOpen:t,onClose:r,onOpen:o,theme:i}))})},t1=(r=function(e){var n,t=e.doc,r=e.editor,o=e.theme,i=e.isOpen,s=e.onClose,a=e.onOpen,c=(0,w.useState)([]),l=c[0],d=c[1],u=(0,w.useState)(null),f=u[0],p=u[1],x=tz(),m=x.getAllCards,v=x.setUserMessage,g=(0,w.useCallback)(function(){s(),d([]),p(null)},[s]),j=(0,w.useCallback)(function(){if(g(),r){var e={type:"document",content:m()};console.log("[handleConfirm] contentToUse",e);var n=1,t=r.state.doc.nodeSize-2,o=(0,nF.Bw)(r,f);if(o){t=(n=o.pos)+o.node.nodeSize;var i=e.content.find(function(e){var n;return(null===(n=e.attrs)||void 0===n?void 0:n.id)===f});if(!i){console.warn("[handleConfirm] Count not find card to use");return}e=i}r.commands.command(function(o){return o.tr.replaceRangeWith(n,t,tO.NB.fromJSON(r.schema,e)),!0})}},[g,r,f,m]),b=(0,w.useCallback)((n=(0,tf.Z)(th().mark(function e(n,t,r){return th().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a(),p(t),d(n.toJSON().content[0].content.filter(function(e){var n;return null===t||(null===(n=e.attrs)||void 0===n?void 0:n.id)===t})),v(r);case 5:case"end":return e.stop()}},e)})),function(e,t,r){return n.apply(this,arguments)}),[a,v]);return(0,w.useEffect)(function(){if(r)return tk.T.on("openSuggestionEditor",function(e){var n=e.cardId,t=e.userMessage;b(r.view.state.doc,n,t)})},[r,b]),(0,ex.jsxs)(tx.d,{placement:"bottom",onClose:s,isOpen:i,trapFocus:!0,isFullHeight:!0,children:[(0,ex.jsx)(tm.Z,{}),(0,ex.jsxs)(tv.s,{borderTopRadius:"xl",h:"calc(var(--100vh) - 24px)",transform:"none !important",children:[(0,ex.jsx)(tg.o,{zIndex:"10",backgroundColor:"white",mr:2,shadow:"md"}),(0,ex.jsx)(tj.f,{p:0,h:"100%",children:l.length>0&&t?(0,ex.jsx)(tY,{doc:t,cards:l,theme:o}):(0,ex.jsx)(tw.AA,{})}),(0,ex.jsx)(tb.m,{borderTop:"1px solid #000",borderColor:"gray.200",children:(0,ex.jsxs)(tC.h,{spacing:4,children:[(0,ex.jsx)(eh.z,{variant:"ghost",onClick:s,children:(0,ex.jsx)(h.cC,{id:"dEgA5A"})}),(0,ex.jsx)(eh.z,{variant:"solid",onClick:j,children:(0,ex.jsx)(h.cC,{id:"7VpPHA"})})]})})]})]})},(0,w.memo)(function(e){return(0,ex.jsx)(tM,{children:(0,ex.jsx)(r,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?tR(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):tR(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({},e))})})),t2=t(80405),t5=t(3476),t3=t(61751),t4=t(71961),t6=t(49626),t8=t(49747),t7=t(56133),t9=t(39097),re=t.n(t9),rn=t(46988),rt=t(20252),rr=t(38876),ro=t(99083),ri=t(9734),rs=t(51823),ra=t(76035),rc=t(50281),rl=t(54119),rd=t(77779),ru=t(2046),rf=t(70287),rp=t(25793),rh=t(14304),rx=t.n(rh),rm=t(6201),rv=[{key:"bad",label:(0,ex.jsx)(h.cC,{id:"XSfVsn"}),ariaLabel:function(){return x.ag._({id:"XSfVsn"})},icon:rd.Kf,color:"red"},{key:"meh",label:(0,ex.jsx)(h.cC,{id:"0ASQJH"}),ariaLabel:function(){return x.ag._({id:"0ASQJH"})},icon:rl.C4,color:"yellow"},{key:"good",label:(0,ex.jsx)(h.cC,{id:"9ZYnL5"}),ariaLabel:function(){return x.ag._({id:"9ZYnL5"})},icon:rc.I3,color:"green"}],rg=function(e){var n=e.docId,t=e.isDark,r=e.interactionId,o=(0,w.useState)(null),i=o[0],s=o[1],a=(0,w.useState)(!1),c=a[0],l=a[1],d=(0,w.useState)(""),u=d[0],f=d[1],p=(0,w.useRef)(null),x=(0,eV.p)(),m=(0,w.useCallback)(function(e){s(e),(0,rm.fM)({rating:e,doc_id:n,interactionId:r}),x({title:(0,ex.jsx)(h.cC,{id:"2gZOCV"}),status:"success",position:"top",duration:1e3}),setTimeout(function(){var e;null==p||null===(e=p.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},200)},[n,r,x]),j=(0,w.useCallback)(function(e){e||((0,rm.XH)({feedback:rx().sanitize(u),doc_id:n,interactionId:r}),x({title:(0,ex.jsx)(h.cC,{id:"+Rq0s/"}),status:"success",position:"top",duration:2e3,isClosable:!0})),l(!0)},[n,u,r,x]);return(0,ex.jsx)(g.xu,{p:4,borderRadius:"lg",border:"1px solid",borderColor:t?"whiteAlpha.100":"gray.200",position:"relative",children:c?(0,ex.jsxs)(v.x,{color:t?"green.400":"green.600",textAlign:"center",children:[(0,ex.jsx)(b.G,{icon:ra.faCircleCheck})," ",(0,ex.jsx)(h.cC,{id:"SOk0EB"})]}):(0,ex.jsxs)(ed.K,{spacing:4,children:[(0,ex.jsxs)(ed.K,{alignItems:"center",spacing:"1",children:[(0,ex.jsx)(v.x,{fontSize:"sm",color:t?"whiteAlpha.800":"gray.500",children:(0,ex.jsx)(h.cC,{id:"E47gBS"})}),i?(0,ex.jsxs)(v.x,{textAlign:"center",color:t?"green.400":"green.600",children:[(0,ex.jsx)(b.G,{icon:ra.faCircleCheck})," ",(0,ex.jsx)(h.cC,{id:"SOk0EB"})]}):(0,ex.jsx)(v.x,{children:(0,ex.jsx)(h.cC,{id:"cguR5Y"})})]}),(0,ex.jsx)(ec.U,{fontSize:"xl",width:"100%",children:rv.map(function(e){var n=e.key,r=e.ariaLabel,o=e.label,s=e.icon,a=e.color,c=i===n;return(0,ex.jsx)(rj,{ariaLabel:r,label:o,icon:s,color:a,onClick:function(){return m(n)},isSelected:c,isDisabled:!!(i&&!c),isDark:t},n)})}),i&&(0,ex.jsxs)(ru.NI,{textAlign:"center",children:[(0,ex.jsx)(rf.l,{fontSize:"sm",color:t?"whiteAlpha.800":"gray.500",children:"good"===i?(0,ex.jsx)(h.cC,{id:"AmM8eQ"}):(0,ex.jsx)(h.cC,{id:"8+bwIa"})}),(0,ex.jsx)(rp.g,{value:u,onChange:function(e){f(e.target.value)},placeholder:"",size:"sm",mb:"4"}),(0,ex.jsxs)(tC.h,{spacing:"4",ref:p,children:[(0,ex.jsx)(eh.z,{variant:"text",onClick:function(){j(!0)},children:(0,ex.jsx)(h.cC,{id:"6Uau97"})}),(0,ex.jsx)(eh.z,{variant:"solid",isDisabled:""===u,onClick:function(){return j(!1)},children:(0,ex.jsx)(h.cC,{id:"hQRttt"})})]})]})]})})},rj=function(e){var n=e.label,t=e.ariaLabel,r=e.icon,o=e.color,i=e.isSelected,s=e.onClick,a=e.isDisabled,c=e.isDark;return(0,ex.jsx)(C.kH,{label:n,placement:"top",children:(0,ex.jsx)(z.h,{"aria-label":t(),boxShadow:"none",bg:i?c?"".concat(o,".200"):"".concat(o,".100"):c?"whiteAlpha.300":"gray.50",_disabled:{opacity:"".concat(i?1:.5),cursor:"not-allowed"},color:i?c?"".concat(o,".600"):"".concat(o,".500"):c?"whiteAlpha.800":"gray.500",_hover:{backgroundColor:"".concat(o,".100"),color:"".concat(o,".500")},flex:1,icon:(0,ex.jsx)(v.x,{fontSize:"2xl",children:(0,ex.jsx)(b.G,{icon:r})}),isDisabled:a,variant:"plain",onClick:s})})},rb=t(8661),rC=t(1368),ry=["90%","360px"],rO=function(e){var n=e.onClose,t=e.eyebrowText,r=e.mainText,o=e.callsToAction;return(0,ex.jsxs)(g.xu,{bg:"white",border:"0.5px solid var(--chakra-colors-gray-100)",borderRadius:"md",shadow:"md",p:4,w:ry,maxW:ry,position:"relative",children:[(0,ex.jsx)(nX.P,{size:"sm",onClick:n,position:"absolute",insetEnd:1,top:1}),(0,ex.jsxs)(ed.K,{spacing:4,children:[(0,ex.jsxs)(ed.K,{spacing:1,paddingEnd:3,children:[!(0,ri.s2)()&&(0,ex.jsx)(v.x,{fontSize:"sm",color:"gray.600",children:t}),(0,ex.jsx)(v.x,{fontSize:"md",children:r})]}),(0,ex.jsx)(g.xu,{w:"100%",children:o})]})]})},rw=function(e){var n=e.onClose,t=e.startTour;return(0,ex.jsx)(rO,{eyebrowText:(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)("span",{"aria-label":"Wave",role:"img",children:"\uD83D\uDC4B"})," ",(0,ex.jsx)(h.cC,{id:"IiwaCT",values:{GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc}})]}),mainText:(0,ex.jsx)(h.cC,{id:"ntWFEH"}),onClose:n,callsToAction:(0,ex.jsx)(eh.z,{size:"md",w:"100%",variant:"solid",onClick:function(){t(0),n()},children:(0,ex.jsx)(h.cC,{id:"VzFYDl"})})})},rk=t(77245),rS=["90%","360px"],rI=function(e){var n=e.onClose,t=(0,w.useState)(!0),r=t[0],o=t[1];return(0,w.useEffect)(function(){setTimeout(function(){o(!1)},3e3)},[]),(0,ex.jsxs)(g.xu,{bg:"white",border:"0.5px solid var(--chakra-colors-gray-100)",borderRadius:"md",shadow:"md",p:4,w:rS,maxW:rS,position:"relative",children:[(0,ex.jsx)(nX.P,{size:"md",onClick:n,position:"absolute",insetEnd:1,top:1}),(0,ex.jsxs)(ed.K,{direction:"row",spacing:3,justify:"center",w:"100%",alignItems:"center",children:[(0,ex.jsx)(g.xu,{color:"trueblue.300",children:(0,ex.jsx)(b.G,{icon:rk.tc,size:"2x",className:r?"fa-bounce":void 0})}),(0,ex.jsxs)(ed.K,{spacing:0,direction:"column",flex:1,textAlign:"left",children:[(0,ex.jsx)(v.x,{fontSize:"sm",color:"gray.600",children:(0,ex.jsx)(h.cC,{id:"eoDgVo"})}),(0,ex.jsx)(v.x,{fontSize:"md",children:(0,ex.jsx)(h.cC,{id:"p7dFyi"})})]})]})]})};function rP(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function rE(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?rP(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):rP(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var rD="source",rA="desktop-tour-toast",rT="switch-from-mobile-to-desktop-toast",r_=function(e){var n,t=e.editor,r=(0,eV.p)(),o=(0,J.CG)(tu.yx),i=(0,P.c8)().startTour,s=(0,nK.SE)(),a=s.user,c=s.setSettings,l=(0,w.useState)(!1),d=l[0],u=l[1],p=(0,w.useRef)(!1),h=!!(null!=a&&null!==(n=a.settings)&&void 0!==n&&n.needsEditorOnboarding),x=(0,J.CG)((0,rn.oH)(null==t?void 0:t.gammaDocId)),m=!!x&&"running"===x.status,v=!!x&&("complete"===x.status||"error"===x.status),g=(0,nZ.As)("editor"),j=(0,w.useState)(null),b=j[0],C=j[1],y=(0,w.useState)(function(){return(0,rs.SJ)()[rD]===rb.VY})[0],O=(0,w.useState)(function(){return y&&(0,ri.s2)()})[0],k=y&&v;return(0,w.useEffect)(function(){t&&u(!m&&!(0,ri.s2)()&&y&&h)},[t,y,m,h]),(0,w.useEffect)(function(){setTimeout(function(){(0,rC.lO)({query:rE(rE({},(0,rs.SJ)()),{},(0,f.Z)({},rD,void 0)),emitChange:!1})})},[]),(0,w.useEffect)(function(){return d&&!r.isActive(rA)&&setTimeout(function(){r({id:rA,position:"bottom-left",render:function(e){var n=e.onClose;return rw({onClose:function(){null==c||c({remove:["needsEditorOnboarding"]}),n()},startTour:i})},isClosable:!0,duration:null})},2e3),function(){r.isActive(rA)&&r.close(rA)}},[c,d,i,r]),(0,w.useEffect)(function(){if((0,ri.s2)()){var e=document.querySelector(g.scrollSelector);if(e){C(e);var n=function(){b&&(0,ri.s2)()&&(null==b?void 0:b.scrollTop)>=(null==b?void 0:b.scrollHeight)/4&&O&&!r.isActive(rT)&&!p.current&&(p.current=!0,r({id:rT,position:"top",render:function(e){return rI({onClose:e.onClose})},isClosable:!0,duration:null,containerStyle:{minWidth:"100%",display:"flex",justifyContent:"center"}}))};return window.addEventListener("scroll",n,!0),function(){window.removeEventListener("scroll",n,!0),r.isActive(rT)&&r.close(rT)}}}},[o,b,g.scrollSelector,O,r]),{showDocWizardFooter:k}};function rR(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function rL(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?rR(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):rR(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var rz=(0,w.memo)(function(e){var n,t=e.interactionId,r=(0,J.CG)(tu.yx),o=null!=r&&!!r.theme&&(0,tS.wj)(null==r?void 0:r.theme),i=(0,w.useState)(!1),s=i[0],a=i[1],c=(0,tn.ye)("createv2"),l=(0,eV.p)(),d=null==r?void 0:null===(n=r.accessLinks)||void 0===n?void 0:n[0],u=(0,w.useMemo)(function(){return(0,rs.Gn)({docTitle:null==r?void 0:r.title,docId:null==r?void 0:r.id,token:null==d?void 0:d.token,absolute:!0})},[r,null==d?void 0:d.token]),f=(0,eH.V)(u).onCopy,p=(0,w.useCallback)(function(){(0,rt.J)({docId:null==r?void 0:r.id,source:"docWizardFooter",type:"tokenUrl"}),f(),l({title:(0,ex.jsx)(h.cC,{id:"pQjjYo"}),status:"success",position:"top",duration:1e3,isClosable:!1})},[null==r?void 0:r.id,f,l]),x=(0,w.useCallback)(function(){a(!0)},[]),v=(0,ro.n)();return r?(0,ex.jsx)(C.Wk,{isDark:o,children:(0,ex.jsx)(m.k,{className:"chakra-dont-set-collapse","data-doc-wizard-footer":!0,w:"100%",mt:(0,ri.s2)()?void 0:"-".concat(rr.m),children:(0,ex.jsx)(t8.U,{in:!s,style:{width:"100%"},unmountOnExit:!0,children:(0,ex.jsx)(m.k,rL(rL({pt:[10,10,20],pb:[4,4,8],w:"100%",position:"relative"},o?{background:"gray.900",color:"white",borderTop:"2px solid var(--chakra-colors-whiteAlpha-200)"}:{background:"white",color:void 0,borderTop:"2px solid var(--chakra-colors-blackAlpha-200)"}),{},{children:(0,ex.jsx)(t7.W,{maxW:"420px",children:(0,ex.jsxs)(ed.K,{spacing:8,children:[(0,ex.jsxs)(ed.K,{spacing:4,textAlign:"center",children:[(0,ex.jsx)(eu.X,{size:"md",children:(0,ex.jsx)(h.cC,{id:"bB+DHs"})}),(0,ex.jsx)(eh.z,{as:re(),target:(0,ri.Q5)()?"_self":"_blank",variant:"solid",colorScheme:o?"blackAlpha":"whiteAlpha",leftIcon:(0,ex.jsx)(b.G,{icon:t6.r8}),href:c?"/create":"/generate",children:(0,ex.jsx)(h.cC,{id:"xFxi2V"})}),v?(0,ex.jsx)(eh.z,{leftIcon:(0,ex.jsx)(b.G,{icon:t4.Fz}),variant:"plain",as:re(),target:(0,ri.Q5)()?"_self":"_blank",href:v,children:(0,ex.jsx)(h.cC,{id:"550oRP"})}):(0,ex.jsx)(eh.z,{leftIcon:(0,ex.jsx)(b.G,{icon:t3.nN}),variant:"plain",onClick:p,children:(0,ex.jsx)(h.cC,{id:"RGCCrg"})})]}),(0,ex.jsx)(rg,{docId:r.id,isDark:o,interactionId:t}),(0,ex.jsx)(tF.M,{pt:[0,0,4],w:"100%",children:(0,ex.jsx)(eh.z,{size:"sm",onClick:x,variant:"text",colorScheme:"blackAlpha",children:(0,ex.jsx)(h.cC,{id:"vLyv1R"})})})]})})}))})})}):null});rz.displayName="DocWizardFooterInner";var rM=function(e){var n=e.editor,t=r_({editor:n}).showDocWizardFooter,r=(0,J.CG)((0,rn.oH)(null==n?void 0:n.gammaDocId)),o=null==r?void 0:r.id;return t&&o?(0,ex.jsx)(rz,{interactionId:o}):(0,ex.jsx)(ex.Fragment,{})},rG=t(98537),rN=t.n(rG),rZ=t(87063),rF=function(e){var n=e.onCloneClick,t=e.onSignupClick,r=e.isLoggedIn;return(0,ex.jsx)(g.xu,{bg:"white",border:"0.5px solid var(--chakra-colors-gray-100)",borderRadius:"md",shadow:"md",display:"column",p:4,position:"relative",children:r?(0,ex.jsxs)(ec.U,{children:[(0,ex.jsxs)(v.x,{mr:1,children:[(0,ex.jsx)(h.cC,{id:"HMsJrS",values:{GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc},components:{0:(0,ex.jsx)("strong",{})}})," ","\uD83D\uDE0D"]}),(0,ex.jsx)(eh.z,{variant:"solid",onClick:n,children:(0,ex.jsx)(h.cC,{id:"he3ygx"})})]}):(0,ex.jsxs)(ec.U,{children:[(0,ex.jsxs)(v.x,{mr:1,children:[(0,ex.jsx)(h.cC,{id:"FEyEJk",values:{GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc,GAMMA_PROPER_NOUN:eC.N6},components:{0:(0,ex.jsx)("strong",{})}})," ","\uD83D\uDE0D"]}),(0,ex.jsx)(re(),{href:"/signup",passHref:!0,legacyBehavior:!0,children:(0,ex.jsx)(eh.z,{as:eB.r,onClick:t,variant:"solid",textDecoration:"none !important",children:(0,ex.jsx)(h.cC,{id:"e+RpCP"})})})]})})},rW=function(e){var n=!(0,ri.s2)(),t=(0,nK.SE)().user,r=(0,eV.p)(),o=(0,w.useRef)(),i=(0,rZ.e)(),s=(0,w.useCallback)(function(){e&&(null===n_.co||void 0===n_.co||n_.co.track(n_.AA.EXAMPLE_SIGNUP_CLICKED,{doc_id:e.id,title:e.title}))},[e]),a=(0,w.useCallback)(function(){i({docId:null==e?void 0:e.id,docTitle:null==e?void 0:e.title,source:"example_deck_clone_toast"})},[e,i]);(0,w.useEffect)(function(){return function(){o.current&&r.close(o.current)}},[r]);var c=n&&e,l=!!t;(0,t_.vm)(function(){o.current&&r.close(o.current),c&&(o.current=r({position:"bottom",render:function(){return rF({onCloneClick:a,isLoggedIn:l,onSignupClick:s})},isClosable:!0,duration:null}))},[e,n,a,s,c,t,r,l],[c,l])},rU=t(57461),rV=t(99703),rB=t(91718),rH=t(92761),rq="sessionId1",rK=nN.hj.create({addStorage:function(){return{user:{}}},addCommands:function(){var e=this;return{user:function(n){return function(){var t=(0,J.bh)();return e.storage.user=rN()({},e.storage.user,n),t.dispatch((0,$.MU)({sessionId:rq})),t.dispatch((0,$.Tx)({collaborators:[e.storage.user]})),!0}}}}}),rY=function(e){var n,t=e.docId,r=e.snapshotId,o=e.scrollingParentSelector,i=e.onCreate,s=(0,J.CG)(tu.yx);rW(s);var a=(0,w.useState)(function(){return[rU.F,rB.$1.configure({scrollerSelector:o}),rK,rV._g]})[0],c=(0,nK.SE)(),l=c.user,d=c.anonymousUser,u=c.isUserLoading,f=c.color,p=(0,w.useState)(),h=p[0],x=p[1],v=(0,S.EDv)({variables:{docId:t,snapshotId:r},skip:!r}),j=v.data,b=v.loading,C=v.error;(0,w.useEffect)(function(){!u&&h&&h.commands.user({id:(null==l?void 0:l.id)||d.id,color:f.value,sessionId:rq,idleSince:null,name:(null==l?void 0:l.displayName)||d.displayName||"",profileImageUrl:(null==l?void 0:l.profileImageUrl)||"",isReady:!u})},[h,l,f,u,d]);var y=j&&void 0!==j.snapshot&&!b&&s;return(0,ex.jsxs)(g.xu,{"data-testid":"example-static-editor-wrapper",flex:"1",height:"100%",children:[!y||C?(0,ex.jsxs)(m.k,{direction:"column",height:"100%",flex:"1",bg:"gray.100",alignItems:"center",justifyContent:"center",children:[!y&&(0,ex.jsx)(tW.$,{}),C&&(0,ex.jsxs)(tF.M,{h:"100%",children:["There was an error loading this ",eC.Yc,":"," ",C.message]})]}):(0,ex.jsx)(g.xu,{"data-testid":"example-static-editor-wrapper-inner",transitionProperty:"common",transitionDuration:"750ms",transitionTimingFunction:"ease-out",opacity:y?1:0,children:(0,ex.jsx)(eE.yE,{doc:s,editorId:"main",docId:t,extensions:a,onCreate:function(e){var n=e.editor;x(n),setTimeout(function(){i&&i(n)},10)},readOnly:!0,initialContent:null===(n=j.snapshot)||void 0===n?void 0:n.content.default,scrollingParentSelector:o})}),(0,ex.jsx)(rH.m,{forceShow:!0,abuseReportingEnabled:!1})]})},rQ=t(10939),rX="sessionId1",rJ=nN.hj.create({addStorage:function(){return{user:{}}},addCommands:function(){var e=this;return{user:function(n){return function(){var t=(0,J.bh)();return e.storage.user=rN()({},e.storage.user,n),t.dispatch((0,$.MU)({sessionId:rX})),t.dispatch((0,$.Tx)({collaborators:[e.storage.user]})),!0}}}}}),r$=function(e){var n,t=e.docId,r=e.snapshotId,o=e.scrollingParentSelector,i=e.onCreate,s=e.theme,a=e.hideMadeWithGammaBadge,c=(0,w.useState)(function(){return[rU.F,rB.$1.configure({scrollerSelector:o}),rJ,rV._g]})[0],l=(0,nK.SE)(),d=l.user,u=l.isUserLoading,f=l.anonymousUser,p=l.color,h=(0,w.useState)(),x=h[0],v=h[1],j=(0,S.EDv)({variables:{docId:t,snapshotId:r},skip:!r}),b=j.data,C=j.loading,y=j.error,O=(0,J.CG)(tu.yx);(0,w.useEffect)(function(){!u&&x&&x.commands.user({id:(null==d?void 0:d.id)||f.id,color:p.value,sessionId:rX,idleSince:null,name:(null==d?void 0:d.displayName)||f.displayName||"",profileImageUrl:(null==d?void 0:d.profileImageUrl)||"",isReady:!u})},[x,d,p,u,f]);var k=b&&void 0!==b.snapshot&&!C&&O;return(0,ex.jsxs)(g.xu,{"data-testid":"public-static-editor-wrapper",flex:"1",height:"100%",children:[!k||y?(0,ex.jsxs)(m.k,{direction:"column",height:"100%",flex:"1",bg:"gray.100",alignItems:"center",justifyContent:"center",children:[!k&&(0,ex.jsx)(tW.$,{}),y&&(0,ex.jsxs)(tF.M,{h:"100%",children:["There was an error loading this ",eC.Yc,":"," ",y.message]})]}):(0,ex.jsx)(g.xu,{"data-testid":"public-static-editor-wrapper-inner",transitionProperty:"common",transitionDuration:"750ms",transitionTimingFunction:"ease-out",opacity:k?1:0,children:(0,ex.jsx)(eE.yE,{doc:O,editorId:"main",docId:t,theme:s||void 0,extensions:c,onCreate:function(e){var n=e.editor;v(n),setTimeout(function(){i&&i(n)},10)},readOnly:!0,initialContent:null===(n=b.snapshot)||void 0===n?void 0:n.content.default,scrollingParentSelector:o})}),x&&(0,ex.jsx)(nq,{editor:x,backoffFactor:2}),!(void 0!==a&&a)&&(0,ex.jsx)(rH.m,{docWorkspace:null==O?void 0:O.organization})]})},r0=t(16019);function r1(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function r2(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r1(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r1(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var r5=(l={},(0,f.Z)(l,nU.q.DOC_VIEW,"doc"),(0,f.Z)(l,nU.q.SLIDE_VIEW,"present"),l),r3=function(e){var n=(0,k.I0)(),t=(0,rs.SJ)().mode,r=(0,J.CG)($.gh),o=(0,w.useCallback)(function(e){var n=e||r,t=(0,rs.SJ)().mode,o=r5[n];t!==o&&(0,rC.lO)({query:r2(r2({},(0,rs.SJ)()),{},{mode:o}),emitChange:!1})},[r]);(0,r0.r)(o,[r]),(0,w.useEffect)(function(){return rC.fI.on("changed",function(){return o()})},[o]),(0,t_.vm)(function(){if(e){var r=t===r5.SLIDE_VIEW?nU.q.SLIDE_VIEW:nU.q.DOC_VIEW,i=(0,rs.sY)().cardId;r===nU.q.SLIDE_VIEW&&(i?(console.debug("[useQuerySync] initializeModeFromQuery - Entering slide view -> spotlightCardById:",i),e.commands.spotlightCardById(i)):(console.debug("[useQuerySync] initializeModeFromQuery - Entering slide view -> spotlightCurrentCard"),e.commands.spotlightCurrentCard())),n((0,$.PM)({mode:r})),o(r)}},[e,n,t,o],[e])},r4=t(87202),r6=t(56692),r8=t(96302),r7=t(10469),r9=t(27440),oe=t(71170),on=t(56241),ot=t(99336),or=t(92527),oo=t(89814),oi=t(56261),os=(0,r4.ZP)("mod+Escape"),oa=new Set(["h","j","k","l","s","PageUp","PageDown","ArrowRight","ArrowLeft","ArrowDown","ArrowUp","Enter","Escape"]),oc=function(e,n){var t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=(0,nZ.cC)("editor"),o=r.scroller;if(o){e.commands.turnOffSpotlight();var i=o.scrollHeight-o.offsetHeight;if("down"===n){if(!(r.isAtBottom(90)&&t&&e.commands.spotlightNextCard(!1,"top"))){var s=o.scrollTop+.5*o.offsetHeight;s>i-150&&(s=i),r.scrollTo({top:s})}}else if(!(r.isAtTop(90)&&t&&e.commands.spotlightNextCard(!0,"bottom"))){var a=o.scrollTop-.5*o.offsetHeight;a<150&&(a=0),r.scrollTo({top:a})}}},ol=function(e){var n=e.enabled,t=e.setActiveKey,r=(0,n_.z$)(),o=(0,J.TL)(),i=(0,td._i)().editor,s=(0,J.CG)(ot.C),a=(0,oo.g)(i),c=a.enabled,l=a.pos,d=(0,w.useCallback)(function(){c?null==i||i.commands.turnOffSpotlight():null==i||i.commands.spotlightNextBlock()},[null==i?void 0:i.commands,c]);return(0,w.useEffect)(function(){if(n)return r6.F7.on("keydown","NAVIGATION_CONTROLS",function(e){var n,o,a=(0,J.bh)(),u=e.target,f=Object.keys((0,$.X9)(a.getState()).tree);if(!i||null!=u&&null!==(n=u.closest)&&void 0!==n&&n.call(u,"[data-gamma-child-tiptap-editor]")||null!=u&&null!==(o=u.closest)&&void 0!==o&&o.call(u,"input")||e.metaKey||s)return!1;switch(oa.has(e.key)&&("s"!==e.key&&(t(e.key),setTimeout(function(){t(null)},100)),e.preventDefault()),e.key){case"s":return d(),!0;case"l":case"ArrowRight":return(0,or.p7)(),a.dispatch((0,$.Qx)({attached:!1})),null==r||r.trackDocEvent(n_.AA.PRESENT_MODE_NAVIGATED,{direction:n_.xQ.CARD_NEXT,method:n_.SY.KEYBOARD,key:e.key}),i.commands.spotlightNextCard();case"h":case"ArrowLeft":return(0,or.p7)(),a.dispatch((0,$.Qx)({attached:!1})),null==r||r.trackDocEvent(n_.AA.PRESENT_MODE_NAVIGATED,{direction:n_.xQ.CARD_PREV,method:n_.SY.KEYBOARD,key:e.key}),i.commands.spotlightNextCard(!0);case"j":case"ArrowDown":case"PageDown":if((0,or.p7)(),a.dispatch((0,$.Qx)({attached:!1})),!c){var p=(0,rV.ei)(i.state.selection);return i.commands.goToNextExpandableNode()||oc(i,"down",!p),!0}return null==r||r.trackDocEvent(n_.AA.PRESENT_MODE_NAVIGATED,{direction:n_.xQ.TELEPROMPTER_DOWN,method:n_.SY.KEYBOARD,key:e.key}),i.commands.spotlightNextBlock();case"k":case"ArrowUp":case"PageUp":if((0,or.p7)(),a.dispatch((0,$.Qx)({attached:!1})),!c){var h=(0,rV.ei)(i.state.selection);return i.commands.goToNextExpandableNode(!0)||oc(i,"up",!h),!0}return null==r||r.trackDocEvent(n_.AA.PRESENT_MODE_NAVIGATED,{direction:n_.xQ.TELEPROMPTER_UP,method:n_.SY.KEYBOARD,key:e.key}),i.commands.spotlightNextBlock(!0);case"r":if(f[0])return(0,or.p7)(),i.commands.spotlightCardById(f[0]),a.dispatch((0,$.Qx)({attached:!1})),!0;return!1;case"Escape":if(os(e))return!1;var x=c&&l;if(i.commands.spotlightCollapseNearestExpandableNode(x?l:null))return i.commands.reHighlightExpandableNode(),!0;if(c)return i.commands.turnOffSpotlight(),!0;return a.dispatch((0,$.Qx)({attached:!1})),null==r||r.track(n_.AA.CARD_COLLAPSED,{is_present_mode:!0,method:"escape_key"}),i.commands.ascendUpToParentCard(!1);case"Enter":var m=c&&l;if(i.commands.expandOrCollapseExpandableNode(m?l:null))return!0;if(m){var v=i.state.doc.resolve(l).parent;if(v&&(0,oi.AH)(v))return(0,oi.xB)(v.attrs.id,!1),i.commands.spotlightNextBlock(!0),!0;return i.commands.spotlightCollapseNearestExpandableNode(l)}return!1;default:return!1}})},[i,o,r,n,d,c,l,s,t]),c},od=function(e){var n=new KeyboardEvent("keydown",{key:e});t.g.dispatchEvent(n)},ou={ArrowUp:{icon:ei.FP,label:(0,ex.jsx)(h.cC,{id:"VbggDE"}),ariaLabel:function(){return x.ag._({id:"VbggDE"})},shortcuts:["↑","K"],key:"ArrowUp",onClick:function(){od("ArrowUp")},gridPos:[1,2]},ArrowLeft:{icon:ea.ac,label:(0,ex.jsx)(h.cC,{id:"4jciC3"}),ariaLabel:function(){return x.ag._({id:"4jciC3"})},shortcuts:["←","H"],key:"ArrowLeft",onClick:function(){od("ArrowLeft")},gridPos:[2,1]},ArrowDown:{icon:eo.r5,label:(0,ex.jsx)(h.cC,{id:"e3GOIZ"}),ariaLabel:function(){return x.ag._({id:"e3GOIZ"})},shortcuts:["↓","J"],key:"ArrowDown",onClick:function(){od("ArrowDown")},gridPos:[2,2]},ArrowRight:{icon:es.eF,label:(0,ex.jsx)(h.cC,{id:"ZjQRVw"}),ariaLabel:function(){return x.ag._({id:"ZjQRVw"})},shortcuts:["→","L"],key:"ArrowRight",onClick:function(){od("ArrowRight")},gridPos:[2,3]},Spotlight:{icon:r7.GT,label:(0,ex.jsx)(h.cC,{id:"Xon9jp"}),ariaLabel:function(){return x.ag._({id:"Xon9jp"})},shortcuts:["S"],key:"S",onClick:function(){od("s")},gridPos:[1,3]}},of=function(e){var n=e.shortcuts;return(0,ex.jsx)(v.x,{as:"span",color:"gray.400",ml:2,children:n.map(function(e,t){return(0,ex.jsxs)(w.Fragment,{children:[e,t===n.length-1?null:(0,ex.jsx)(v.x,{fontSize:"11px",as:"span",color:"gray.500",mx:1,children:"or"})]},e)})})},op=function(e){var n=e.activeKey,t=e.spotlightingByBlock;return(0,ex.jsx)(eT.h,{children:(0,ex.jsxs)(g.xu,{position:"absolute",bottom:4,right:6,zIndex:"sticky",children:[(0,ex.jsx)(eu.X,{children:(0,ex.jsx)(h.cC,{id:"wja8aL"})}),(0,ex.jsx)(r9.r,{gridTemplateColumns:"repeat(3, 1fr)",gridTemplateRows:"repeat(2, 1fr)",children:Object.values(ou).map(function(e){var r=e.gridPos,o=e.icon,i=e.label,s=e.ariaLabel,a=e.shortcuts,c=e.key,l=e.onClick,d=n===c;return(0,ex.jsx)(oe.P,{gridColumn:r[1],gridRow:r[0],children:(0,ex.jsx)(on.u,{hasArrow:!0,placement:"top",label:(0,ex.jsxs)(v.x,{whiteSpace:"nowrap",children:[i,(0,ex.jsx)(of,{shortcuts:a})]}),children:(0,ex.jsx)(z.h,{m:1,shadow:"base",size:"md",variant:"S"==c&&t?"solid":"plain",isActive:d||"S"===c&&t,onClick:l,onMouseDown:function(e){return e.preventDefault()},"aria-label":s(),icon:(0,ex.jsx)(b.G,{icon:o})})})},c)})})]})})},oh=t(5751),ox=t(26721),om=t(9088),ov=t(30893),og=t(40771),oj=t(8022),ob=t(95258),oC=t(63849),oy=t(2575),oO=t(17651),ow=t(72466),ok=t(6185),oS=t.n(ok),oI=t(68642),oP=t(27875),oE=t.n(oP),oD=t(74542),oA={easeOutLinear:oD.gA,easeOutSine:oD.vh,easeOutCubic:oD.w2,easeOutCirc:oD.ei,easeOutQuad:oD.hl,easeOutQuart:oD.Y3,easeOutExpo:oD.ad,bezierCustom1:oS()(.13,.97,.035,.73),bezierCustom2:oS()(.105,1.15,.15,.355)},oT={UP:"up",DOWN:"down"},o_=function(e){return e?+new Date-+new Date(e):1/0},oR=function(e,n){var t=(0,w.useMemo)(function(){return new oI.Lethargy(6,120,.3,150)},[]),r=n||{},o=r.easing,i=void 0===o?"easeOutCubic":o,s=r.touchpadFactor,a=void 0===s?1.5:s,c=r.triggerThreshold,l=void 0===c?1200:c,d=(0,nZ.As)("editor"),u=(0,J.CG)($.i2),f=(0,w.useRef)(null),p=(0,w.useRef)(null),h=(0,w.useRef)(null),x=(0,w.useRef)(!1),m=(0,w.useRef)(null),v=(0,w.useRef)(null),g=(0,w.useState)(!1),j=g[0],b=g[1],C=(0,w.useState)(!1),y=C[0],O=C[1],k=(0,w.useRef)({counterTarget:0,counterCurrent:0,direction:oT.DOWN}),S=(0,w.useCallback)(function(){if(f.current){var e,n=k.current.counterTarget/l*100,t=(null!=n?n:0)*2.64,r="".concat(t," ").concat(264-t),o=null===(e=f.current.querySelector(".chakra-progress"))||void 0===e?void 0:e.lastElementChild,i=f.current.querySelector(".chakra-progress__indicator");i&&i.setAttribute("stroke-dasharray",r),o&&(o.innerHTML="".concat(n.toFixed(0),"%"))}},[l]),I=(0,w.useCallback)(function(){var e=h.current,n=p.current;if(n&&e){var t=e.querySelector(".chakra-progress__indicator"),r=n.querySelector(".chakra-progress__indicator");if(t&&r){var o=k.current.counterCurrent/l,s=(550>o_(v.current)?1:null!=o?o:0)*264,a="".concat(s," ").concat(264-s),c=Math.max(56-56*oA[i](Math.min(o,1)),0);e.style.transform="translateY(".concat(c,"px)"),n.style.transform="translateY(-".concat(c,"px)"),r.setAttribute("stroke-dasharray",a),t.setAttribute("stroke-dasharray",a)}}},[i,l]),P=(0,w.useCallback)(function(){if(!x.current){var e;requestAnimationFrame(function n(t){var r=e?t-e:0;if(e=t,.1>Math.abs(k.current.counterTarget-k.current.counterCurrent)){k.current.counterCurrent=k.current.counterTarget,I(),x.current=!1;return}k.current.counterCurrent=(0,oD.t7)(k.current.counterCurrent,k.current.counterTarget,oE()(.3*(60/(r?1e3/r:60)),.3,1)),I(),requestAnimationFrame(n)})}},[I]),E=(0,w.useCallback)(function(){k.current.counterTarget=0,b(!1),O(!1),S(),P()},[P,S]);return(0,w.useEffect)(function(){if(!u||!e)return E();var n,r,o=document.querySelector((0,n5.U8)(u));if(!o)return E();var i=function(n){if(!n.target.closest("[data-comments-wrapper]")){var o=t.check(n);if(null!==h.current&&null!==p.current){var i=o_(m.current);if(!(i<500)&&(!(i<1e3)||!1!==o)){var s=o_(v.current);if(!(s<500)&&(!(s<1e3)||!1!==o)){var c=0===Math.abs(n.deltaY)?k.current.direction:n.deltaY>0?oT.DOWN:oT.UP;if("down"===c?d.isAtBottom():d.isAtTop()){clearTimeout(r);var u=n.wheelDeltaY?n.wheelDeltaY===-3*n.deltaY:0===n.deltaMode,f=Math.abs(void 0!==n.deltaY?n.deltaY:40)*(u?a:1);if(c!==k.current.direction){k.current.direction=c,E();return}O(c===oT.DOWN),b(c===oT.UP),k.current.counterTarget+=f,k.current.direction=c,k.current.counterTarget/l>=1?(e.commands.spotlightNextCard(c===oT.UP,c===oT.UP?"bottom":"top"),v.current=+new Date,setTimeout(function(){E(),S()},250),setTimeout(function(){v.current=null},1e3)):r=setTimeout(E,500),P(),S()}}}}}},s=function(){m.current=+new Date,clearTimeout(n),E(),n=setTimeout(function(){m.current=null},1e3)};return o.addEventListener("scroll",s),o.addEventListener("wheel",i,{passive:!0}),S(),function(){o.removeEventListener("scroll",s),o.removeEventListener("wheel",i)}},[e,t,P,i,a,l,d,S,I,E,u]),{debugRef:f,nextCardRef:h,prevCardRef:p,showNextCard:y,showPrevCard:j}},oL=function(e){var n=e.editor,t=(0,tn.ye)("debugLogging"),r=(0,w.useState)("easeOutExpo"),o=r[0],i=r[1],s=(0,w.useState)(1.5),a=s[0],c=s[1],l=(0,w.useState)(1200),d=l[0],u=l[1],f=oR(n,{easing:o,touchpadFactor:a,triggerThreshold:d}),p=f.debugRef,h=f.nextCardRef,x=f.prevCardRef,m=f.showNextCard,v=f.showPrevCard,g=(0,J.CG)(function(e){var n=(0,$.i2)(e)||"",t=(0,$.X9)(e),r=Object.keys((t.parents[n]||[]).reduce(function(e,n){return e[n]},t.tree)),o=null,i=null;return r.forEach(function(e,s){if(e===n){var a=t.parents[n];0===s?a.length&&(o={cardId:a[a.length-1],isSibling:!1}):o={cardId:r[s-1],isSibling:!0},s===r.length-1?a.length&&(i={cardId:a[a.length-1],isSibling:!1}):i={cardId:r[s+1],isSibling:!0}}}),{prevCard:o,nextCard:i}},n6()),j=g.prevCard,b=g.nextCard,C=null==b?void 0:b.cardId,y=null==j?void 0:j.cardId,O=(0,w.useMemo)(function(){var e=null,t=null;return n&&n.state.doc.descendants(function(n){return!(0,nF.KH)(n)||(n.attrs.id===y?e=n:n.attrs.id===C&&(t=n),!!(!e&&y)||!!(!t&&C))}),{prev:e,next:t}},[n,C,y]);return(0,ex.jsxs)(ex.Fragment,{children:[t&&(0,ex.jsx)(oz,{ref:p,setEasing:i,setTouchpadFactor:c,setTriggerThreshold:u}),(0,ex.jsx)(oM,{ref:x,direction:"up",node:O.prev,enabled:v,offset:16}),(0,ex.jsx)(oM,{ref:h,direction:"down",node:O.next,enabled:m,offset:24})]})},oz=w.forwardRef(function(e,n){var t=e.setEasing,r=e.setTouchpadFactor,o=e.setTriggerThreshold;return(0,ex.jsxs)(m.k,{position:"absolute",alignItems:"center",bg:"gray.100",left:2,bottom:16,zIndex:"overlay",borderRadius:"md",border:"solid 2px var(--chakra-colors-trueblue-300)",p:1,children:[(0,ex.jsxs)(om.v,{closeOnSelect:!1,children:[(0,ex.jsx)(ov.j,{as:eh.z,colorScheme:"trueblue",children:"Options"}),(0,ex.jsxs)(og.q,{minWidth:"240px",children:[(0,ex.jsx)(C.kH,{label:"How much total scrolling work do we need to do to trigger next/prev card?",placement:"right",children:(0,ex.jsxs)(v.x,{color:"gray",fontSize:"sm",fontWeight:"600",ml:2,pb:2,children:["Scroll Threshold"," ",(0,ex.jsxs)("i",{children:["(default=",1200,")"]})]})}),(0,ex.jsxs)(oj.Y2,{defaultValue:1200,min:100,max:1e4,precision:0,step:100,onChange:function(e,n){return o(n)},children:[(0,ex.jsx)(oj.zu,{}),(0,ex.jsxs)(oj.Fi,{children:[(0,ex.jsx)(oj.WQ,{}),(0,ex.jsx)(oj.Y_,{})]})]}),(0,ex.jsx)(ob.R,{}),(0,ex.jsx)(C.kH,{label:"How much extra weight do we give to touchpad scroll events?",placement:"right",children:(0,ex.jsxs)(v.x,{color:"gray",fontSize:"sm",fontWeight:"600",ml:2,pb:2,children:["Touchpad Multiplier"," ",(0,ex.jsxs)("i",{children:["(default=",1.5,")"]})]})}),(0,ex.jsxs)(oj.Y2,{defaultValue:1.5,min:1,max:10,precision:1,step:.1,onChange:function(e,n){return r(n)},children:[(0,ex.jsx)(oj.zu,{}),(0,ex.jsxs)(oj.Fi,{children:[(0,ex.jsx)(oj.WQ,{}),(0,ex.jsx)(oj.Y_,{})]})]}),(0,ex.jsx)(ob.R,{}),(0,ex.jsxs)(oC._,{defaultValue:"easeOutExpo",title:"Easing (of peek element)",type:"radio",onChange:function(e){return t(e)},children:[(0,ex.jsx)(oy.i,{value:"easeOutLinear",children:"easeOutLinear"}),(0,ex.jsx)(oy.i,{value:"easeOutSine",children:"easeOutSine"}),(0,ex.jsx)(oy.i,{value:"easeOutCubic",children:"easeOutCubic"}),(0,ex.jsx)(oy.i,{value:"easeOutCirc",children:"easeOutCirc"}),(0,ex.jsx)(oy.i,{value:"easeOutQuad",children:"easeOutQuad"}),(0,ex.jsx)(oy.i,{value:"easeOutQuart",children:"easeOutQuart"}),(0,ex.jsx)(oy.i,{value:"easeOutExpo",children:"easeOutExpo"}),(0,ex.jsx)(oy.i,{value:"bezierCustom1",children:"bezierCustom1"}),(0,ex.jsx)(oy.i,{value:"bezierCustom2",children:"bezierCustom2"})]})]})]}),(0,ex.jsx)(m.k,{ref:n,direction:"column",alignItems:"center",width:"85px",ml:1,sx:{".chakra-progress__indicator":{transition:"none !important",opacity:1}},children:(0,ex.jsx)(oO.D,{value:40,color:"trueblue.500",children:(0,ex.jsx)(ow.i,{})})})]})});oz.displayName="PeekDebugger";var oM=w.forwardRef(function(e,n){var t=e.direction,r=e.enabled,o=e.node,i=e.offset,s=(0,w.useState)(!1),a=s[0],c=s[1],l=(0,w.useState)(o),d=l[0],u=l[1];(0,w.useEffect)(function(){c(!0);var e=setTimeout(function(){c(!1),u(o)},550);return function(){clearTimeout(e)}},[o]);var f=(0,w.useMemo)(function(){return d?(0,eY.getCardTitle)(d.toJSON()):""},[d]),p=!!d;return(0,ex.jsx)(m.k,{ref:n,pointerEvents:"none",position:"absolute",justifyContent:"center",width:"100%",zIndex:"overlay",top:"up"===t?"".concat(i,"px"):"inherit",bottom:"down"===t?"".concat(i,"px"):"inherit",children:(0,ex.jsxs)(m.k,{bg:"gray.100",borderRadius:"md",boxShadow:"md",h:"".concat(40,"px"),maxWidth:"450px",justifyContent:"center",opacity:r?1:0,transition:"opacity ".concat(300,"ms ease-out"),textAlign:"center",alignItems:"center",direction:"row",px:2,sx:{".chakra-progress__indicator":{transition:"none !important",opacity:1}},children:[(0,ex.jsx)(oO.D,{display:p?"block":"none",color:"trueblue.500",size:"20px",thickness:"16px",children:(0,ex.jsx)(ow.i,{visibility:a?"visible":"hidden",children:(0,ex.jsx)(b.G,{icon:ra.faCircleCheck,fontSize:"14px",style:{color:"var(--chakra-colors-gray-100)",backgroundColor:"var(--chakra-colors-trueblue-500)",borderRadius:"10px"}})})}),p||"up"!==t?p||"down"!==t?null:(0,ex.jsx)(b.G,{icon:oh.m5,size:"xs",color:"var(--chakra-colors-gray-600)"}):(0,ex.jsx)(b.G,{icon:ox.yt,size:"xs",color:"var(--chakra-colors-gray-600)"}),(0,ex.jsx)(m.k,{width:1}),(0,ex.jsx)(v.x,{noOfLines:1,textOverflow:"ellipsis",overflowX:"hidden",fontSize:"md",color:p?"gray.800":"gray.600",px:2,children:p?f:"down"===t?"End of presentation":"Start of presentation"})]})})});oM.displayName="PeekCardTab";var oG=t(12741),oN=function(){var e=(0,w.useState)(["",[],{}]),n=e[0],t=e[1],r=(0,J.qr)();return(0,w.useEffect)(function(){return r.subscribe(function(){var e=r.getState(),n=(0,$.X9)(e),o=(0,$.i2)(e)||"",i=n.parents[o]||[],s={};Object.keys(n.tree).forEach(function(e){var t=[];(function e(n){Object.keys(n).forEach(function(r){t.push(r),e(n[r])})})(n.tree[e]),s[e]=t}),t([o,i,s])})},[r]),n},oZ=function(){var e=oN(),n=(0,A.Z)(e,3),t=n[0],r=n[1],o=n[2],i=Object.keys(o);return(0,ex.jsx)(ec.U,{position:"fixed",bottom:0,w:"100vw",zIndex:10,background:"blackAlpha.200",px:"6px",py:"2px",align:"end",spacing:"2px",opacity:t?1:0,transitionProperty:"opacity",transitionDuration:"normal",children:i.map(function(e,n){var s=[].concat((0,oG.Z)(r),[t])[0],a=i.indexOf(s),c=o[s],l=0,d=100;return t&&c&&-1===i.indexOf(t)&&(l=(c.indexOf(t)+1)/c.length*100,d=1/c.length*100),(0,ex.jsx)(oU,{cardId:e,state:n===a?"current":n<=a?"prev":"next",percent:l,unit:d},e)})})},oF="var(--chakra-colors-trueblue-200)",oW="var(--chakra-colors-trueblue-100)",oU=function(e){var n=e.cardId,t=e.state,r=e.percent,o=e.unit,i="linear-gradient(to right, ".concat(oF," 0% ").concat(r,"%, ").concat("var(--chakra-colors-trueblue-300)"," ").concat(r,"% ").concat(r+o,"%, ").concat(oW," ").concat(r+o,"% 100%)");return(0,ex.jsx)(m.k,{borderRadius:"2px",flex:"1",h:"6px",bg:"current"===t?i:"prev"===t?oF:oW},n)},oV=(0,r4.ZP)("Esc"),oB=function(e){var n=e.editor,t=e.showNavigationControls,r=(0,k.v9)($.gh)===nU.q.SLIDE_VIEW,o=(0,w.useState)(null),i=o[0],s=o[1],a=(0,k.v9)($.JA),c=(0,w.useRef)(a),l=(0,k.I0)(),d=ol({enabled:r&&!a,setActiveKey:s});return(0,w.useEffect)(function(){l((0,$.e)({isEditingInSlideView:!1}))},[r,l]),c.current=a,(0,w.useEffect)(function(){return r6.F7.on("keydown","SLIDE_VIEW",function(e){return!!(c.current&&oV(e))&&(l((0,$.e)({isEditingInSlideView:!1})),e.preventDefault(),!0)})},[l]),(0,r8.us)(),(0,ex.jsxs)(ex.Fragment,{children:[r&&(0,ex.jsx)(oL,{editor:n}),r&&(0,ex.jsx)(oZ,{}),r&&(0,ex.jsx)(m.k,{position:"absolute",inset:0,width:"100%",height:"100%",pointerEvents:"none",justify:"flex-end",children:(0,ex.jsxs)(m.k,{bg:"gray.50",position:"fixed",bottom:6,right:6,p:3,px:6,justify:"flex-end",align:"center",opacity:a?1:0,pointerEvents:a?"auto":"none",transitionProperty:"opacity, transform",transitionDuration:"normal",transitionTimingFunction:"ease",transform:a?"translate(0,0)":"translate(0,100%)",borderRadius:"md",shadow:"md",zIndex:"overlay",children:[(0,ex.jsx)(v.x,{size:"sm",mr:3,children:(0,ex.jsx)(h.cC,{id:"DjD/sG"})}),(0,ex.jsx)(eh.z,{size:"sm",variant:"solid",onClick:function(){return l((0,$.e)({isEditingInSlideView:!1}))},children:(0,ex.jsx)(h.cC,{id:"DPfwMq"})})]})}),r&&t&&(0,ex.jsx)(op,{activeKey:i,spotlightingByBlock:d})]})},oH=t(85946),oq=t(13414),oK={duration:.25,delay:.75},oY={duration:.25},oQ="filmstrip-root",oX=".".concat(oQ),oJ="filmstrip-scroller",o$=".".concat(oJ),o0=w.createContext({navItemPreviewRefMap:{}});function o1(){return(0,w.useContext)(o0)}var o2=t(6110),o5=t(38815),o3=t(11895),o4=t(52949);function o6(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var o8=function(e){var n=(0,o3.i)(e),t=n.content,r=n.selection,o=!!(null!=t&&t.content),i=(0,w.useMemo)(function(){if(!o)return[];var e,n=t.content,r=(null==n?void 0:n[0].content)||[],i=null===(e=t.content)||void 0===e?void 0:e[0].attrs;return r.map(function(e){var n;return i&&null!==(n=e.attrs)&&void 0!==n&&n.id?{cardId:e.attrs.id,isDragging:!1,displayBehavior:"normal"}:null}).filter(function(e){return null!==e})},[t,o]),s=(0,J.CG)(o4.ZD,function(e,n){return n6()(e,n)}).map(function(e){return i.find(function(n){return n.cardId===e.cardId})?function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o6(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o6(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({},e):null}).filter(function(e){return null!==e}),a=(0,J.CG)(o4.Ae);return{isDragging:a,cards:a?s:i,editorContent:t,selection:r,isLoaded:o}},o7=t(86733),o9=t(32649),ie=function(e){var n=e.onClose,t=e.isDark,r=e.viewPreference,o=e.setViewPreference,i="list"===r,s={backgroundColor:t?"gray.700":"gray.200",activeButtonColor:t?"gray.50":"trueblue.500",inactiveButtonColor:t?"gray.50":"gray.900",closeButtonColorScheme:t?"gray":"blackAlpha"},a=s.activeButtonColor,c=s.inactiveButtonColor,l=s.backgroundColor,d=s.closeButtonColorScheme,u=(0,n_.z$)(),f=(0,w.useCallback)(function(e){return function(){o(e),null==u||u.track(n_.AA.FILMSTRIP_TOGGLE_VIEW,{view:e})}},[u,o]);return(0,ex.jsxs)(m.k,{p:"8px",pb:"2px",children:[(0,ex.jsxs)(ec.U,{spacing:0,bg:l,p:.5,borderRadius:"md",children:[(0,ex.jsx)(C.kH,{label:"Filmstrip view",children:(0,ex.jsx)(eh.z,{size:"xs",variant:i?"ghost":"plain",color:i?c:a,onClick:f("film"),"data-testid":"filmstrip-view-button",children:(0,ex.jsx)(ec.U,{children:(0,ex.jsx)(b.G,{icon:oH.Cj})})})}),(0,ex.jsx)(C.kH,{label:"List view",children:(0,ex.jsx)(eh.z,{size:"xs",variant:i?"plain":"ghost",color:i?a:c,onClick:f("list"),"data-testid":"list-view-button",children:(0,ex.jsx)(ec.U,{children:(0,ex.jsx)(b.G,{icon:o9.Zr})})})})]}),(0,ex.jsx)(C.kH,{label:(0,ex.jsx)(h.cC,{id:"C8DFL7"}),shortcut:"Mod+\\",children:(0,ex.jsx)(z.h,{variant:"ghost","aria-label":x.ag._({id:"C8DFL7"}),"data-testid":"close-filmstrip-button",colorScheme:d,isRound:!0,size:"xs",icon:(0,ex.jsx)(b.G,{icon:o7.faXmark}),outlineOffset:"0px",ml:"auto",onClick:function(e){e.stopPropagation(),n()},onMouseDown:nd.br})})]})},it=t(5715),ir=t(46802),io=t(86378),ii=t(1587),is=t(43926),ia=t(82904),ic=t(38564),il=t(7935),id=t(9850),iu=t.n(id),ip=t(78308),ih=t(16975),ix=t(10221),im=t(90399),iv=t(60636),ig=t(33295),ij=function(e,n){var t=ic.Gk.getState(e.state).undoManager,r=t.undoStack[t.undoStack.length-1];r&&r.meta.set("filmstripState",n)},ib=function(e){var n=(0,J.CG)(o5.wg),t=(0,J.CG)(o5.zq),r=(0,J.TL)(),o=(0,eV.p)(),i=(0,w.useCallback)(function(t,r,i){if(e){var s,a=(0,nF.Lz)(e,n);if(a.length){var c=tO.HY.from(a),l=(0,nu.G8)(c,e.schema);if(!l){o({title:(0,ex.jsx)(h.cC,{id:"fFgBN7",values:{errorMessage:r}}),status:"error",duration:3e3,position:"top"});return}null===(s=document.getSelection())||void 0===s||s.removeAllRanges(),eX()(l,{format:"text/html"});var d=ix.Z.getState(e.state);d&&!i&&d.clearCutData(),o({title:(0,ex.jsx)(h.cC,{id:"8p/xVT",values:{0:a.length,1:t.one,2:t.other}}),status:"success",duration:3e3,position:"top"})}}},[e,n,o]),s=(0,w.useCallback)(function(){i({one:"Copied card.",other:"Copied ".concat(n.length," cards.")},"Error copying card.",!1)},[i,n]),a=(0,w.useCallback)(function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e){var o=(0,o5.ym)((0,J.bh)().getState());r((0,o5.jf)()),e.commands.deleteCardsById(n,t),ij(e,o)}},[r,e,n]),c=(0,w.useCallback)(function(){if(e){var t="";if(1===n.length){var r=(0,nF.Bw)(e,n[0]);r&&(t=(0,il.getCardTitle)(r.node.toJSON()))}a();var i=t?'"'.concat(t,'"'):x.ag._({id:"FyJPFh"}),s=o({title:(0,ex.jsxs)(ec.U,{children:[(0,ex.jsx)(v.x,{noOfLines:1,children:(0,ex.jsx)(h.cC,{id:"OJTPnC",values:{0:n.length,1:n.length,displayTitle:i}})}),(0,ex.jsx)(eB.r,{textDecoration:"underline",onClick:function(){(0,eK.Yw)(e.state),o.close(s)},children:(0,ex.jsx)(h.cC,{id:"9uI/rE"})})]}),status:"info",duration:3e3,position:"top"})}},[a,e,n,o]),l=(0,w.useCallback)(function(){i({one:"Cut card.",other:"Cut ".concat(n.length," cards")},"Error cutting card.",!0),a(!0)},[a,i,n]),d=(0,w.useCallback)(function(){if(e){var i=(0,nF.Lz)(e,n);if(i.length){var s=(0,nF.Bw)(e,t),a=s?s.pos+s.node.nodeSize:e.state.doc.content.size-1,c=i.map(function(e){return(0,ig.h)(iu()(e.toJSON()))}).map(function(e){return(0,im.Zs)(e)}),l=(0,o5.ym)((0,J.bh)().getState());e.chain().insertContentAt(a,c,{updateSelection:!1}).command(function(e){var n=e.tr,t=(0,iv.t)(n.doc.resolve(a));return t&&(n=n.setSelection(t)),!0}).scrollIntoView().run(),ij(e,l),r((0,o5.xi)({beforeCardId:null==s?void 0:s.node.attrs.id,cardCount:c.length})),o({title:(0,ex.jsx)(h.cC,{id:"ClnFsQ",values:{0:i.length,1:i.length}}),status:"success",duration:3e3,position:"top"})}}},[r,e,t,o,n]);return{handleAddCard:(0,w.useCallback)(function(){if(e){var n=(0,o5.zq)((0,J.bh)().getState()),t=(0,nF.Bw)(e,n);if(t){var o=t.pos,i=e.view.state.doc.nodeAt(o);if(!i){console.error("[Filmstrip] Cannot append card. Node unknown");return}var s=o+i.nodeSize,a=ih.e1.blankCard;(0,ih.ZT)({key:"blankCard",nodeName:"card"},ip.fe.FILMSTRIP_CARD_MENU);var c=(0,o5.ym)((0,J.bh)().getState());e.chain().insertContentAt(s,(0,im.Zs)(a),{updateSelection:!1}).command(function(e){var n=e.tr,t=(0,iv.t)(n.doc.resolve(s));return t&&(n=n.setSelection(t)),!0}).scrollIntoView().run(),ij(e,c),r((0,o5.xi)({beforeCardId:null==t?void 0:t.node.attrs.id,cardCount:1}))}}},[r,e]),handleCopy:s,handleDelete:c,handleCut:l,handleDuplicate:d}},iC=["children","icon","onClick","shouldHide"];function iy(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function iO(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?iy(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):iy(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var iw=function(e){var n=e.children,t=e.icon,r=e.onClick,o=e.shouldHide,i=(0,eR.Z)(e,iC);return void 0!==o&&o?null:(0,ex.jsx)(ia.s,iO(iO({icon:t,onClick:r},i),{},{children:n}))},ik=(0,w.memo)(function(e){var n=e.isDark;return(0,ex.jsxs)(g.xu,{as:"span",className:"fa-layers fa-fw",children:[(0,ex.jsx)(b.G,{fixedWidth:!0,icon:is.faRectangle}),(0,ex.jsx)(b.G,{icon:ir.di,transform:"shrink-4 right-6 down-4",color:"var(--menu-bg, white)"}),(0,ex.jsx)(b.G,{icon:ir.di,transform:"shrink-7 right-6 down-4"}),(0,ex.jsx)(b.G,{icon:it.r8,color:n?"var(--chakra-colors-gray-800)":"var(--chakra-colors-gray-100)",transform:"shrink-10 right-6 down-4"})]})});ik.displayName="AddCardIcon";var iS=function(e,n){if(0===e.length||!n)return null;if(1===e.length){var t=(0,nF.Bw)(n,e[0]);return t?(0,eY.getCardTitle)(t.node.toJSON())||"Untitled card":null}return"Multiple cards selected"},iI=(0,w.forwardRef)(function(e,n){var t=e.editor,r=e.isOpen,o=e.onClose,i=e.readOnly,s=e.clearPositioning,a=e.rootStyles,c=e.isDark,l=(0,J.CG)($.yx),d=(0,eV.p)(),u=ib(t),f=u.handleCopy,p=u.handleDelete,x=u.handleCut,m=u.handleDuplicate,g=u.handleAddCard,j=(0,J.CG)(o5.wg),y=1===j.length,O=(0,w.useMemo)(function(){return y?(0,rs.gq)({cardId:j[0],docId:null==l?void 0:l.id,isPresentMode:!1}):""},[null==l?void 0:l.id,y,j]),k=(0,eH.V)(O).onCopy,S=(0,w.useCallback)(function(){k(),d({title:(0,ex.jsx)(h.cC,{id:"h5GS+N"}),status:"success",duration:3e3,position:"top"})},[k,d]),I=(0,np.K)(),P=(0,w.useMemo)(function(){return iS(j,t)},[t,j]),E=(0,w.useMemo)(function(){return c?{"--menu-bg":"var(--chakra-colors-gray-900)","&:focus":{"--menu-bg":"var(--chakra-colors-gray-800)"}}:{}},[c]);return(0,ex.jsx)(om.v,{isOpen:r,onClose:o,children:(0,ex.jsxs)(og.q,{className:"filmstrip-card-menu",onContextMenu:function(e){e.preventDefault()},zIndex:"popover",ref:n,rootProps:{style:a},w:"260px",overflowY:"auto",onTransitionEnd:function(){r||s()},children:[P&&(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(v.x,{pl:3,color:c?"gray.400":"gray.600",noOfLines:1,"data-testid":"filmstrip-card-menu-card-title",children:P}),(0,ex.jsx)(ob.R,{})]}),(0,ex.jsx)(iw,{"data-testid":"filmstrip-card-menu-item-cut",shouldHide:i,command:(0,C.cE)("Mod+X"),icon:(0,ex.jsx)(b.G,{fixedWidth:!0,icon:ii.XV}),onClick:x,children:(0,ex.jsx)(h.cC,{id:"cCd8Bs"})}),(0,ex.jsx)(iw,{"data-testid":"filmstrip-card-menu-item-copy",shouldHide:i,command:(0,C.cE)("Mod+C"),icon:(0,ex.jsx)(b.G,{fixedWidth:!0,icon:io.kZ}),onClick:f,children:(0,ex.jsx)(h.cC,{id:"he3ygx"})}),(0,ex.jsx)(iw,{"data-testid":"filmstrip-card-menu-item-duplicate",shouldHide:i,command:(0,C.cE)("Mod+D"),icon:(0,ex.jsx)(b.G,{fixedWidth:!0,icon:eW.WM}),onClick:m,children:(0,ex.jsx)(h.cC,{id:"euc6Ns"})}),(0,ex.jsx)(iw,{"data-testid":"filmstrip-card-menu-item-add-card",shouldHide:i,icon:(0,ex.jsx)(ik,{isDark:c}),onClick:g,sx:E,children:(0,ex.jsx)(h.cC,{id:"90n2YU"})}),!i&&(0,ex.jsx)(ob.R,{}),(0,ex.jsx)(iw,{"data-testid":"filmstrip-card-menu-item-copy-link",shouldHide:!y,icon:(0,ex.jsx)(nf.x,{isLocked:!I,isDark:c}),onClick:S,children:(0,ex.jsx)(h.cC,{id:"F0YmUY"})}),(0,ex.jsx)(iw,{"data-testid":"filmstrip-card-menu-item-delete",color:c?"red.300":"red.500",icon:(0,ex.jsx)(b.G,{icon:eZ.$,fixedWidth:!0}),onClick:p,shouldHide:i,children:(0,ex.jsx)(h.cC,{id:"cnGeoo"})})]})})});iI.displayName="FilmstripCardMenuComponent";var iP=(0,w.memo)(iI),iE=t(17033),iD=t(57474),iA=t(79183),iT=(0,e0.E)(g.xu),i_=function(e){var n=e.isEditorFocused,t=e.isFilmstripSelected,r=e.shouldHide,o=e.cardId,i=e.isDraggingCard,s=e.index;return(0,ex.jsxs)(m.k,{boxShadow:t?"var(--fs-item-selected-box-shadow)":n?"var(--fs-item-focused-box-shadow)":"var(--fs-item-box-shadow)",transitionProperty:"common",transitionDuration:"normal",borderRadius:"sm",overflow:"hidden",display:r?"none":void 0,children:[(0,ex.jsx)(iR,{cardId:o}),(0,ex.jsx)(e1.M,{children:!r&&!i&&(0,ex.jsx)(iT,{position:"absolute",exit:{opacity:0},transition:{duration:.2},bottom:1,left:1,px:1.5,borderRadius:"md",boxShadow:"base",borderWidth:"1px",borderColor:"var(--fs-item-card-number-border-color)",bg:"var(--fs-item-card-number-background-color)",color:"var(--fs-item-card-number-color)",fontWeight:600,fontSize:"xs",children:(0,ex.jsx)(v.x,{children:s})},s)})]})},iR=function(e){var n=e.cardId,t=o1().navItemPreviewRefMap,r=(0,J.CG)($.Pu),o=(0,iD.J)(r,!1);return(0,ex.jsx)(m.k,{className:"filmstrip-nav-item-wrapper",sx:tD.n,css:{"--editor-font-size":"calc(var(--editor-width) / ".concat(iA.DB,")"),"--thumbnail-min-height":"calc(var(--editor-width) * 0.4)"},justifyContent:"center",overflow:"hidden",pointerEvents:"none",bg:"gray.100",minH:"var(--thumbnail-min-height)",maxH:"calc(var(--editor-width) * 1.5)",w:"var(--editor-width)",children:(0,ex.jsx)("div",{className:"ProseMirror",children:(0,ex.jsx)(m.k,{className:"doc-content-wrapper",direction:"column",align:"center",sx:o,children:(0,ex.jsx)("div",{style:{width:"100%"},ref:function(e){e&&(t[n]=e)}})})})})},iL=t(24963),iz=function(e){var n=e.cardId,t=e.index,r=e.isEditorFocused,o=e.isFilmstripSelected,i=(0,n8.T)({cardId:n}).title;return(0,ex.jsxs)(m.k,{className:"filmstrip-nav-item-wrapper",w:"var(--editor-width)",justifyContent:"flex-start",fontSize:"xs",borderRadius:"sm",boxShadow:o?"var(--fs-text-item-selected-box-shadow)":r?"var(--fs-item-focused-box-shadow)":"var(--fs-item-box-shadow)",color:o?"trueblue.500":void 0,transitionProperty:"common",transitionDuration:"normal",_hover:{".filmstrip-text-item-number":{display:"none"},".filmstrip-text-drag-handle":{display:"block"}},children:[(0,ex.jsxs)(m.k,{alignItems:"center",bg:o?"trueblue.100":"var(--fs-text-item-card-number-bg-color)",transitionProperty:"common",transitionDuration:"normal",children:[(0,ex.jsx)(g.xu,{className:"filmstrip-text-item-number",w:6,fontSize:t>=1e3?"0.6rem":void 0,textAlign:"center",overflow:"hidden",whiteSpace:"nowrap",children:t}),(0,ex.jsx)(g.xu,{className:"filmstrip-text-drag-handle",display:"none",textAlign:"center",w:6,fontSize:"md",_hover:{cursor:"grab"},children:(0,ex.jsx)(b.G,{icon:iL.Ok})})]}),(0,ex.jsx)(m.k,{"data-testid":"filmstrip-text-item-title",p:2,pl:"4px",flex:1,bg:o?"trueblue.50":"var(--fs-text-item-bg-color)",alignItems:"center",overflow:"hidden",transitionProperty:"common",transitionDuration:"normal",children:(0,ex.jsx)(v.x,{noOfLines:1,children:i||"Untitled"})})]})},iM=function(e){var n=e.filmstripItemRef,t=e.cardId,r=e.isFilmstripSelected,o=e.currentFocusedCard,i=e.editor,s=e.isAnimating,a=(0,nZ.As)("filmstrip"),c=(0,J.CG)(o5.DM);(0,w.useEffect)(function(){n.current&&t===o&&(null!=i&&i.isFocused&&!s?a.scrollElementIntoView({element:n.current,offsetFromTop:120}):r&&t===c&&requestAnimationFrame(function(){if(n.current&&a.scroller){var e=a.scroller.getBoundingClientRect(),t=n.current.getBoundingClientRect(),r=t.top,o=t.bottom,i=t.height,s=0,c=n.current.closest(".reorder-item");if(c instanceof HTMLElement&&(s=c.offsetTop),o>=e.bottom){var l=Math.max(0,s+i-a.scroller.clientHeight+4);a.scrollTo({top:l})}else r<=e.top&&a.scrollTo({top:s})}}))},[t,o,i,c,r,a,n,s])},iG=t(13720),iN=function(){var e=(0,iG.i)({lg:100,xl:125,"2xl":150})||100,n=(0,J.CG)(o5.K5),t=null!==n?n:e;return{previewWidth:t,width:t+40,fontSize:t/iA.DB}},iZ=(0,e0.E)(m.k),iF=function(e){var n=e.card,t=e.index,r=e.isFirst,o=e.isEditorFocused,i=e.currentFocusedCard,s=e.isFilmstripSelected,a=e.readOnly,c=e.shouldHide,l=e.isDragInProgress,d=e.numberOfCardsDragging,u=e.onContextClick,f=e.editor,p=e.isAnimating,h=e.showTextOnly,x=n.cardId,m=n.isDragging,j=(0,w.useRef)(null);iM({filmstripItemRef:j,cardId:x,isFilmstripSelected:s,currentFocusedCard:i,editor:f,isAnimating:p});var b=(0,J.TL)(),C=iN().previewWidth,y=(0,w.useCallback)(function(e){if(x){var n=e.shiftKey,t=!n&&(e.metaKey||e.ctrlKey);if(n&&!a)b((0,o5.YC)({id:x,currentFocusedCard:i}));else if(t&&!a)b((0,o5.sY)({id:x}));else{if(l)return;b((0,o5.Ti)({id:x})),b((0,$.Qx)({attached:!1})),f&&(0,iE.YS)({cardId:x,editor:f})}}},[x,a,b,i,l,f]);return(0,ex.jsxs)(g.xu,{className:"filmstrip-item",ref:j,pos:"relative",pt:h?void 0:1,mt:h?1.5:r?void 0:1,onClick:y,onContextMenu:u,cursor:"pointer",userSelect:"none",transitionProperty:"common",transitionDuration:"normal",display:c?"none":void 0,"data-filmstrip-selected":s,"data-filmstrip-view":h?"list":"filmstrip",css:{"--editor-width":"".concat(C,"px")},children:[h&&(0,ex.jsx)(iz,{cardId:x,index:t,isFilmstripSelected:s,isEditorFocused:o}),(0,ex.jsx)(i_,{shouldHide:h,cardId:x,index:t,isDraggingCard:m,isFilmstripSelected:s,isEditorFocused:o}),(0,ex.jsx)(e1.M,{children:d&&(0,ex.jsx)(g.xu,{position:"absolute",bottom:0,left:0,transform:"translate(-50%, 50%)",children:(0,ex.jsx)(iZ,{initial:{scale:.5,opacity:0},exit:{scale:.5,opacity:0},animate:{scale:1,opacity:1},h:5,minW:5,px:1,borderRadius:"full",bg:"trueblue.300",color:"white",fontSize:"xs",fontWeight:600,boxShadow:"sm",justify:"center",align:"center",children:(0,ex.jsx)(v.x,{children:d})},"badge-number")})})]})},iW=t(28316),iU=t(12691),iV=(0,w.memo)(function(e){var n=e.content,t=e.theme,r=(0,w.useState)(!1),o=r[0],i=r[1];return((0,w.useEffect)(function(){requestAnimationFrame(function(){i(!0)})},[]),o)?(0,ex.jsx)(tD.m,{theme:t,content:n,isThumbnail:!0,portalComponent:iB}):null}),iB=function(e){var n=e.renderers,t=o1().navItemPreviewRefMap;return(0,ex.jsx)(ex.Fragment,{children:Object.entries(n).map(function(e){var n=(0,A.Z)(e,2),r=n[0],o=n[1],i=o.props.node;if("document"===i.type.name)return null;var s=(0,iU.KH)(i)?t[i.attrs.id]:null;return iW.createPortal(o.reactElement,s||o.element,r)})})};iV.displayName="FilmstripPreviewEditor";var iH=t(20362),iq=(0,w.memo)(function(e){var n=e.onClose,t=e.isDark,r=e.isResizing,o=e.setIsResizing,i=iN().previewWidth,s=(0,w.useRef)(null),a=(0,w.useRef)(i),c=(0,w.useRef)(null),l=(0,J.TL)(),d=(0,w.useCallback)(function(e){if(e.preventDefault(),s.current&&a.current&&c.current){var t=s.current,r=t.width,o=t.x,i=e.clientX-o;if(r+i<=30){n();return}var l=oE()(r+i,90,200);l!==a.current&&(a.current=l,c.current.innerHTML="\n          .filmstrip-nav-item-wrapper {\n            --editor-width: ".concat(l,"px;\n          }"))}},[n]),u=(0,iH.Z_)(d,30),f=(0,w.useCallback)(function(e){e.preventDefault(),s.current={x:e.clientX,width:a.current},o(!0),document.addEventListener("mousemove",u),document.addEventListener("mouseup",function e(){s.current=null,c.current&&(c.current.innerHTML=""),l((0,o5.lh)({width:a.current})),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",e),requestAnimationFrame(function(){o(!1)})})},[l,o,u]);return(0,ex.jsxs)(m.k,{className:"filmstrip-resizer",css:{"--resizer-width":"24px","--resizer-offset":"4px","--drag-handle-width":"4px"},pos:"absolute",top:0,bottom:0,right:"calc(var(--resizer-width) * -1 + var(--resizer-offset))",opacity:0,w:"var(--resizer-width)",bg:t?"whiteAlpha.200":"blackAlpha.200",h:"100%",transitionProperty:"common",transitionDuration:"normal",transitionTimingFunction:"ease",justify:"center",alignItems:"center",borderTopEndRadius:"md",borderBottomEndRadius:"md",boxShadow:"md",_hover:{cursor:"ew-resize"},onMouseDown:f,zIndex:10,children:[(0,ex.jsx)("style",{ref:c}),(0,ex.jsx)(g.xu,{position:"relative",left:"calc(var(--resizer-offset) - (var(--drag-handle-width) / 2))",bg:"white",borderRadius:"full",w:"var(--drag-handle-width)",h:"40px",opacity:r?1:.6,transitionProperty:"common",transitionDuration:"normal"})]})});iq.displayName="FilmstripResizer";var iK=function(e,n){if(!e||!n)return{id:null,pos:null};var t=e.$from,r=e.from,o=e.to,i=null,s=null;return t.doc.nodesBetween(r,o,function(e,n){var r=t.doc.resolve(n).depth;return!(!i&&(0,nF.KH)(e))||1!==r||(i=e.attrs.id,s=n,!1)}),{id:i,pos:s}},iY=function(){var e;return!!(null!==(e=document.activeElement)&&void 0!==e&&e.closest(oX))},iQ=function(){var e=(0,w.useRef)(null),n=(0,w.useState)(!1),t=n[0],r=n[1],o=(0,w.useState)([0,0]),i=o[0],s=o[1],a=(0,w.useState)("bottom"),c=a[0],l=a[1],d=(0,J.TL)(),u=(0,w.useCallback)(function(){r(!1)},[]),f=(0,w.useCallback)(function(){s([0,0]),l("bottom")},[]),p=(0,w.useCallback)(function(e){r(!0),s(e)},[]),h=(0,w.useCallback)(function(n){return function(t){t.preventDefault(),d((0,o5.uu)({id:n})),p([t.clientX,t.clientY]);var r,o=null===(r=e.current)||void 0===r?void 0:r.offsetHeight;if(null!=o){var i=window.innerHeight<t.clientY+o,s=t.clientY<o;i&&!s?l("top"):i&&s?l("center"):l("bottom")}}},[d,e,p]),x=(0,w.useMemo)(function(){var n,t=i[1],r=null===(n=e.current)||void 0===n?void 0:n.offsetHeight,o=r?window.innerHeight-(t+r+8):void 0,s="center"===c&&o?"translateY(".concat(o,"px)"):"top"===c?"translateY(-100%)":void 0;return{left:i[0],top:i[1],transform:s,transformOrigin:"top"}},[c,i]);return{menuRef:e,isFilmstripCardMenuOpen:t,onFilmstripCardMenuClose:u,handleContextMenu:h,menuRootStyles:x,clearPositioning:f}},iX=nG()(tt.YS,200),iJ=function(e){var n=e.isFocused,t=e.readOnly,r=e.firstFocusedCardId,o=e.editor,i=e.isDragging,s=ib(o),a=s.handleCopy,c=s.handleDelete,l=s.handleCut,d=s.handleDuplicate,u=(0,J.TL)(),f=(0,J.qr)();(0,w.useEffect)(function(){return n$.F7.on("keydown","FILMSTRIP",function(e){if(!n)return!1;switch(e.key){case"Escape":if(i)return u((0,o4.vL)()),!0;return!1;case"Backspace":case"Delete":if(!t)return c(),!0;return!1;case"a":case"A":if(!t&&(e.ctrlKey||e.metaKey))return e.preventDefault(),u((0,o5.td)({currentFocusedCard:r})),!0;return!1;case"c":case"C":if(!t&&(e.ctrlKey||e.metaKey))return a(),!0;return!1;case"d":case"D":if(!t&&(e.ctrlKey||e.metaKey))return e.preventDefault(),d(),!0;return!1;case"x":case"X":if(!t&&(e.ctrlKey||e.metaKey))return l(),!0;return!1;case"ArrowDown":u((0,o5.ut)({direction:"down",withShift:!t&&e.shiftKey,currentFocusedCard:r}));var s=(0,o5.wg)(f.getState())[0];return!e.shiftKey&&o&&s&&(iX({cardId:s,editor:o}),u((0,$.Qx)({attached:!1}))),!0;case"ArrowUp":u((0,o5.ut)({direction:"up",withShift:!t&&e.shiftKey,currentFocusedCard:r}));var p=(0,o5.wg)(f.getState())[0];return!e.shiftKey&&o&&p&&(iX({cardId:p,editor:o}),u((0,$.Qx)({attached:!1}))),!0;default:return!1}})},[u,r,n,i,c,a,d,l,t,o,f])},i$=t(74993),i0=function(e){var n=(0,J.qr)(),t=(0,eV.p)(),r=(0,J.TL)();(0,w.useEffect)(function(){var o=function(o){var i,s=n.getState();if(e&&iY()&&(0,$.hN)(s)){var a=null===(i=o.clipboardData)||void 0===i?void 0:i.getData("text/html");if(a){var c=(0,i$.T)(a,e.schema).content.content.filter(function(e){return(0,iU.KH)(e)});if(c.length){var l=(0,nF.Bw)(e,(0,o5.zq)(s)),d=l?l.pos+l.node.nodeSize:e.state.doc.content.size-1,u=c.map(function(e){return(0,ig.h)(iu()(e.toJSON()))}).map(function(e){return(0,im.Zs)(e)}),f=(0,o5.ym)((0,J.bh)().getState());e.chain().insertContentAt(d,u,{updateSelection:!1}).command(function(e){var n=e.tr;n.setMeta("annotationEvent",{type:"filmstrip-paste",insertPos:d});var t=(0,iv.t)(n.doc.resolve(d));return t&&(n=n.setSelection(t)),!0}).scrollIntoView().run(),o.preventDefault(),ij(e,f),r((0,o5.xi)({beforeCardId:null==l?void 0:l.node.attrs.id,cardCount:u.length})),t({title:(0,ex.jsx)(h.cC,{id:"3viq5b",values:{0:c.length,1:c.length}}),status:"success",duration:3e3,position:"top"})}}}};return document.addEventListener("paste",o),function(){document.removeEventListener("paste",o)}},[r,e,n,t])},i1=t(30453),i2=function(){var e=(0,i1.o)(),n=(0,w.useRef)(null),t=(0,w.useRef)(),r=(0,w.useRef)(),o=(0,w.useRef)(),i=(0,w.useCallback)(function(e){if(o.current){var n=i3(o.current),i=e.target;if(n&&i&&void 0!==t.current&&void 0!==r.current){var s=i.scrollTop-t.current;n.y=r.current-s}}},[]),s=(0,w.useCallback)(function(e,t){var r=n.current;if(r){var o=r.getBoundingClientRect(),i=t.point.y,s=e.target;if(s instanceof Element){var a=s.closest("[draggable]"),c=null==a?void 0:a.parentElement;c&&(i<o.top+25&&(a!==c.firstElementChild||r.scrollTop>0)?r.scrollTop-=5:i>o.bottom-25&&(a!==c.lastElementChild||r.scrollTop<r.scrollHeight)&&(r.scrollTop+=5))}}},[]),a=(0,w.useCallback)(function(){var i=n.current,s=i5(e);if(i&&s){o.current=s,t.current=i.scrollTop;var a=i3(s);a&&(r.current=a.y)}},[e]);return{scrollerRef:n,onScroll:i,dragControls:e,onDrag:s,onDragStart:a,onDragEnd:(0,w.useCallback)(function(){t.current=void 0,r.current=void 0,o.current=void 0},[])}},i5=function(e){try{return Array.from(e.componentControls).find(function(e){return e.isDragging})}catch(e){console.error("[caught] findDraggingElementControls",e);return}},i3=function(e){try{return e.panSession.history[0]}catch(e){console.error("[caught] getDraggingElementStartPoint",e);return}};function i4(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function i6(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i4(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i4(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var i8=(0,e0.E)(m.k),i7=(0,e0.E)(g.xu),i9="data-".concat(ts.dh),se=function(e){var n,t=e.onClose,r=e.editor,o=e.readOnly,i=(0,w.useState)(!1),s=i[0],a=i[1],c=(0,ee._)(en.H.filmstripViewPreference,"film"),l=(0,A.Z)(c,2),d=l[0],u=l[1],p=(0,w.useRef)(null),h=o8(r),x=h.cards,v=h.isDragging,j=h.editorContent,b=h.selection,C=h.isLoaded,y=(0,w.useMemo)(function(){return iK(b,r)},[r,b]).id,O=(0,J.TL)(),k=(0,J.CG)(o5.wg),S=(0,J.CG)(o4.pe),I=(0,J.CG)(o4.u9),P=(0,J.CG)(o4.K3),E=(0,w.useState)(!1),D=E[0],T=E[1],_=iQ(),R=_.menuRef,L=_.isFilmstripCardMenuOpen,z=_.onFilmstripCardMenuClose,M=_.clearPositioning,G=_.handleContextMenu,N=_.menuRootStyles,Z=(0,w.useCallback)(function(){if(z(),s){var e;null===(e=p.current)||void 0===e||e.focus()}},[s,z]),F=i2(),W=F.scrollerRef,U=F.onScroll,V=F.dragControls,B=F.onDrag,H=F.onDragStart,q=F.onDragEnd,K=(0,w.useCallback)(function(e){return function(){if(T(!0),H(),p.current){var n=p.current.getBoundingClientRect().height;p.current.style.height="".concat(n,"px")}var t=k.includes(e)?k:[e];O((0,o5.WF)({selectedCardIdsToDrag:t})),O((0,o4.CA)({cardIds:x.map(function(e){return e.cardId}),leaderCardId:e,selectedCardIds:t}))}},[x,O,k,H]),Y=(0,w.useCallback)(function(){r&&(O((0,o4.vL)()),r.commands.rearrangeCardsById(x.map(function(e){return e.cardId}),I),q())},[x,O,r,I,q]),Q=(0,w.useCallback)(function(){p.current&&(p.current.style.height="auto"),T(!1)},[]);i0(r),iJ({isFocused:s,readOnly:o,firstFocusedCardId:y,editor:r,isDragging:v}),(0,eA.O)({ref:p,handler:function(e){R.current&&R.current.contains(e.target)||(L&&z(),O((0,o5.Mt)()))}});var X=(0,J.CG)($.Pu),et=(0,eq.ff)("whiteAlpha.600","whiteAlpha.100"),er=(0,eq.ff)("#F9FAFBDD","gray.900"),eo=(0,eq.ff)("gray.800","gray.200"),ei=(0,eq.ff)("blackAlpha.400","whiteAlpha.500"),es="dark"===(0,eq.If)().colorMode,ea=(0,w.useMemo)(function(){return{"--fs-item-border-color":es?"var(--chakra-colors-whiteAlpha-300)":"var(--chakra-colors-gray-200)","--fs-text-item-selected-border-color":"var(--chakra-colors-trueblue-100)","--fs-item-box-shadow":"0 0 0 1px var(--fs-item-border-color)","--fs-item-focused-box-shadow":"0 0 0 2px var(--chakra-ring-color)","--fs-item-selected-box-shadow":"0 0 0 2px var(--chakra-colors-trueblue-300)","--fs-text-item-selected-box-shadow":"0 0 0 1px var(--fs-text-item-selected-border-color)","--fs-item-card-number-border-color":es?"var(--chakra-colors-gray-800)":"var(--chakra-colors-gray-200)","--fs-item-selected-text-color":es?"var(--chakra-colors-trueblue-200)":"var(--chakra-colors-trueblue-500)","--fs-item-card-number-color":es?"var(--chakra-colors-gray-100)":"var(--chakra-colors-gray-800)","--fs-item-card-number-background-color":es?"var(--chakra-colors-gradient-dark)":"var(--chakra-colors-gradient-light)","--fs-text-item-bg-color":es?"var(--chakra-colors-gray-800)":"var(--chakra-colors-gray-100)","--fs-text-item-card-number-bg-color":es?"var(--chakra-colors-gray-700)":"var(--chakra-colors-gray-200)"}},[es]),ec=(0,w.useState)(!1),el=ec[0],ed=ec[1],eu={initial:{x:-(n=iN().width)},animate:{x:0,transition:oK},exit:{x:-n,transition:oY}},ef=(0,w.useMemo)(function(){var e=I.length;return v&&e>1?e:null},[v,I.length]),ep=(0,w.useState)(!1),eh=ep[0],em=ep[1],ev=(0,nZ.As)("filmstrip");return(0,w.useEffect)(function(){ev.setScrollSelector(o$)},[ev]),(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsxs)(m.k,{pointerEvents:"none",position:"absolute",direction:"column",left:2,top:12,bottom:2,justifyContent:"center",color:eo,children:[r&&C&&(0,ex.jsx)(iV,{content:j,theme:X}),(0,ex.jsxs)(g.xu,{pos:"relative",pointerEvents:"auto",_hover:{".filmstrip-resizer":{opacity:eh?0:1}},maxHeight:"100%",children:[(0,ex.jsxs)(i8,i6(i6(i6({ref:p,"data-guider-highlight":"filmstrip",className:oQ},(0,f.Z)({},i9,!0)),{},{pos:"relative",direction:"column",zIndex:11},eu),{},{onAnimationStart:function(){em(!0)},onAnimationComplete:function(){em(!1)},tabIndex:0,_focus:{outline:"none"},onFocus:function(){a(!0),null==r||r.commands.blur()},onBlur:function(e){var n,t;p.current&&null!==(n=p.current)&&void 0!==n&&n.contains(e.relatedTarget)||null!==(t=R.current)&&void 0!==t&&t.contains(e.relatedTarget)||a(!1)},borderRadius:"md",bg:er,borderWidth:"1px",borderColor:et,shadow:"lg",backdropFilter:"blur(20px)",maxHeight:"100%",alignSelf:"flex-start",children:[(0,ex.jsx)(ie,{isDark:es,onClose:t,viewPreference:d,setViewPreference:u}),(0,ex.jsx)(i7,{className:oJ,layoutScroll:!0,overflowY:"auto",position:"relative",sx:i6({"&::-webkit-scrollbar":{opacity:1,width:"5px"},"&::-webkit-scrollbar-track":{opacity:0,width:"5px"},"&::-webkit-scrollbar-thumb":{background:ei,borderRadius:"full"}},ea),ref:W,onScroll:U,p:"8px",pt:0,children:(0,ex.jsx)(o2.t.Group,{onReorder:function(e){var n=e.map(function(e){return e.cardId});O((0,o4.k)({reorderedCardIds:n}))},values:x,axis:"y",children:r&&C&&x.map(function(e,n){var t=e.cardId,i=e.displayBehavior,s=k.includes(t),a=P===t;return(0,ex.jsx)(o2.t.Item,{drag:!o&&"y",value:e,onDragStart:K(t),onDragEnd:Y,onDragTransitionEnd:Q,className:"reorder-item",dragControls:V,transition:{layout:{duration:el?0:void 0}},onDrag:B,style:{position:"relative",listStyle:"none"},children:(0,ex.jsx)(iF,{readOnly:o,editor:r,card:e,index:v&&void 0!==S[t]?S[t]:n+1,isFirst:0===n,shouldHide:"hidden"===i,isDragInProgress:D,isEditorFocused:y===t&&r.isFocused,isFilmstripSelected:!!s,currentFocusedCard:y,numberOfCardsDragging:a?ef:null,onContextClick:G(t),isAnimating:eh,showTextOnly:"list"===d})},t)})})})]})),(0,ex.jsx)(iq,{onClose:t,isDark:es,isResizing:el,setIsResizing:ed})]})]}),r&&(0,ex.jsx)(iP,{ref:R,editor:r,readOnly:o,isOpen:L,onClose:Z,clearPositioning:M,rootStyles:N,isDark:es})]})},sn=function(){var e=(0,J.TL)(),n=(0,J.CG)(o5.GX),t=(0,iG.i)({base:!1,lg:!0})||!1,r=(0,w.useState)(!1),o=r[0],i=r[1],s=(0,w.useState)(!1),a=s[0],c=s[1],l=(0,w.useCallback)(function(){e((0,o5.dQ)({isOpen:!1})),e((0,o5.Mt)()),c(!0)},[e]),d=(0,w.useCallback)(function(){t||i(!0),e((0,o5.dQ)({isOpen:!0}))},[t,e]),u=!t&&o;return(0,w.useEffect)(function(){var n=!t&&!o,r=t&&!a;n?e((0,o5.dQ)({isOpen:!1})):r&&e((0,o5.dQ)({isOpen:!0}))},[e,t,o,a]),{onClose:l,onOpen:d,isOpen:n&&(t||!t&&u)}},st=(0,e0.E)(eh.z),sr=(0,w.memo)(function(){var e=(0,td._i)().editor,n=sn(),t=n.isOpen,r=n.onClose,o=n.onOpen,i=(0,w.useRef)({navItemPreviewRefMap:{}}),s=(0,ts.Br)("edit"),a=(0,J.CG)($.hN),c=(0,eP.Yy)(),l=(0,w.useState)(!1),d=l[0],u=l[1],f=(0,w.useCallback)(function(){u(!0),setTimeout(function(){o()}),setTimeout(function(){u(!1)},750)},[o]);return(0,w.useEffect)(function(){return n$.F7.on("keydown","FILMSTRIP",function(e){return!!(0,r4.ZP)("Mod+\\")(e)&&(t?r():f(),!0)})},[t,r,f]),(0,ex.jsx)(o0.Provider,{value:i.current,children:(0,ex.jsx)(C.Wk,{isDark:c,children:(0,ex.jsx)(e1.M,{children:t?(0,ex.jsx)(se,{onClose:r,editor:e,readOnly:!s||!a},"filmstrip"):(0,ex.jsx)(C.kH,{placement:"top-end",label:(0,ex.jsx)(h.cC,{id:"7ShgZt"}),isDisabled:d,shortcut:"Mod+\\",children:(0,ex.jsxs)(st,{initial:{opacity:0},animate:{opacity:1,transition:oY},exit:{opacity:0,transition:oK},zIndex:11,css:{"--trigger-height":"var(--chakra-sizes-14)"},tabIndex:-1,position:"fixed",left:2,top:"calc(50% - (var(--trigger-height) / 2) + var(--chakra-sizes-5))",borderRadius:"xl","data-guider-highlight":"filmstrip",h:"var(--trigger-height)",w:8,onClick:f,children:[(0,ex.jsx)(oq.TX,{children:(0,ex.jsx)(h.cC,{id:"7ShgZt"})}),d?(0,ex.jsx)(m.k,{children:(0,ex.jsx)(tW.$,{size:"sm"})}):(0,ex.jsx)(b.G,{icon:oH.Cj})]},"filmstrip-opener")})})})})});sr.displayName="Filmstrip";var so=t(3974),si=t(1472),ss=t(93319),sa=t(91128),sc=t(97873),sl=t(42879),sd=function(e){var n,t=e.doc,r=(0,w.useState)(!1),o=r[0],i=r[1],s=null==t?void 0:t.id,a=null==t?void 0:null===(n=t.organization)||void 0===n?void 0:n.id,c=(0,nK.py)("manage",t),l=(0,S.bBo)({variables:{workspaceId:a},skip:!a||!c}).data,d=(0,sl.uK)({doc:t,sites:null==l?void 0:l.sites}),u=(0,sl.D5)({site:d,docId:s}),f=(0,sc.q)({doc:t,site:d,path:u}).publishDoc,p=(0,w.useCallback)((0,tf.Z)(th().mark(function e(){return th().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.next=3,f();case 3:i(!1);case 4:case"end":return e.stop()}},e)})),[f]);return d?(0,ex.jsx)(eh.z,{size:"sm",variant:"solid",fontWeight:"400",leftIcon:(0,ex.jsx)(b.G,{icon:sa.A$}),onClick:p,isLoading:o,children:(0,ex.jsx)(h.cC,{id:"EEYbdt"})}):null},su=t(92743),sf=t(7099),sp=t(20010),sh=t(48273),sx=t(20412),sm=t(60577),sv=t(81927),sg=t(72360),sj=t(66724),sb=t(18751),sC=t(8388),sy=t(49922),sO=t(82483),sw="gray.700",sk=t(48322),sS=["error","refetch"];function sI(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function sP(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?sI(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):sI(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var sE=function(e){var n=e.error,t=e.refetch,r=(0,eR.Z)(e,sS);return(0,ex.jsx)(g.xu,sP(sP({px:6,py:4},r),{},{children:(0,ex.jsxs)(sg.b,{p:6,status:"error",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",children:[(0,ex.jsx)(sk.z,{mr:0,boxSize:"30px",alignSelf:"center"}),(0,ex.jsx)(sj.C,{mt:4,mb:2,fontSize:"md",children:(0,ex.jsx)(h.cC,{id:"uNQm3r"})}),(0,ex.jsx)(sb.X,{maxWidth:"md",children:n.message}),(0,ex.jsx)(eh.z,{mt:4,onClick:function(){return t()},children:(0,ex.jsx)(h.cC,{id:"6gRgw8"})})]})}))},sD=t(19664),sA=t(97269),sT=t(92619),s_=t(85982),sR=function(){return x.ag._({id:"QbrUIo"})},sL=function(){return x.ag._({id:"FbBkvL"})},sz=function(e){var n=e.isAnalyticsLoading,t=e.hasError,r=e.view,o=e.setView,i=e.description;return t?(0,ex.jsx)(sT.x,{children:(0,ex.jsx)(h.cC,{id:"ZlwDi6"})}):(0,ex.jsxs)(m.k,{direction:"column",flex:1,children:[(0,ex.jsx)(sT.x,{children:n?(0,ex.jsx)(sM,{}):(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(h.cC,{id:"ZlwDi6"}),(0,ex.jsxs)(nJ.g,{align:"stretch",spacing:4,children:[(0,ex.jsx)(v.x,{color:"gray.500",fontSize:"sm",fontWeight:"normal",letterSpacing:"normal",children:i}),(0,ex.jsxs)(s_.E,{children:[(0,ex.jsx)(s_.U,{children:(0,ex.jsx)(eh.z,{leftIcon:(0,ex.jsx)(b.G,{icon:sA.M,"aria-label":sR()}),variant:"ghost",fontWeight:"600",bg:"deckView"===r?"trueblue.50":"transparent",color:"deckView"===r?"trueblue.500":sw,onClick:function(){return o("deckView")},children:sR()})}),(0,ex.jsx)(s_.U,{children:(0,ex.jsx)(eh.z,{leftIcon:(0,ex.jsx)(b.G,{icon:sD.AG,"aria-label":sL()}),variant:"ghost",fontWeight:"600",bg:"cardEngagement"===r?"trueblue.50":"transparent",color:"cardEngagement"===r?"trueblue.500":sw,onClick:function(){return o("cardEngagement")},children:sL()})})]})]})]})}),(0,ex.jsx)(tg.o,{})]})},sM=function(){return(0,ex.jsxs)(nJ.g,{align:"stretch",spacing:4,children:[(0,ex.jsx)(sv.O,{h:12,width:"30%"}),(0,ex.jsx)(sv.O,{h:4,width:"80%"})]})},sG=t(74373),sN=t(68871),sZ=t(98621),sF=t.n(sZ),sW=function(e){var n=e.degree,t=e.alpha,r=e.startColor,o=void 0===r?"#ECC94B":r,i=e.endColor,s=void 0===i?"#38A169":i;if(Number.isNaN(n))return sF()("#e5e0df").toHex8String();var a=sF()(o).toHsl(),c=sF()(s).toHsl();return sF()({h:(0,oD.t7)(a.h,c.h,n),s:(0,oD.t7)(a.s,c.s,n),l:(0,oD.t7)(a.l,c.l,n),a:void 0===t?1:t}).toHex8String()},sU=function(e,n){return e.reduce(function(e,t){return e[t.cardId]=t[n],e},{})},sV=function e(n,t){var r,o=0;for(var i in n)o+=(null!==(r=t[i])&&void 0!==r?r:0)+e(n[i],t);return o},sB=function(e,n){var t,r=0;for(var o in e)r=Math.max((null!==(t=n[o])&&void 0!==t?t:0)+sV(e[o],n),r);return r},sH=t(56623),sq=t(51068),sK=t(67784),sY=t(34717),sQ=t(43227),sX=t(23769),sJ=t(13813),s$=t(16844),s0=t(62349),s1=t.n(s0);function s2(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function s5(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s2(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s2(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var s3=function(e){var n=e.cardsViewed,t=e.totalCards,r=sW({degree:n/t}),o=t>0;return(0,ex.jsxs)(ec.U,{spacing:3,children:[(0,ex.jsxs)(m.k,{flex:1,position:"relative",children:[(0,ex.jsx)(s$.E,{h:4,flex:1,borderRadius:"sm",value:n,max:o?t:void 0,bg:"gray.200",sx:{"> div":{bg:r}}}),o&&n===t&&(0,ex.jsx)(s6,{top:0,right:0,transform:"translate(50%,-50%)",position:"absolute"})]}),(0,ex.jsx)(v.x,{w:{base:10,lg:12},fontSize:"sm",whiteSpace:"nowrap",textAlign:"left",children:o?"".concat(n,"/").concat(t):(0,ex.jsx)(h.cC,{id:"8Va3Pt"})})]})},s4=function(e){var n=e.cardCount,t=(0,w.useMemo)(function(){return s1()(1,n)},[n]);return(0,ex.jsxs)(ec.U,{spacing:3,filter:"blur(3px)",children:[(0,ex.jsx)(m.k,{flex:1,position:"relative",children:(0,ex.jsx)(s$.E,{h:4,flex:1,borderRadius:"sm",value:t,max:n,bg:"gray.300",sx:{"> div":{bg:"gray.300"}}})}),(0,ex.jsxs)(v.x,{w:{base:10,lg:12},fontSize:"sm",whiteSpace:"nowrap",textAlign:"left",color:"gray.600",children:[t,"/",n]})]})},s6=function(e){var n=(0,sX.Z)({},e);return(0,ex.jsx)(g.Cd,s5(s5({bg:"green.500",size:"18px",border:"2px solid white",color:"white"},n),{},{children:(0,ex.jsx)(b.G,{icon:sJ.LE,"aria-label":x.ag._({id:"y886Ns"}),size:"xs"})}))};function s8(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function s7(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s8(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s8(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var s9=function(e){var n,t=e.cards,r=e.isColorized,o=void 0!==r&&r,i=e.scaleToMax,s=void 0!==i&&i,a=e.includeChildren,c=e.showViewersPercent,l=void 0!==c&&c,d=e.leftLabel,u=e.rightLabel,f=e.tooltipLabel,p=e.cardLookupTable,h=e.onAnalyticsPanelClose,x=(n=a?sB(t,p):Math.max.apply(Math,(0,oG.Z)(Object.values(p))),function(e){return(0,oD.t7)(0,100,e/n)}),m=(0,w.useCallback)(function(e){return x(e)},[x]);return(0,ex.jsxs)(g.xu,{mt:6,mb:4,children:[(0,ex.jsxs)(ec.U,{mb:3,children:[(0,ex.jsx)(ec.U,{children:(0,ex.jsx)(C.NZ,{children:d})}),(0,ex.jsx)(ss.L,{}),(0,ex.jsx)(ec.U,{children:(0,ex.jsx)(C.kH,{placement:"top",label:f,children:(0,ex.jsx)(ec.U,{children:(0,ex.jsx)(C.NZ,{borderBottom:"0.125em dashed",borderBottomColor:"gray.400",children:u})})})})]}),(0,ex.jsx)(g.xu,{width:"100%",children:Object.entries(t).map(function(e){var n,t=(0,A.Z)(e,2),r=t[0],i=t[1];return(0,ex.jsx)(ae,{id:r,childCards:i,percentage:null!==(n=p[r])&&void 0!==n?n:0,calculatePercentageScale:m,isColorized:o,cardLookupTable:p,scaleToMax:s,includeChildren:a,showViewersPercent:l,onAnalyticsPanelClose:h},r)})})]})},ae=function e(n){var t=n.id,r=n.cardLookupTable,o=n.childCards,i=n.percentage,s=n.calculatePercentageScale,a=n.isColorized,c=n.scaleToMax,l=n.includeChildren,d=n.showViewersPercent,u=n.onAnalyticsPanelClose,f=(0,tn.ye)("screenshotsEnabled"),p=(0,w.useState)(!1),x=p[0],j=p[1],y=(0,t_.Ux)({placement:"top",gutter:12,enterDelay:200}),O=y.referenceRef,k=y.popperRef,S=y.isHovering,I=y.getPopperProps,P=y.onMouseOver,E=y.onMouseOut,D=(0,w.useCallback)(function(){j(!x)},[x]),T=(0,w.useCallback)(function(){(0,sQ.D)({cardId:t}),u()},[t,u]),_=(0,n8.c)(t),R=(0,n8.T)({cardId:t}).title,L=Object.values(o).length>0,M=0===i,G=l?i+sV(o,r):i,N=x?G:0,Z=c?s(G):Math.min(100,N),F=x?i:G,W=c?s(F):Math.min(100,F),U={startColor:"#F6AD55",endColor:"#68D391"},V=a?sW(s7({degree:Z/100},U)):"trueblue.50",B=a?sW(s7({degree:W/100},U)):"trueblue.100";return(0,ex.jsxs)(ed.K,{children:[(0,ex.jsxs)(m.k,{direction:"column",onMouseOver:P,onMouseOut:E,children:[(0,ex.jsxs)(m.k,{ref:O,h:8,px:2,bg:"gray.100",borderRadius:"md",position:"relative",overflow:"hidden",alignItems:"center",_focusWithin:{shadow:"outline"},children:[(0,ex.jsxs)(ec.U,{pos:"absolute",zIndex:1,children:[L&&(0,ex.jsx)(z.h,{"aria-label":"expand-card",size:"xs",variant:"ghost",isRound:!0,colorScheme:"blackAlpha",icon:(0,ex.jsx)(b.G,{icon:sK._t}),transform:x?"rotate(90deg)":"",onClick:D,_focus:{shadow:"none"}}),!L&&(0,ex.jsx)(m.k,{w:6,justifyContent:"center",alignItems:"center",children:M?(0,ex.jsx)(C.kH,{label:(0,ex.jsx)(h.cC,{id:"s+PDNe"}),children:(0,ex.jsx)(g.xu,{color:"blackAlpha.500",children:(0,ex.jsx)(b.G,{icon:sq.Aq,size:"sm"})})}):(0,ex.jsx)(g.xu,{color:"blackAlpha.300",fontSize:"xx-small",children:(0,ex.jsx)(b.G,{icon:sH.nZ,size:"sm"})})}),(0,ex.jsx)(v.x,{color:M?"blackAlpha.500":void 0,noOfLines:1,children:R||(0,ex.jsx)(h.cC,{id:"wja8aL"})})]}),(0,ex.jsxs)(g.xu,{position:"absolute",w:"100%",height:"100%",top:0,left:0,pointerEvents:"none",children:[(0,ex.jsx)(g.xu,{position:"absolute",h:"100%",bg:M?"blackAlpha.200":V,w:"".concat(Z,"%")}),(0,ex.jsx)(g.xu,{transitionProperty:"all",transitionDuration:"normal",position:"absolute",h:"100%",bg:M?"blackAlpha.300":B,w:"".concat(W,"%")})]}),a&&100===i&&(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(ss.L,{}),(0,ex.jsx)(s6,{alignSelf:"center",zIndex:1})]})]}),S&&(0,ex.jsx)(C.qh,s7({ref:k,src:f?null==_?void 0:_.previewUrl:sY.Z.src,fallbackSrc:sY.Z.src,shouldShow:S,onClick:T,tooltip:(0,ex.jsx)(h.cC,{id:"3YmIR6"}),label:d?(0,ex.jsx)(h.cC,{id:"wmqtMZ",values:{percentage:i}}):void 0},I()))]}),(0,ex.jsx)(g.xu,{pl:8,children:L&&Object.entries(o).map(function(n){var t,o=(0,A.Z)(n,2),i=o[0],f=o[1];return(0,ex.jsx)(t8.U,{in:x,children:(0,ex.jsx)(e,{id:i,childCards:f,percentage:null!==(t=r[i])&&void 0!==t?t:0,cardLookupTable:r,calculatePercentageScale:s,scaleToMax:c,isColorized:a,includeChildren:l,showViewersPercent:d,onAnalyticsPanelClose:u})},i)})})]})},an=function(){return(0,ex.jsx)(ed.K,{spacing:2,children:(0,ex.jsx)(h.cC,{id:"QXJTby",components:{0:(0,ex.jsx)(v.x,{}),1:(0,ex.jsx)(v.x,{}),2:(0,ex.jsx)(v.x,{})}})})},at=function(e){var n=e.timeInMS;return void 0===n?(0,ex.jsx)(ex.Fragment,{}):(0,ex.jsx)(h.cC,{id:"yXHI9B",values:{timeInSeconds:n/1e3}})},ar=function(e){var n=e.docId,t=e.viewerFilter,r=e.currentViewerFilterCount,o=e.onAnalyticsPanelClose,i=(0,J.qr)().getState(),s=(0,$.X9)(i),a=(0,S.IrH)({variables:{docId:n}}),c=a.data,l=a.error,d=a.loading,u=a.refetch,f=(0,w.useState)("viewTimePercent"),p=f[0],x=f[1],m="viewTimePercent"===p?{chartDescription:(0,ex.jsx)(h.cC,{id:"dpTE1c",values:{viewerCount:r}}),leftLabel:(0,ex.jsx)(h.cC,{id:"ml51m3"}),rightLabel:(0,ex.jsx)(h.cC,{id:"8R7bfR"})}:{chartDescription:(0,ex.jsx)(h.cC,{id:"b2VMTo",values:{viewerCount:r}}),leftLabel:(0,ex.jsx)(h.cC,{id:"kTgCTO"}),rightLabel:(0,ex.jsx)(h.cC,{id:"AKDcmS"})},v=m.chartDescription,j=m.rightLabel,C=m.leftLabel,y="viewersOnly"===t?"viewers":"everyone",O=(0,tn.ye)("cardViewedThreshold"),k=(0,w.useMemo)(function(){var e;return(null==c?void 0:null===(e=c.docCardsStats)||void 0===e?void 0:e[y])||[]},[null==c?void 0:c.docCardsStats,y]),I=(0,w.useMemo)(function(){return sU(k,p)},[k,p]),P=(0,w.useCallback)(function(){return x("viewTimePercent")},[]),E=(0,w.useCallback)(function(){return x("viewersPercent")},[]);return(0,ex.jsxs)(g.xu,{children:[(0,ex.jsxs)(ec.U,{my:4,children:[(0,ex.jsx)(eh.z,{leftIcon:(0,ex.jsx)(b.G,{icon:sN.SZ,"aria-label":"Time spend"}),variant:"ghost",fontWeight:"600",bg:"viewTimePercent"===p?"trueblue.50":"transparent",color:"viewTimePercent"===p?"trueblue.500":sw,onClick:P,children:(0,ex.jsx)(h.cC,{id:"XyvAeS"})}),(0,ex.jsx)(eh.z,{leftIcon:(0,ex.jsx)(b.G,{icon:sG.jG,"aria-label":"Percent viewed"}),variant:"ghost",fontWeight:"600",bg:"viewersPercent"===p?"trueblue.50":"transparent",color:"viewersPercent"===p?"trueblue.500":sw,onClick:E,children:(0,ex.jsx)(h.cC,{id:"vXtpAZ"})})]}),(0,ex.jsx)(ai,{description:v}),l&&(0,ex.jsx)(sE,{error:l,refetch:u}),d&&!l&&(0,ex.jsx)(ao,{}),!d&&!l&&(0,ex.jsx)(s9,{cards:s.tree,cardLookupTable:I,scaleToMax:"viewTimePercent"===p,isColorized:"viewersPercent"===p,includeChildren:"viewTimePercent"===p,showViewersPercent:"viewersPercent"===p,rightLabel:j,leftLabel:C,tooltipLabel:"viewTimePercent"===p?(0,ex.jsx)(an,{}):(0,ex.jsx)(at,{timeInMS:O}),onAnalyticsPanelClose:o})]})},ao=function(e){var n=e.includeDescription;return(0,ex.jsx)(m.k,{direction:"column",mt:6,mb:4,children:(0,ex.jsxs)(nJ.g,{align:"stretch",children:[void 0!==n&&n&&(0,ex.jsx)(sv.O,{h:5,mb:3,w:"70%"}),(0,oG.Z)([,,,,,]).map(function(e,n){return(0,ex.jsx)(sv.O,{h:8},n)})]})})},ai=function(e){var n=e.description;return(0,ex.jsx)(v.x,{color:sw,children:n})},as=t(89364),aa=t(73851),ac=t(36258),al=t(19875),ad=t(77525),au=t(74642),af=t(35319),ap=t(27912),ah=t(12221),ax=t(13061),am=t(65903),av=t.n(am),ag=t(829),aj=t.n(ag),ab=t(81188),aC=["name","profileImg","email","isCreator","isContributor","isAnonymous"];function ay(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function aO(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ay(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ay(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var aw=function(e){var n=e.uniqueViewers,t=e.docCreatedDate,r=(0,tn.ye)("cardViewedThreshold");return(0,ex.jsx)(aa.h,{children:(0,ex.jsxs)(ac.Tr,{children:[(0,ex.jsx)(ak,{label:(0,ex.jsx)(h.cC,{id:"LZHJAq",values:{uniqueViewers:n}}),tooltip:(0,ex.jsx)(h.cC,{id:"aaiIlJ",values:{docCreatedDate:t}}),width:"40%"}),(0,ex.jsx)(ak,{label:(0,ex.jsx)(h.cC,{id:"pRGfP3"}),width:"35%"}),(0,ex.jsx)(ak,{label:(0,ex.jsx)(h.cC,{id:"QfqHuz"}),tooltip:(0,ex.jsx)(at,{timeInMS:r}),width:"25%"})]})})},ak=function(e){var n=e.label,t=e.width,r=e.tooltip,o=(0,ex.jsx)(al.Th,{w:t,children:(0,ex.jsx)(v.x,{display:"inline",borderBottom:r?"0.125em dashed":void 0,borderBottomColor:r?"gray.400":void 0,children:n})});return r?(0,ex.jsx)(C.kH,{placement:"top",label:r,children:o}):o},aS=["Yesterday at 11:02 am","Today at 12:55 pm","Dec 12, 2020, 10:19 pm","Apr 14, 2023, 4:30 pm","Jan 1, 2021, 12:03 am","Dec 7, 1984, 12:03 am","May 14, 2002, 3:56 pm"],aI=function(e){var n=e.viewers,t=e.currentViewerFilterCount,r=e.docCreatedDate,o=e.creatorId,i=e.contributors,s=e.cardCount,a=e.handleTableRowClick,c=e.hasIndividualAnalytics,l=(0,nK.SE)().user,d=c?n:aj()(n,function(e){var n;return[(null===(n=e.user)||void 0===n?void 0:n.id)===(null==l?void 0:l.id)?0:1,-e.lastOpened]}).slice(0,3);return(0,ex.jsx)(ad.x,{children:(0,ex.jsxs)(au.i,{colorScheme:"blackAlpha",children:[(0,ex.jsx)(aw,{uniqueViewers:t,docCreatedDate:r}),(0,ex.jsx)(af.p,{children:d.map(function(e,t){var r=e.user,d=e.lastOpened,u=e.visitorId,f=(null==r?void 0:r.id)===o,p=i.some(function(e){return e.user.id===(null==r?void 0:r.id)}),h=r?r.displayName+(r.id===(null==l?void 0:l.id)?" "+x.ag._({id:"dDUgzP"}):"")||"":x.ag._({id:"VmjbJY"}),m=d?av()((0,ab.P9)(d)):x.ag._({id:"/JO3xr"}),g={name:h,id:(null==r?void 0:r.id)||u||"",email:null==r?void 0:r.email,isCreator:f,isContributor:p,profileImg:null==r?void 0:r.profileImageUrl,lastOpened:m},j=t===n.length-1,b=(null==r?void 0:r.id)===(null==l?void 0:l.id),C=!c&&!b;return(0,ex.jsxs)(ac.Tr,{cursor:"pointer",onClick:function(){return a(g)},_hover:{bg:"blackAlpha.50"},borderBottom:"none",children:[(0,ex.jsx)(ap.Td,{borderBottom:j?"0 none":void 0,children:(0,ex.jsx)(aP,{name:h,email:null==r?void 0:r.email,profileImg:null==r?void 0:r.profileImageUrl,isContributor:p,isCreator:f,isAnonymous:!r})}),(0,ex.jsx)(ap.Td,{borderBottom:j?"0 none":void 0,children:C?(0,ex.jsx)(v.x,{fontSize:"sm",filter:"blur(3px)",color:"gray.600",children:aS[t%aS.length]}):(0,ex.jsx)(v.x,{fontSize:"sm",children:m})}),(0,ex.jsx)(ap.Td,{borderBottom:j?"0 none":void 0,children:C?(0,ex.jsx)(s4,{cardCount:s}):(0,ex.jsx)(s3,{cardsViewed:e.cardsViewed||0,totalCards:s||0})})]},(null==r?void 0:r.id)||u)})})]})})},aP=function(e){var n=e.name,t=e.profileImg,r=e.email,o=e.isCreator,i=void 0!==o&&o,s=e.isContributor,a=e.isAnonymous,c=(0,eR.Z)(e,aC);return(0,ex.jsxs)(ec.U,aO(aO({},c),{},{children:[(0,ex.jsx)(ah.q,{size:"sm",name:n,src:t}),(0,ex.jsxs)(ed.K,{spacing:.5,children:[(0,ex.jsxs)(v.x,{children:[n,void 0!==a&&a&&(0,ex.jsx)(C.Yq,{label:(0,ex.jsx)(h.cC,{id:"VHgG8W",values:{GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc}}),ml:2})]}),(0,ex.jsxs)(ec.U,{mt:1,children:[(0,ex.jsx)(v.x,{fontSize:"sm",color:"gray.500",children:void 0===r?"":r}),(i||void 0!==s&&s)&&(0,ex.jsx)(ax.Vp,{size:"sm",transform:"translate(0, 1.5px)",children:i?(0,ex.jsx)(h.cC,{id:"UE2beD"}):(0,ex.jsx)(h.cC,{id:"3L51iw"})})]})]})]}))},aE=function(e){var n,t,r,o,i=e.user,s=e.onBackClick,a=e.docId,c=e.onAnalyticsPanelClose,l=(0,J.qr)().getState(),d=(0,$.X9)(l),u=(0,S.IrH)({variables:{docId:a,userId:i.id},skip:!a||!i.id,pollInterval:9e5,notifyOnNetworkStatusChange:!0}),f=u.data,p=u.error,x=u.loading,m=u.refetch,v=null!==(n=null==f?void 0:null===(t=f.docCardsStats)||void 0===t?void 0:null===(r=t.everyone)||void 0===r?void 0:r.length)&&void 0!==n?n:0,j=null==f?void 0:null===(o=f.docCardsStats)||void 0===o?void 0:o.cardCount,b=(0,w.useMemo)(function(){var e;return(null==f?void 0:null===(e=f.docCardsStats)||void 0===e?void 0:e.everyone)||[]},[null==f?void 0:f.docCardsStats]),C=(0,w.useMemo)(function(){return sU(b,"viewTimePercent")},[b]);return(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(sT.x,{children:(0,ex.jsx)(eh.z,{"aria-label":"Back",leftIcon:(0,ex.jsx)(as.R,{}),variant:"ghost",onClick:s,children:(0,ex.jsx)(h.cC,{id:"iH8pgl"})})}),(0,ex.jsx)(tg.o,{}),(0,ex.jsx)(ep.i,{}),(0,ex.jsx)(tj.f,{children:(0,ex.jsxs)(g.xu,{children:[(0,ex.jsx)(aD,{user:i,showLastOpened:!0}),j&&(0,ex.jsx)(ai,{description:(0,ex.jsx)(h.cC,{id:"YJOrjl",values:{cardsViewed:v,totalCards:j}})}),x&&!p&&(0,ex.jsx)(ao,{includeDescription:!0}),p&&(0,ex.jsx)(sE,{error:p,refetch:m}),!p&&!x&&(0,ex.jsx)(s9,{cards:d.tree,scaleToMax:!0,includeChildren:!0,leftLabel:(0,ex.jsx)(h.cC,{id:"ml51m3"}),rightLabel:(0,ex.jsx)(h.cC,{id:"8R7bfR"}),cardLookupTable:C,tooltipLabel:(0,ex.jsx)(an,{}),onAnalyticsPanelClose:c})]})})]})},aD=function(e){var n=e.user,t=e.showLastOpened;return(0,ex.jsxs)(ec.U,{align:"center",my:6,children:[(0,ex.jsx)(aP,{name:n.name,profileImg:n.profileImg,email:n.email,isCreator:n.isCreator,isContributor:n.isContributor,width:t?"50%":void 0}),t&&(0,ex.jsxs)(nJ.g,{align:"flex-start",spacing:0,children:[(0,ex.jsx)(C.NZ,{children:(0,ex.jsx)(h.cC,{id:"pRGfP3"})}),(0,ex.jsx)(v.x,{children:n.lastOpened})]})]})},aA=t(87567),aT=t(47299),a_=t(81295),aR=t(26673),aL=function(e,n,t){return"everyone"===e?x.ag._({id:"1IE7uf",values:{everyone:n}}):"viewersOnly"===e?x.ag._({id:"r/tA4Y",values:{viewersOnly:t}}):x.ag._({id:"V9JX7d"})},az={everyone:a_.Nd,viewersOnly:aT.Md,accessLinkOnly:aA.uW},aM=function(e){var n=e.selected,t=e.handleMenuItemChange,r=e.everyoneCount,o=e.viewersOnlyCount;return(0,ex.jsxs)(om.v,{children:[(0,ex.jsx)(ov.j,{leftIcon:(0,ex.jsx)(b.G,{size:"xs",icon:az[n]}),as:eh.z,size:"md",rightIcon:(0,ex.jsx)(b.G,{size:"xs",icon:aR.pt}),children:aL(n,r,o)}),(0,ex.jsx)(og.q,{zIndex:2,maxW:"380px",children:(0,ex.jsxs)(oC._,{defaultValue:n,value:n,onChange:function(e){Array.isArray(e)||t(e)},children:[(0,ex.jsx)(oy.i,{value:"everyone",isDisabled:0===r,children:(0,ex.jsxs)(m.k,{align:"center",children:[(0,ex.jsx)(b.G,{icon:az.everyone,size:"xs"}),(0,ex.jsxs)(g.xu,{ml:3,children:[(0,ex.jsx)(v.x,{children:aL("everyone",r,o)}),(0,ex.jsx)(v.x,{fontSize:"sm",color:"gray.500",children:(0,ex.jsx)(h.cC,{id:"c5ESvc",values:{GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc}})})]})]})}),(0,ex.jsx)(oy.i,{value:"viewersOnly",isDisabled:0===o,children:(0,ex.jsxs)(m.k,{align:"center",children:[(0,ex.jsx)(b.G,{icon:az.viewersOnly,size:"xs"}),(0,ex.jsxs)(g.xu,{ml:3,children:[(0,ex.jsx)(v.x,{children:aL("viewersOnly",r,o)}),(0,ex.jsx)(v.x,{fontSize:"sm",color:"gray.500",children:(0,ex.jsx)(h.cC,{id:"5hKO48",values:{GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc}})})]})]})}),!1]})})]})},aG=t(46102),aN=t(6802),aZ=t(70258),aF=t(80237),aW=t(59309),aU=t(2574),aV=t(92638),aB=t(33951),aH=t(10897),aq=t(14582),aK=t(75715),aY=t(96492),aQ=t(14141),aX=t(40837),aJ=["chartTitle","TooltipInner","showZero","shouldRoundYValues","showMaxAndMiddle","data","barColor","customTooltipStyles","onClick"];function a$(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function a0(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a$(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a$(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var a1={top:55,right:20,bottom:40,left:24},a2=function(e){return Math.round(e).toString()},a5={backgroundColor:"var(--chakra-colors-blackAlpha-800)",color:"var(--chakra-colors-gray-100)",fontFamily:"Inter, sans-serif",boxShadow:"var(--chakra-shadows-4)",fontSize:"var(--chakra-fontSizes-xs)",borderRadius:"var(--chakra-radii-sm)",fontWeight:"var(--chakra-fontWeights-semibold)",borderWidth:"1px",borderColor:"black",paddingRight:"var(--chakra-space-1.5)",paddingLeft:"var(--chakra-space-1.5)",paddingTop:"var(--chakra-space-0.5)",paddingBottom:"var(--chakra-space-0.5)",zIndex:"var(--chakra-zIndex-tooltip)",minWidth:"60px",lineHeight:"var(--chakra-lineHeights-base)"},a3="var(--chakra-colors-gray-500)",a4="var(--chakra-colors-gray-200)",a6=function(e){var n,t=e.width,r=e.height,o=e.margin,i=void 0===o?a1:o,s=e.chartData,a=e.TooltipInner,c=e.showZero,l=e.shouldRoundYValues,d=e.showMaxAndMiddle,u=e.barColor,f=e.customTooltipStyles,p=e.onClick,h=void 0===p?function(){}:p,x=(0,aY.Z)(),m=x.showTooltip,v=x.tooltipOpen,j=x.tooltipLeft,b=x.tooltipTop,C=x.tooltipData,y=x.hideTooltip,O=(0,w.useRef)(),k=(0,w.useRef)();(0,w.useEffect)(function(){return function(){O.current&&clearTimeout(O.current),k.current&&clearTimeout(k.current)}},[]);var S=s.map(function(e){return e.y}),I=Math.max.apply(Math,(0,oG.Z)(S)),P=[I,Math.round(I/2)],E=(n=d?P:S,Math.max.apply(Math,(0,oG.Z)(n.map(function(e){return(0,aK.Z)(e.toString(),{fontFamily:"Inter, sans-serif",fontSize:"var(--chakra-fontSizes-sm)",fontWeight:"600"})||0})))),D=i.left+E,A=t-D-i.right,T=r-i.top-i.bottom,_=a0(a0(a0({},aQ.j),a5),f),R=(0,w.useMemo)(function(){return(0,aV.Z)({range:[0,A],domain:s.map(function(e){return e.x}),padding:.3})},[A,s]),L=(0,w.useMemo)(function(){return(0,aB.Z)({range:[T,0],round:!0,domain:[0,I]})},[T,I]),z=c?L(Math.min.apply(Math,(0,oG.Z)(S.filter(function(e){return 0!==e})))):T,M=c&&T-z>6;return(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(g.xu,{children:(0,ex.jsxs)("svg",{width:t,height:r,children:[(0,ex.jsx)("rect",{x:0,y:0,rx:4,width:t,height:r,fill:"var(--chakra-colors-gray-100)"}),(0,ex.jsx)(aW.Z,{top:i.top,left:D,children:s.map(function(e){var n,t,r=e.y,o=e.x,i="bar-".concat(o,"-").concat(r),s=R.bandwidth(),a=T-(null!==(n=L(r))&&void 0!==n?n:0),l=M&&0===a?6:a,d=null!==(t=R(o))&&void 0!==t?t:0,f=T-l;return(0,ex.jsxs)(aW.Z,{children:[(0,ex.jsx)(aH.Z,{x:d,y:f,width:s,height:l,radius:5,topLeft:!0,topRight:!0,fill:c&&0===r?a4:u,onMouseLeave:function(){O.current=window.setTimeout(function(){y()},300)},onMouseMove:function(n){O.current&&clearTimeout(O.current);var t=(0,aF.Z)(n);m({tooltipData:e,tooltipTop:null==t?void 0:t.y,tooltipLeft:null==t?void 0:t.x})},onClick:function(n){return h(n,e)}}),(0,ex.jsx)(aq.Z,{x:d,y:0,width:s,height:Math.max(0,T-l),opacity:0,onMouseLeave:function(){k.current=window.setTimeout(function(){y()},300)},onMouseMove:function(n){k.current&&clearTimeout(k.current);var t=(0,aF.Z)(n);m({tooltipData:e,tooltipTop:null==t?void 0:t.y,tooltipLeft:null==t?void 0:t.x})}})]},i)})}),(0,ex.jsx)(aN.Z,{top:i.top,left:D,scale:L,stroke:a4,strokeWidth:2,tickValues:d?P:void 0,numTicks:d?void 0:2,hideZero:!0,tickFormat:l?a2:void 0,tickLength:6,tickStroke:a4,tickLabelProps:function(){return{fill:a3,textAnchor:"end",fontFamily:"Inter, sans-serif",fontSize:"var(--chakra-fontSizes-sm)",fontWeight:"600",dy:"0.33em",dx:-4}}}),(0,ex.jsx)(aZ.Z,{top:T+i.top,left:D,scale:R,stroke:a4,numTicks:4,tickStroke:a4,tickLabelProps:function(){return{fill:a3,textAnchor:"middle",fontFamily:"Inter, sans-serif",fontSize:"var(--chakra-fontSizes-sm)",fontWeight:"600",dy:4}},strokeWidth:2,tickLength:6})]})}),v&&C&&(0,ex.jsx)(aX.Z,{top:b,left:j,style:_,children:(0,ex.jsx)(a,{x:C.x,y:C.y})})]})},a8=function(e){var n=e.chartTitle,t=e.TooltipInner,r=e.showZero,o=void 0===r||r,i=e.shouldRoundYValues,s=void 0===i||i,a=e.showMaxAndMiddle,c=void 0===a||a,l=e.data,d=e.barColor,u=void 0===d?"var(--chakra-colors-trueblue-200)":d,f=e.customTooltipStyles,p=e.onClick,h=void 0===p?function(){}:p,x=(0,eR.Z)(e,aJ);return(0,ex.jsxs)(g.xu,a0(a0({position:"relative",height:"300px"},x),{},{children:[(0,ex.jsx)(v.x,{size:"xs",color:"gray.500",fontWeight:"600",position:"absolute",top:3,left:"50%",transform:"translateX(-50%)",children:n}),(0,ex.jsx)(aU.Z,{children:function(e){var n=e.width,r=e.height;return n<10?null:(0,ex.jsx)(a6,{width:n,height:r,showZero:o,chartData:l,barColor:u,customTooltipStyles:f,onClick:h,TooltipInner:t,shouldRoundYValues:s,showMaxAndMiddle:c})}})]}))},a7=function(e,n){var t="LLL d",r=new Date;r.setDate(r.getDate()-n+1);for(var o=[],i=0;i<n;i++)!function(n){var i=new Date(r);i.setDate(i.getDate()+n);var s=(0,aG.Z)(i,{representation:"date"}),a=e.find(function(e){return e.date===s});a?o.push({x:(0,sC.p6)(a.date,t),y:a.uniqueVisitors?a.uniqueVisitors:0}):o.push({x:(0,sC.p6)(s,t),y:0})}(i);return o},a9=function(e){var n=a7(e.viewData,e.dayCount);return(0,ex.jsx)(a8,{data:n,my:3,chartTitle:(0,ex.jsx)(h.cC,{id:"mSEibf"}),TooltipInner:ce})},ce=function(e){var n=e.x,t=e.y;return(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(v.x,{children:n}),(0,ex.jsx)(v.x,{children:(0,ex.jsx)(h.cC,{id:"6MKtHx",values:{y:t}})})]})},cn=function(e,n,t){if(!t)return 0;var r,o,i,s=null!==(r=t.uniqueViewers)&&void 0!==r?r:0,a=null!==(o=null===(i=e.editors)||void 0===i?void 0:i.length)&&void 0!==o?o:0;return"everyone"===n?s:"viewersOnly"===n?Math.max(0,s-a):0},ct=function(e){var n,t,r,o=e.doc,i=e.handleSharePanelOpen,s=e.onAnalyticsPanelClose,a=e.canShare,c=(0,S.xls)({variables:{memoId:o.id},skip:!o.id,pollInterval:9e5,notifyOnNetworkStatusChange:!0}),l=c.loading,d=c.data,u=c.error,f=c.refetch,p=(0,nK.SE)().user,v=(0,w.useState)("deckView"),g=v[0],j=v[1],b=(0,w.useState)(null),C=b[0],y=b[1],O=(0,w.useState)("everyone"),k=O[0],I=O[1],P=(0,sC.p6)(o.createdTime,"PPP"),E=o.title||(0,ex.jsx)(h.cC,{id:"wja8aL"}),D=(null==d?void 0:d.memoStats.viewers)||[],A=(null==d?void 0:null===(t=d.memoStats.dailyViews)||void 0===t?void 0:t.dayCount)||0,T=(n=null==d?void 0:d.memoStats)&&n.dailyViews?"everyone"===k?n.dailyViews.everyone?n.dailyViews.everyone:[]:"viewersOnly"===k&&n.dailyViews.viewers?n.dailyViews.viewers:[]:[],_=(0,ey.Y)("individual_analytics",o.organization),R=(0,sO.zc)().openUpsellModal,L=T.every(function(e){return 0===e.uniqueVisitors}),z=D.filter(function(e){var n;return"everyone"===k||!(null!==(n=o.editors)&&void 0!==n&&n.some(function(n){var t,r;return(null===(t=e.user)||void 0===t?void 0:t.id)===(null===(r=n.user)||void 0===r?void 0:r.id)}))}),M=cn(o,k,null==d?void 0:d.memoStats),G=(0,w.useCallback)(function(e){I(e)},[]),N=(0,w.useCallback)(function(e){j(e)},[]),Z=(0,w.useCallback)(function(e){if(!_&&e.id!==(null==p?void 0:p.id)){R({segmentEvent:n_.AA.GAMMA_PRO_UPSELL_SUBSCRIPTION_INDIVIDUAL_ANALYTICS});return}y(e)},[R,_,p]),F=(0,w.useCallback)(function(){y(null)},[]),W=void 0!==u;return(0,ex.jsxs)(ex.Fragment,{children:[C&&(0,ex.jsx)(aE,{user:C,onBackClick:F,docId:o.id,onAnalyticsPanelClose:s}),!C&&(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(sz,{hasError:W,isAnalyticsLoading:l,setView:N,view:g,description:(0,ex.jsx)(h.cC,{id:"uEtUah",values:{docTitle:E,docCreatedDate:P}})}),W&&(0,ex.jsx)(sE,{error:u,refetch:f}),!W&&(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(ep.i,{}),(0,ex.jsxs)(tj.f,{children:[l&&(0,ex.jsx)(cr,{}),!l&&D.length<=1&&a&&(0,ex.jsx)(co,{handleSharePanelOpen:i}),!l&&(0,ex.jsxs)(ed.K,{direction:"column",mt:4,spacing:4,children:[(0,ex.jsxs)(m.k,{direction:"row",justify:"space-between",align:"center",children:[(0,ex.jsx)(eu.X,{as:"h2",size:"md",children:"cardEngagement"===g?sL():sR()}),(0,ex.jsx)(aM,{selected:k,handleMenuItemChange:G,everyoneCount:cn(o,"everyone",null==d?void 0:d.memoStats),viewersOnlyCount:cn(o,"viewersOnly",null==d?void 0:d.memoStats)})]}),"deckView"===g&&L&&(0,ex.jsx)(ci,{handleSharePanelOpen:i,dayCount:A}),"deckView"===g&&!L&&(0,ex.jsx)(a9,{viewData:T,dayCount:A}),"cardEngagement"===g&&(0,ex.jsx)(ar,{docId:o.id,viewerFilter:k,currentViewerFilterCount:M,onAnalyticsPanelClose:s}),(0,ex.jsx)(aI,{creatorId:(null===(r=o.createdBy)||void 0===r?void 0:r.id)||"",viewers:z,currentViewerFilterCount:M,docCreatedDate:P,contributors:o.editors||[],cardCount:(null==d?void 0:d.memoStats.cardCount)||0,handleTableRowClick:Z,hasIndividualAnalytics:_}),z.length>3&&!_&&(0,ex.jsx)(eh.z,{variant:"ghost",size:"sm",color:"gray.600",colorScheme:"gray",onClick:function(){return R({segmentEvent:n_.AA.GAMMA_PRO_UPSELL_SUBSCRIPTION_INDIVIDUAL_ANALYTICS})},children:(0,ex.jsx)(h.cC,{id:"BKBX4n",values:{0:z.length-3}})}),!_&&(0,ex.jsx)(sy.m,{segmentEvent:n_.AA.GAMMA_PRO_UPSELL_SUBSCRIPTION_INDIVIDUAL_ANALYTICS,description:x.ag._({id:"GYgPBy"})})]})]})]})]})]})},cr=function(){return(0,ex.jsxs)(m.k,{direction:"column",py:2,children:[(0,ex.jsx)(sv.O,{h:10,width:"40%",mb:4}),(0,ex.jsx)(sv.O,{h:40,mb:4}),(0,ex.jsx)(nJ.g,{align:"stretch",children:(0,oG.Z)([,,,]).map(function(e,n){return(0,ex.jsx)(sv.O,{h:12},n)})})]})},co=function(e){var n=e.handleSharePanelOpen;return(0,ex.jsx)(m.k,{p:3,px:4,mt:2,bg:"gray.100",color:sw,borderRadius:"base",children:(0,ex.jsxs)(m.k,{align:"baseline",fontSize:"sm",children:[(0,ex.jsx)(g.xu,{pr:2,children:(0,ex.jsx)(b.G,{icon:sm.IL,"aria-label":"user-icon",size:"sm"})}),(0,ex.jsx)(v.x,{children:(0,ex.jsx)(h.cC,{id:"FNMh4I",components:{0:(0,ex.jsx)(v.x,{as:"button",onClick:n,textDecoration:"underline",fontWeight:"600",color:"gray.800"})}})})]})})},ci=function(e){var n=e.handleSharePanelOpen,t=e.dayCount;return(0,ex.jsxs)(sg.b,{my:4,p:6,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",colorScheme:"gray",children:[(0,ex.jsx)(g.Cd,{size:"30px",bg:"gray.500",children:(0,ex.jsx)(b.G,{icon:sx.Im,color:"white"})}),(0,ex.jsx)(sj.C,{mt:4,mb:2,fontSize:"md",children:(0,ex.jsx)(h.cC,{id:"2OzAI5"})}),t>0&&(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(sb.X,{maxWidth:"sm",children:(0,ex.jsx)(h.cC,{id:"qQLmo7",values:{dayCount:t}})}),(0,ex.jsx)(eh.z,{mt:4,onClick:n,children:(0,ex.jsx)(h.cC,{id:"IXzWG0"})})]})]})},cs=function(e){var n,t,r,o,i,s,a=e.doc,c=e.onAnalyticsPanelClose,l=(0,J.qr)().getState(),d=(0,$.X9)(l),u=(0,nK.SE)().user,f=(0,S.IrH)({variables:{docId:a.id,userId:null==u?void 0:u.id},skip:!(null!=u&&u.id),pollInterval:9e5,notifyOnNetworkStatusChange:!0}),p=f.data,x=f.error,m=f.loading,j=f.refetch,b=null!==(n=null==p?void 0:null===(t=p.docCardsStats)||void 0===t?void 0:null===(r=t.everyone)||void 0===r?void 0:r.length)&&void 0!==n?n:0,C=null==p?void 0:null===(o=p.docCardsStats)||void 0===o?void 0:o.cardCount,y=(0,w.useMemo)(function(){var e;return(null==p?void 0:null===(e=p.docCardsStats)||void 0===e?void 0:e.everyone)||[]},[null==p?void 0:p.docCardsStats]),O=(0,w.useMemo)(function(){return sU(y,"viewTimePercent")},[y]);if(!u)return null;var k=u.id===(null===(i=a.createdBy)||void 0===i?void 0:i.id),I=null===(s=a.editors)||void 0===s?void 0:s.some(function(e){return e.user.id===u.id}),P={name:u.displayName,id:u.id,profileImg:u.profileImageUrl,email:u.email,isContributor:I,isCreator:k};return(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsxs)(sT.x,{children:[(0,ex.jsx)(h.cC,{id:"ZlwDi6"}),(0,ex.jsx)(v.x,{fontSize:"sm",fontWeight:"normal",letterSpacing:"normal",color:"gray.500",noOfLines:1,children:a.title||(0,ex.jsx)(h.cC,{id:"wja8aL"})})]}),(0,ex.jsx)(tg.o,{}),(0,ex.jsx)(ep.i,{}),(0,ex.jsx)(tj.f,{children:(0,ex.jsxs)(g.xu,{children:[(0,ex.jsx)(aD,{user:P}),void 0!==C&&(0,ex.jsx)(ai,{description:(0,ex.jsx)(h.cC,{id:"YJOrjl",values:{cardsViewed:b,totalCards:C}})}),m&&!x&&(0,ex.jsx)(ao,{includeDescription:!0}),x&&(0,ex.jsx)(sE,{error:x,refetch:j,px:0}),!x&&!m&&(0,ex.jsx)(s9,{cards:d.tree,scaleToMax:!0,includeChildren:!0,leftLabel:(0,ex.jsx)(h.cC,{id:"ml51m3"}),rightLabel:(0,ex.jsx)(h.cC,{id:"8R7bfR"}),cardLookupTable:O,tooltipLabel:(0,ex.jsx)(an,{}),onAnalyticsPanelClose:c}),(0,ex.jsxs)(sg.b,{children:[(0,ex.jsx)(sk.z,{}),(0,ex.jsx)(h.cC,{id:"Znuvj3",values:{GAMMA_PROPER_NOUN:eC.N6,GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc}})]})]})})]})},ca=function(e){var n=e.doc,t=e.mode,r=e.isAnalyticsPanelOpen,o=e.onAnalyticsPanelClose,i=e.onSharePanelOpen,s=(0,iG.i)({base:"sm",md:"2xl",lg:"4xl"}),a=!!i&&"full"==t,c=(0,w.useCallback)(function(){i&&(i(),o())},[i,o]);return(0,ex.jsx)(C.Wk,{isDark:!1,children:(0,ex.jsxs)(sp.u_,{onClose:o,isOpen:r,size:s,blockScrollOnMount:!1,children:[(0,ex.jsx)(tm.Z,{}),(0,ex.jsxs)(sh.h,{mx:2,minW:0,children:["full"===t?(0,ex.jsx)(ct,{doc:n,handleSharePanelOpen:c,onAnalyticsPanelClose:o,canShare:a}):(0,ex.jsx)(cs,{doc:n,onAnalyticsPanelClose:o}),(0,ex.jsx)(ep.i,{my:4}),(0,ex.jsx)(tb.m,{children:(0,ex.jsxs)(m.k,{justifyContent:a?"space-between":"flex-end",flex:1,children:[a&&(0,ex.jsx)(eh.z,{leftIcon:(0,ex.jsx)(b.G,{icon:sf.zB}),variant:"ghost",onClick:c,children:(0,ex.jsx)(h.cC,{id:"IXzWG0"})}),(0,ex.jsx)(eh.z,{variant:"solid",onClick:o,children:(0,ex.jsx)(h.cC,{id:"DPfwMq"})})]})})]})]})})},cc=t(6985),cl=t(25298),cd=t(27777),cu=t(67453),cf=function(e){var n=e.isOpen,t=e.onClose,r=e.onSaveSuccess,o=e.docId,i=(0,eV.p)(),s=(0,w.useRef)(null),a=(0,w.useState)(""),c=a[0],l=a[1],d=(0,S.D1_)(),u=(0,A.Z)(d,2),f=u[0],p=u[1].loading,x=function(){f({variables:{id:o,title:c}}).then(function(){l(function(){return""}),r()}).catch(function(e){console.error(e),i({title:(0,ex.jsx)(ex.Fragment,{children:(0,ex.jsx)(h.cC,{id:"AToAqe",values:{0:e.message}})}),position:"top",status:"error"})})};return(0,ex.jsxs)(sp.u_,{returnFocusOnClose:!1,onClose:t,closeOnOverlayClick:!0,isOpen:n,initialFocusRef:s,children:[(0,ex.jsx)(tm.Z,{}),(0,ex.jsxs)(sh.h,{children:[(0,ex.jsx)(sT.x,{children:(0,ex.jsx)(h.cC,{id:"kq/0Sg",values:{GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc}})}),(0,ex.jsx)(tg.o,{}),(0,ex.jsx)(tj.f,{children:(0,ex.jsx)(cd.I,{ref:s,value:c,required:!0,placeholder:(0,cu.$)(),onChange:function(e){return l(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&x()}})}),(0,ex.jsx)(tb.m,{children:(0,ex.jsx)(ed.K,{spacing:2,direction:"row",align:"center",children:(0,ex.jsx)(eh.z,{isLoading:p,isDisabled:p||!c||!c.length,onClick:function(){x()},children:(0,ex.jsx)(h.cC,{id:"tfDRzk"})})})})]})]})},cp=(0,w.memo)(function(e){var n=e.doc,t=(0,w.useCallback)(function(){return cc.T.emit("openSharePanel",{view:"invite"})},[]),r=(0,tX.M)({id:"analyticsModalDisclosure"}),o=r.isOpen,i=r.onClose,s=r.onOpen,a=(0,tX.M)({id:"titleModalDisclosure"}),c=a.isOpen,l=a.onOpen,d=a.onClose,u=(0,n_.z$)(),f=(0,nK.SE)().user,p=(0,nK.py)("manage",n)&&!!f,v=(0,w.useCallback)(function(){n&&(n.title&&""!==n.title?t():l())},[n,t,l]),g=(0,w.useCallback)(function(e){return function(){null==u||u.track(n_.AA.DOC_ANALYTICS_VIEWED,{docId:null==n?void 0:n.id,source:e,type:"full"}),s()}},[u,null==n?void 0:n.id,s]);return p&&n?(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(m.k,{children:(0,ex.jsx)(C.kH,{closeOnMouseDown:!1,closeOnClick:!1,label:(0,ex.jsx)(h.cC,{id:"YaUqUV"}),children:(0,ex.jsx)(cl.r,{"data-guider-highlight":"view-analytics-button","aria-label":x.ag._({id:"YaUqUV"}),onMouseDown:nd.br,onClick:g("toolbar_analytics_block"),icon:(0,ex.jsx)(b.G,{icon:su.M})})})}),c&&(0,ex.jsx)(cf,{onClose:d,isOpen:c,onSaveSuccess:function(){d(),t()},docId:null==n?void 0:n.id}),o&&(0,ex.jsx)(ca,{doc:n,onSharePanelOpen:v,onAnalyticsPanelClose:i,isAnalyticsPanelOpen:o,mode:"full"})]}):null}),ch=t(24657),cx=t(94370),cm=t(67755),cv=t(67925),cg=t(73716),cj=t(10920),cb=t(15756),cC=t(81410),cy=t(5632),cO=t(57973);function cw(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function ck(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?cw(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):cw(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var cS=(0,e0.E)(m.k),cI=function(e){var n=e.doc;return(0,ex.jsx)(cS,{initial:{opacity:1},animate:{opacity:1},exit:{opacity:0},children:(0,ex.jsx)(e1.M,{initial:!1,children:(0,ex.jsx)(cT,{doc:n})})})},cP=(0,w.memo)(function(e){var n=e.doc,t=(0,td._i)().editor,r=(0,S.$gs)().isConnected,o=(0,eV.p)(),i=(0,w.useRef)(null),s=(0,w.useRef)(null),a=(0,S.D1_)(),c=(0,A.Z)(a,2),l=c[0],d=c[1].loading,u=(0,w.useState)(null),f=u[0],p=u[1],m=(0,w.useState)(!1),v=m[0],j=m[1],b=(0,w.useState)(!1),y=b[0],O=b[1],k=(0,nK.py)("edit",n),I=(0,w.useCallback)(function(){if(!t)return"";var e=(0,nN.N2)(t.state.doc,nF.KH),n=(0,A.Z)(e,1)[0];return n&&(0,eY.getCardTitle)(n.node.toJSON())||""},[t]);(0,w.useEffect)(function(){!n||v||d||(p(n.title||""),O(!!n.titleEdited))},[n,v,d]);var P=function(){i.current.style.width=s.current.offsetWidth+0+"px"},E=(0,eq.ff)("gray.800","gray.200");return(0,ex.jsx)(C.kH,{label:k?r?(0,ex.jsx)(h.cC,{id:"2wxgft"}):(0,ex.jsx)(h.cC,{id:"Cb+Bgk"}):null,"aria-label":x.ag._({id:"2wxgft"}),children:(0,ex.jsxs)(cm.C,{value:f||"",placeholder:f||I(),isDisabled:d||!k||!r,isPreviewFocusable:k,maxW:300,width:"100%",fontWeight:"normal",onCancel:function(){P(),j(!1)},onFocus:function(){P(),n&&!d&&j(!0)},onChange:function(e){P(),v&&(p(e),O(!!e))},onSubmit:function(){if(n&&!d){j(!1);var e=f||I();l({variables:{id:n.id,title:e,titleEdited:y}}).catch(function(e){console.error(e),o({title:(0,ex.jsx)(h.cC,{id:"AToAqe",values:{0:e.message}}),position:"top",status:"error"})})}},children:[(0,ex.jsx)(cv.w,{px:1,py:.5,display:v?"inline":"block",overflowX:"hidden",textOverflow:"ellipsis",color:y?E:"inherit"}),(0,ex.jsx)(cg.V,{ref:i,px:1,py:.5,color:y?E:"inherit",maxW:300,_focus:{outline:"none",shadow:"0 0 0 2px rgb(66 153 225 / 60%)"}}),(0,ex.jsx)(g.xu,{ref:s,as:"span",display:"inline-block",position:"absolute",left:"-9999px",opacity:0,zIndex:-1,minW:"180px",px:1,dangerouslySetInnerHTML:{__html:rx().sanitize((f||"").replace(/\s/g,"&nbsp;"))}})]})})});cP.displayName="EditableDocTitle";var cE=function(e){var n=e.cardId,t=e.isEllipsis,r=e.value,o=e.onClick,i=(0,n8.c)(n);if(t)return(0,ex.jsx)(b.G,{icon:cx.cN});if(!n&&!r)return null;var s=r||(null==i?void 0:i.title)||"";return(0,ex.jsx)(v.x,{noOfLines:1,onClick:o,maxW:180,fontWeight:"normal",children:s})},cD=function(e){var n=e.isPresentModeFlat;return function(e){var t=(0,$.gh)(e),r=(0,$.i2)(e)||"",o=(0,$.X9)(e).parents[r]||[];if("DOC_VIEW"===t||n)return[{isHome:!0},{isDocTitle:!0}];var i=o[0],s=o[o.length-1];return[{isHome:!0},o.length>1?{cardId:i}:null,o.length>2?{isEllipsis:!0}:null,o.length>0?{cardId:s}:null,{cardId:r}]}},cA=function(){var e=(0,tn.ye)("presentModeFlat");return(0,J.CG)(cD({isPresentModeFlat:e}),function(e,n){return JSON.stringify(e)===JSON.stringify(n)})},cT=(0,w.memo)(function(e){var n=e.doc,t=cA(),r=(0,cO.X)(en.H.lastHomeUrl,"/"),o=(0,A.Z)(r,1)[0],i=(0,tn.ye)("offline"),s=(0,nK.SE)().user,a=(0,S.$gs)().isConnected,c=(0,td._i)().confirmNavigation,l=(0,cy.useRouter)().push,d=(0,iG.i)({base:"xs",sm:"sm"}),u=(0,eq.ff)("gray.500","gray.400"),f=(0,eq.ff)("gray.800","gray.100");return(0,ex.jsxs)(ec.U,{spacing:0,as:eh.z,textAlign:"left",px:0,_hover:{color:f},h:8,children:[(0,ex.jsx)(cj.a,{display:"flex",alignItems:"center",whiteSpace:"nowrap",size:d,spacing:["4px","8px"],variant:"plainButton",separator:(0,ex.jsx)(g.xu,{color:"gray.300",mt:["0.2rem","0.125rem"],children:(0,ex.jsx)(b.G,{icon:sK._t})}),children:t.map(function(e,r){if(!e)return null;var i=r===t.length-1,a=e.cardId,d=e.isEllipsis,f=e.isDocTitle,p=e.isHome,h=e.value,x=p?"home":d?"ellipsis":a||h||r;if(p&&!s)return null;var m={as:re(),href:o||"/",colorScheme:"gray",fontWeight:"normal","data-testid":"toolbar-home-link"};return(0,ex.jsx)(cb.g,{children:(0,ex.jsx)(cS,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},children:(0,ex.jsx)(cC.A,ck(ck({isCurrentPage:i,pointerEvents:i&&!f?"none":"inherit",color:i?u:"inherit"},p?ck({},m):{}),{},{children:f?(0,ex.jsx)(cP,{doc:n}):p?(0,ex.jsx)(eB.r,{href:m.href,onClick:function(e){e.preventDefault(),c().then(function(){l(m.href)})},mr:1,children:(0,ex.jsx)(b.G,{size:"1x",icon:ch.J9})}):(0,ex.jsx)(cE,{cardId:a,value:h,isEllipsis:d,onClick:function(){a&&(0,sQ.D)({cardId:a,method:"push"})}})}))},x)},x)})}),!a&&(0,ex.jsx)(C.kH,{label:(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(v.x,{mr:2,children:(0,ex.jsx)(h.cC,{id:"ysdDIA"})}),i&&(0,ex.jsx)(v.x,{color:"gray.300",children:(0,ex.jsx)(h.cC,{id:"+QNhGE"})})]}),"aria-label":x.ag._({id:"IcHxhR"}),children:(0,ex.jsx)(m.k,{color:"gray.300",alignItems:"center",pr:3,children:(0,ex.jsx)(b.G,{icon:p.bK})})})]})});cT.displayName="BreadcrumbGroup";var c_=t(76547),cR=t(82642),cL=t(30807),cz=t(80040),cM=t(28957),cG=function(){var e=(0,nK.SE)(),n=e.user,t=e.anonymousUser,r=(0,k.I0)(),o=(0,eV.p)(),i=(0,td._i)().editor,s=(0,k.v9)((0,$._h)((null==n?void 0:n.id)||t.id)),a=s.collaborators,c=s.followers;(0,rQ.rU)({editor:i,collaborators:a,user:n});var l=(0,k.v9)($.Ok),u=(0,k.v9)($.e0),f=(0,k.v9)($.yn),p=(0,k.v9)($.gs),g=(0,k.v9)($.JA);(0,w.useEffect)(function(){l.forEach(function(e){o({duration:2e3,position:"bottom",render:function(){return(0,ex.jsxs)(m.k,{bg:"gray.50",p:3,px:6,align:"center",borderRadius:"md",shadow:"md",children:[(0,ex.jsx)(ah.q,{size:"sm",src:e.profileImageUrl,border:"solid 2px ".concat(e.color),color:sF()(e.color).isDark()?"white":"black",bg:e.color,ignoreFallback:!0}),(0,ex.jsx)(v.x,{ml:2,children:(0,ex.jsx)(h.cC,{id:"DSaSKH",values:{0:e.name}})})]})}})})},[l,o]),(0,w.useEffect)(function(){var e=!f&&p&&!g;if(i&&e){o.closeAll();var n=o({id:"detached-toast",render:function(){return(0,ex.jsxs)(m.k,{bg:"gray.50",p:3,px:6,m:4,justify:"flex-end",align:"center",borderRadius:"md",shadow:"md",children:[(0,ex.jsx)(v.x,{size:"sm",mr:6,children:(0,ex.jsx)(h.cC,{id:"PjodLp"})}),(0,ex.jsxs)(tC.h,{size:"sm",alignItems:"center",children:[(0,ex.jsx)(eh.z,{onClick:function(){r((0,$.Qx)({attached:!0}))},variant:"solid",children:(0,ex.jsx)(h.cC,{id:"f/C2ic"})}),(0,ex.jsx)(C.kH,{label:(0,ex.jsx)(h.cC,{id:"5JWVnj"}),children:(0,ex.jsx)(z.h,{isRound:!0,variant:"ghost",size:"xs","aria-label":x.ag._({id:"5JWVnj"}),icon:(0,ex.jsx)(cR.T,{}),onClick:function(){r((0,$.Qx)({attached:!1,following:null}))}})})]})]})},position:"bottom",duration:null});return function(){o.close(n)}}},[i,f,p,g,o,r]),(0,w.useEffect)(function(){p||!i||i.isDestroyed||r((0,$.Qx)({following:null}))},[i,p,r]);var j=(0,iG.i)({base:4,md:6,xl:8})||6,b=j/(c.length?2:1),y=j/(a.length?2:1);return(0,ex.jsx)(m.k,{children:(0,ex.jsxs)(ec.U,{divider:(0,ex.jsx)(cL.c,{borderColor:"gray.200"}),children:[c.length&&(0,ex.jsx)(cN,{type:d.FOLLOWERS,collaborators:c,max:y,isEveryone:0===a.length,localCollaborator:u,localIsAttached:f}),a.length&&(0,ex.jsx)(cN,{type:d.COLLABORATORS,collaborators:a,max:b,isEveryone:0===c.length,localCollaborator:u,localIsAttached:f})]})})};(o=d||(d={})).FOLLOWERS="FOLLOWERS",o.COLLABORATORS="COLLABORATORS";var cN=function(e){var n=e.collaborators,t=e.localCollaborator,r=e.localIsAttached,o=e.type,i=e.max,s=e.isEveryone,a=(0,rQ.OM)(),c=o===d.FOLLOWERS,l=n.length>i,u=l?n.slice(0,i-1):n,f=l?n.length-i+1:0,p=function(e){var n=e.localIsFollowing,t=e.collaborator;c||a({localIsFollowing:n,localIsAttached:r,collaborator:t})};return(0,ex.jsx)(cM.S,{children:(0,ex.jsxs)(cz.H,{size:"sm",spacing:c?-2:0,children:[c&&(0,ex.jsx)(cZ,{isEveryone:s}),u.map(function(e,n){var o,i=(null==t?void 0:null===(o=t.memoState)||void 0===o?void 0:o.following)===e.sessionId,s=!!e.idleSince,a=!c&&(l||u.length-1!==n);return(0,ex.jsx)(C.Vw,{ignoreFallback:!0,name:e.name,label:(0,ex.jsxs)(m.k,{direction:"column",justify:"center",align:"center",children:[(0,ex.jsx)(v.x,{children:e.name}),(0,ex.jsx)(v.x,{fontSize:"xs",children:c?(0,ex.jsx)(h.cC,{id:"iRohzP"}):i&&r?(0,ex.jsx)(h.cC,{id:"1QTvS5"}):(0,ex.jsx)(h.cC,{id:"2Ldadb"})})]}),pointerEvents:s?"none":"auto",opacity:s?.4:1,transitionProperty:"common",transitionDuration:"normal",src:e.profileImageUrl,border:"solid 2px ".concat(e.color),nubbin:i&&r,bg:e.color,shadow:"base",color:sF()(e.color).isDark()?"white":"black",cursor:c?"":"pointer",boxProps:a?{marginEnd:-2}:{},onClick:function(){return p({localIsFollowing:i,collaborator:e})}},e.sessionId)}),f>0&&(0,ex.jsxs)(C.Z9,{tooltipLabel:x.ag._({id:"25VyZX"}),onClick:function(e){var r,o=n.find(function(n){return n.id===e.id});p({localIsFollowing:!!(o&&(null==t?void 0:null===(r=t.memoState)||void 0===r?void 0:r.following)===o.sessionId),collaborator:o})},avatars:n,count:f,disabled:c,children:[(0,ex.jsx)(v.x,{px:2,children:c?(0,ex.jsx)(h.cC,{id:"vliZud",values:{0:n.length}}):(0,ex.jsx)(h.cC,{id:"sC4bhw",values:{0:n.length}})}),!c&&(0,ex.jsx)(v.x,{px:2,fontSize:"sm",color:"gray.500",children:(0,ex.jsx)(h.cC,{id:"miJbY4"})}),(0,ex.jsx)(ob.R,{})]})]})})},cZ=function(e){var n=e.isEveryone,t=(0,w.useState)(!1),r=t[0],o=t[1],i=(0,w.useState)(!1),s=i[0],a=i[1],c=(0,w.useState)(!1),l=c[0],d=c[1];return((0,w.useEffect)(function(){!r&&n&&(a(!0),o(!0),setTimeout(function(){a(!1)},3e3))},[n,r]),n)?(0,ex.jsx)(g.xu,{fontSize:"sm",color:"",px:2,mr:2,children:(0,ex.jsx)(C.kH,{label:(0,ex.jsx)(h.cC,{id:"w7dTyp"}),isOpen:l||s,children:(0,ex.jsx)(g.xu,{mr:2,px:1,bg:"green.300",color:"green.900",borderRadius:"full",onMouseEnter:function(){return d(!0)},onMouseLeave:function(){return d(!1)},children:(0,ex.jsx)(b.G,{icon:c_.Md})})})}):(0,ex.jsx)(g.xu,{fontSize:"sm",color:"gray.700",pr:4,children:(0,ex.jsx)(b.G,{icon:c_.Md})})},cF=t(74624),cW=t(5735),cU=t(45390),cV=t(57895),cB=t(90282),cH=t(24799),cq=t(1672),cK=t(10649),cY=t(4036),cQ=t(82282),cX=t(31807),cJ=t(9846),c$=t(42048),c0=t(98649),c1=function(e){var n=(0,J.CG)($.e_),t=(0,J.TL)(),r=(0,w.useCallback)(function(e){t((0,$.Qt)({docAttrs:{format:e}}))},[t]);return(0,ex.jsx)(tC.h,{size:"sm",isAttached:!0,my:2,children:c0.n.map(function(e){return(0,ex.jsx)(eh.z,{isActive:e.key===n.key,onClick:function(){return r(e.key)},children:av()(e.label)},e.key)})})},c2=t(85147),c5=t(20387),c3=function(){var e;return e={},(0,f.Z)(e,nU.q.DOC_VIEW,{buttonLabel:(0,ex.jsx)(h.cC,{id:"eZb+lw"}),shortcutIcon:c5.zc,shortcutKeys:(0,C.cE)("Mod+Enter"),shortcutLabel:(0,ex.jsx)(h.cC,{id:"9vUn+H"})}),(0,f.Z)(e,nU.q.SLIDE_VIEW,{buttonLabel:(0,ex.jsx)(h.cC,{id:"ydzS9x"}),shortcutIcon:c2.Bg,shortcutKeys:"Esc",shortcutLabel:(0,ex.jsx)(h.cC,{id:"5Rfo7J"})}),e},c4=t(8699),c6=t(47592),c8=t(59131),c7=(0,r4.ZP)("mod+Enter"),c9=(0,r4.ZP)("Esc"),le=(0,r4.ZP)("mod+Esc"),ln=(0,r4.ZP)("shift+mod+Enter"),lt=function(e,n){var t=document.querySelector(n);if(t){var r=t.getBoundingClientRect();e.commands.scrollToNodeWithPin(document.elementFromPoint(r.width/2,100),100)}},lr=function(e){var n=e.editorWrapperEl,t=e.scrollingParentSelector,r=(0,J.TL)(),o=(0,w.useState)(!1),i=o[0],s=o[1],a=(0,w.useState)(!1),c=a[0],l=a[1],d=(0,td._i)().editor,u=(0,J.CG)($.gh),f=(0,w.useRef)(u);(0,w.useEffect)(function(){f.current=u},[u]);var p=(0,J.CG)($.yq),h=(0,J.CG)($.JA),x=(0,J.CG)(ot.C),m=(0,n_.z$)(),v=(0,w.useCallback)(function(e){d&&!d.isDestroyed&&(e===nU.q.SLIDE_VIEW?((0,c6.E0)(d.state.doc,r),(0,oi.U6)(d,!1),d.commands.spotlightCurrentCard()):(d.commands.turnOffSpotlight(!0),lt(d,t)),r(function(n){n((0,$.Qx)({attached:!1})),n((0,$.PM)({mode:e}))}))},[r,d,t]),g=(0,w.useCallback)(function(){try{var e,n,t,r;if(null!==(e=document.body)&&void 0!==e&&e.requestFullscreen){null===(t=document.body)||void 0===t||t.requestFullscreen();return}null!==(n=document.body)&&void 0!==n&&n.webkitRequestFullscreen&&(null===(r=document.body)||void 0===r||r.webkitRequestFullscreen())}catch(e){console.debug("[PresentBlock] Error entering fullscreen:",e)}},[]),j=(0,w.useCallback)(function(){try{if(document.fullscreenElement){document.exitFullscreen();return}document.webkitCurrentFullScreenElement&&document.webkitExitFullscreen&&document.webkitExitFullscreen()}catch(e){console.debug("[PresentBlock] Error exiting fullscreen:",e)}},[]),b=(0,tn.ye)("realUserMetrics"),C=(0,c4.wK)(b),y=C.recordExitSlideModePerformance,O=C.recordEnterSlideModePerformance,k=(0,w.useCallback)(function(e){var n=e.fullscreen,t=void 0!==n&&n;f.current!==nU.q.SLIDE_VIEW&&(v(nU.q.SLIDE_VIEW),t&&g(),null==m||m.trackDocEvent(n_.AA.PRESENT_MODE_ENTERED),O({isFullscreen:t}),setTimeout(function(){document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()}))},[v,O,g,f,m]),S=(0,w.useCallback)(function(){f.current!==nU.q.DOC_VIEW&&(v(nU.q.DOC_VIEW),i&&j(),null==m||m.trackDocEvent(n_.AA.PRESENT_MODE_EXITED),y({isFullscreen:i}))},[v,i,j,y,f,m]);return(0,w.useEffect)(function(){var e=function(){null!==document.fullscreenElement||c||S(),null!==document.webkitCurrentFullScreenElement||c||S(),s(function(e){return!e}),l(!1)};return document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),function(){document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("mozfullscreenchange",e)}},[c,S,j]),(0,r0.r)(function(){d&&!d.isDestroyed&&u===nU.q.DOC_VIEW&&requestAnimationFrame(function(){var e=d.state.selection;e instanceof c8.c&&d.commands.command(function(n){return n.tr.setSelection(e.createSelectionNear()),!0})})},[d,u]),(0,w.useEffect)(function(){return r6.F7.on("keydown","PRESENT_BLOCK",function(e){var n,t,r,o=f.current===nU.q.SLIDE_VIEW;if(!x){if(c7(e)){if(null!=e&&null!==(n=e.target)&&void 0!==n&&n.closest("[data-gamma-child-tiptap-editor]"))return;return e.preventDefault(),k({fullscreen:!1}),!0}if(ln(e)){if(null!=e&&null!==(t=e.target)&&void 0!==t&&t.closest("[data-gamma-child-tiptap-editor]"))return;return e.preventDefault(),k({fullscreen:!0}),!0}if(le(e)&&o)return S(),!0;if(c9(e)&&o&&!p&&!h){if(null!=e&&null!==(r=e.target)&&void 0!==r&&r.closest("[data-gamma-child-tiptap-editor]"))return;return S(),!0}}})},[k,S,g,p,h,n,x]),{enterSlideView:k,exitSlideView:S,enterFullscreen:g,exitFullscreen:j,exitedFullscreenByClick:c,isFullscreen:i,setIsFullscreen:s,setExitedFullscreenByClick:l}},lo=function(e){var n=e.editorWrapperEl,t=e.scrollingParentSelector,r=(0,J.CG)($.gh),o=(0,tn.ye)("presentFullScreen"),i=c3()[r],s=i.shortcutIcon,a=i.shortcutKeys,c=i.buttonLabel,l=lr({editorWrapperEl:n,scrollingParentSelector:t}),d=l.enterSlideView,u=l.exitSlideView;return(0,ex.jsx)(ia.s,{icon:(0,ex.jsx)(b.G,{icon:s,fixedWidth:!0}),command:a,onClick:function(){r===nU.q.SLIDE_VIEW?u():d({fullscreen:o})},children:c})},li=t(50376),ls=t(47090);function la(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function lc(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?la(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):la(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var ll=function(e){var n,t,r=e.doc,o=e.editorWrapperEl,i=e.scrollingParentSelector,s=(0,nK.SE)().user,a=(0,S.$gs)().isConnected,c=(0,rZ.e)(),l=(0,td._i)().editor,d=(0,cu.$)(null==r?void 0:r.title),u=(null==r?void 0:r.createdTime)&&(0,cQ.Z)((0,cX.Z)(r.createdTime),"PPP"),f=null==r?void 0:r.id,p=(0,tX.M)({id:"snapshotsDrawer"}),x=p.isOpen,m=p.onClose,j=p.onOpen,y=(0,tX.M)({id:"analyticsPanelDisclosure"}),O=y.isOpen,k=y.onClose,I=y.onOpen,P=(0,S.LT4)(),E=(0,A.Z)(P,1)[0],D=(0,S.iX9)(),T=(0,A.Z)(D,1)[0],_=(0,n_.z$)(),R=(0,nK.py)("view",r)&&!!s,L=(0,nK.py)("edit",r),z=(0,nK.py)("manage",r)&&!!s,M=(0,tn.ye)("pageSetup")&&L,G=!!(s&&0!==s.workspaceMemberships.length),N=(0,tn.ye)("docFormats"),Z=(0,J.CG)($.hN),F=(0,w.useCallback)(function(){null==_||_.track(n_.AA.DOC_ANALYTICS_VIEWED,{docId:f,source:"toolbar_doc_menu",type:"personal"}),I()},[_,f,I]),W=(0,w.useCallback)(function(e){return function(){if(f){var n={id:f};e?E({variables:n,optimisticResponse:{archiveDoc:lc(lc({},n),{},{archived:e,__typename:"Doc"})}}):T({variables:n,optimisticResponse:{unarchiveDoc:lc(lc({},n),{},{archived:e,__typename:"Doc"})}})}}},[E,f,T]),U=(0,w.useCallback)(function(){l&&l.commands.undo()},[l]),V=(0,tX.M)({id:"codeEditor"}),B=V.isOpen,H=V.onOpen,q=V.onClose,K=(0,tn.ye)("docCustomCode")&&L,Y=(0,ro.n)();return(0,ex.jsxs)(om.v,{children:[(0,ex.jsx)(ov.j,{as:cl.r,borderRadius:"md",isDisabled:x,icon:(0,ex.jsx)(b.G,{icon:cx.cN}),onMouseDown:nd.br,"data-testid":"doc-toolbar-menu-button"}),(0,ex.jsx)(eT.h,{children:r&&(0,ex.jsxs)(og.q,{zIndex:"popover",maxH:"100vh",minW:"280px",overflow:"auto",children:[(0,ex.jsxs)(g.xu,{px:4,py:2,maxW:"300px",children:[(0,ex.jsx)(v.x,{noOfLines:6,children:d}),(0,ex.jsx)(v.x,{fontSize:"sm",color:"gray.500",noOfLines:1,children:(0,ex.jsx)(h.cC,{id:"jlWdji",values:{createdTime:u}})}),(0,ex.jsx)(C.kH,{label:null==r?void 0:null===(n=r.createdBy)||void 0===n?void 0:n.email,children:(0,ex.jsx)(v.x,{display:"inline-block",fontSize:"sm",color:"gray.500",noOfLines:1,children:(0,ex.jsx)(h.cC,{id:"t490IT",values:{0:null==r?void 0:null===(t=r.createdBy)||void 0===t?void 0:t.displayName}})})}),N&&(0,ex.jsx)(c1,{})]}),(0,ex.jsx)(ob.R,{}),(0,ex.jsx)(cJ.V,{label:(0,ex.jsx)(h.cC,{id:"IdcoRx"}),isConnected:a,maxWidth:"300px"}),a&&(0,ex.jsxs)(ex.Fragment,{children:[!!s&&!z&&(0,ex.jsx)(ia.s,{icon:(0,ex.jsx)(b.G,{icon:su.M,fixedWidth:!0}),onClick:F,children:(0,ex.jsx)(h.cC,{id:"ZlwDi6"})}),(0,ex.jsx)(lo,{editorWrapperEl:o,scrollingParentSelector:i}),G&&(0,ex.jsx)(ia.s,{icon:(0,ex.jsx)(b.G,{icon:io.kZ,fixedWidth:!0}),onClick:function(){l&&c({docId:f,initialContent:l.getJSON(),source:"editor_toolbar_doc_menu_duplicate",newWindow:!(0,ri.Q5)()})},children:(0,ex.jsx)(h.cC,{id:"euc6Ns"})}),R&&(0,ex.jsx)(ia.s,{icon:(0,ex.jsx)(b.G,{icon:cK.kw,fixedWidth:!0}),onClick:function(){cc.T.emit("openSharePanel",{view:"export"})},children:(0,ex.jsx)(h.cC,{id:"U8WPSi"})}),M&&(0,ex.jsx)(ia.s,{icon:(0,ex.jsx)(b.G,{icon:cq.gr,fixedWidth:!0}),onClick:function(){cc.T.emit("openPageSetup","cards")},children:(0,ex.jsxs)(ec.U,{children:[(0,ex.jsx)(h.cC,{id:"Kx2GmY"}),(0,ex.jsx)(ss.L,{}),(0,ex.jsx)(cY.C,{colorScheme:"green",ml:2,children:(0,ex.jsx)(h.cC,{id:"isRobC"})})]})}),K&&(0,ex.jsx)(ia.s,{icon:(0,ex.jsx)(b.G,{icon:cH.dT,fixedWidth:!0}),onClick:H,children:(0,ex.jsxs)(ec.U,{children:[(0,ex.jsx)(h.cC,{id:"cnlGIm"}),(0,ex.jsx)(ss.L,{}),(0,ex.jsx)(cY.C,{colorScheme:"green",ml:2,children:(0,ex.jsx)(h.cC,{id:"YBt9YP"})})]})}),Z&&(0,ex.jsx)(ob.R,{}),Z&&(0,ex.jsx)(ia.s,{icon:(0,ex.jsx)(b.G,{icon:cB.faArrowRotateLeft,fixedWidth:!0}),onClick:U,command:(0,C.cE)("Mod+Z"),children:(0,ex.jsx)(h.cC,{id:"9uI/rE"})}),L&&(0,ex.jsx)(ia.s,{icon:(0,ex.jsx)(b.G,{icon:sN.SZ,fixedWidth:!0}),onClick:j,children:(0,ex.jsx)(h.cC,{id:"6Z5x06"})}),Y&&(0,ex.jsx)(ia.s,{icon:(0,ex.jsx)(b.G,{icon:t4.Fz,fixedWidth:!0}),as:re(),href:Y,target:(0,ri.Q5)()?"_self":"_blank",children:(0,ex.jsx)(h.cC,{id:"7U0bM7"})}),z&&(0,ex.jsx)(ob.R,{}),z?r.archived?(0,ex.jsx)(ia.s,{icon:(0,ex.jsx)(b.G,{icon:cV.Ze,fixedWidth:!0}),onClick:W(!1),children:(0,ex.jsx)(h.cC,{id:"yKu/3Y"})}):(0,ex.jsx)(ia.s,{"data-testid":"doc-menu-trash-button",color:"red.500",icon:(0,ex.jsx)(b.G,{icon:eZ.$,fixedWidth:!0}),onClick:W(!0),children:(0,ex.jsx)(h.cC,{id:"1C/Yjq"})}):null]})]})}),r&&(0,ex.jsx)(li.Z,{doc:r,isOpen:x,onClose:m}),r&&O&&(0,ex.jsx)(ca,{doc:r,isAnalyticsPanelOpen:O,onAnalyticsPanelClose:k,mode:"personal"}),K&&(0,ex.jsx)(c$.B,{editor:l,isOpen:B,onClose:q}),M&&(0,ex.jsx)(ls.T,{editor:l})]})},ld=t(22595),lu=t(26886),lf=t(71528),lp=t(26384),lh=t(84558),lx=t(91930),lm=t(7328),lv=t(84807),lg=t(28165),lj=t(97442),lb={followOnStart:"follow_on_start",followingId:"following_id"},lC=function(e,n){var t=n.followOnStart,r=n.followingId,o=new URL(e);return r&&o.searchParams.append(lb.followingId,r),t&&o.searchParams.append(lb.followOnStart,"true"),o.toString()},ly=function(e){switch(e){case"edit":return x.ag._({id:"UZN1cZ"});case"comment":return x.ag._({id:"jFTs0A"});case"view":return x.ag._({id:"Ya6CJ0"});default:return x.ag._({id:"Txd1qM"})}},lO=function(e){var n,t,r=e.isOpen,o=e.onClose,i=e.accessLinkUrl,s=e.onPlayClick,a=(0,nK.SE)().user,c=(0,cy.useRouter)().replace,l={followOnStart:!0,followingId:null==a?void 0:a.id},d=(0,w.useState)(l),f=d[0];d[1];var p=lC(i,f),m=(0,nK.SE)(),j=m.user,y=m.color,O=(0,J.CG)(tu.yx),k=null==O?void 0:null===(n=O.accessLinks)||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.permission,S=(0,lg.keyframes)(u||(u=(0,lm.Z)(["\n    0% { transform: scale(1.0); filter: brightness(1.0);  }\n    3% { transform: scale(1.0); filter: brightness(1.0);  }\n    8% {  transform: scale(0.90); filter: brightness(1.30);  }\n    18% { transform: scale(1.05); filter: brightness(1.0); }\n    30% { transform: scale(1.0); filter: brightness(1.0); }\n  "])));return(0,ex.jsx)(C.Wk,{isDark:!1,children:(0,ex.jsxs)(sp.u_,{isOpen:r,onClose:o,size:"lg",children:[(0,ex.jsx)(tm.Z,{}),(0,ex.jsxs)(sh.h,{children:[(0,ex.jsx)(sT.x,{children:(0,ex.jsx)(h.cC,{id:"88XnIQ"})}),(0,ex.jsx)(tg.o,{}),(0,ex.jsx)(ep.i,{}),(0,ex.jsx)(tj.f,{pt:"6",children:(0,ex.jsxs)(ed.K,{spacing:"4",children:[(0,ex.jsx)(v.x,{children:(0,ex.jsx)(h.cC,{id:"oYTLJe",values:{0:ly(k),GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc},components:{0:(0,ex.jsx)(v.x,{as:"span",fontWeight:"bold",borderBottom:"1px dashed",borderColor:"gray.400",display:"inline-block"}),1:(0,ex.jsx)(C.kH,{label:x.ag._({id:"8LnpqL"}),placement:"top"})}})}),(0,ex.jsx)(g.xu,{mb:"2",children:(0,ex.jsx)(lj.I,{url:p,variant:"solid"})}),(0,ex.jsxs)(sg.b,{children:[(0,ex.jsx)(sk.z,{}),(0,ex.jsxs)(ec.U,{flexBasis:"100%",alignItems:"top",children:[(0,ex.jsx)(v.x,{fontSize:"sm",width:"100%",children:(0,ex.jsx)(h.cC,{id:"EApNIe"})}),(0,ex.jsxs)(g.xu,{position:"relative",textShadow:"sm",children:[(0,ex.jsx)(ah.q,{animation:"".concat(S," 2s infinite ease-out"),name:null==j?void 0:j.displayName,src:null==j?void 0:j.profileImageUrl,size:"md",border:"solid 3px ".concat(y.value),shadow:"lg"}),(0,ex.jsx)(g.xu,{position:"absolute",top:"1.75rem",left:"1.75rem",outline:"0 0 2px rgba(255,255,255,1.0)",sx:{path:{stroke:"white",strokeWidth:48}},color:"black",children:(0,ex.jsx)(b.G,{icon:lv.q,fixedWidth:!0})})]})]})]})]})}),(0,ex.jsx)(tb.m,{children:(0,ex.jsxs)(tC.h,{children:[(0,ex.jsx)(eh.z,{variant:"ghost",colorScheme:"gray",onClick:function(){o()},children:(0,ex.jsx)(h.cC,{id:"DPfwMq"})}),(0,ex.jsx)(eh.z,{variant:"solid",onClick:function(){o(),s(),c(p,p,{shallow:!0})},leftIcon:(0,ex.jsx)(b.G,{icon:c5.zc}),children:(0,ex.jsx)(h.cC,{id:"tbDuNX"})})]})})]})]})})},lw=function(e){var n,t,r,o,i=e.doc,s=e.isStaticEditor,a=e.editorWrapperEl,c=e.scrollingParentSelector,l=(0,tX.M)({id:"meetModal"}),d=l.onOpen,u=l.onClose,f=l.isOpen,p=lr({editorWrapperEl:a,scrollingParentSelector:c}),j=p.enterSlideView,y=p.exitSlideView,O=p.setExitedFullscreenByClick,k=p.isFullscreen,S=p.enterFullscreen,I=p.exitFullscreen,P=(0,nK.SE)().user,E=(0,J.CG)($.gh),D=(0,w.useRef)(E);(0,w.useEffect)(function(){D.current=E},[E]);var A=c3()[E],T=A.shortcutLabel,_=A.shortcutIcon,R=A.shortcutKeys,L=A.buttonLabel,z=null==i?void 0:null===(n=i.accessLinks)||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.url,M=!!(null==i?void 0:null===(r=i.accessLinks)||void 0===r?void 0:null===(o=r[0])||void 0===o?void 0:o.permission),G=(0,nK.py)("manage",i||void 0),N=(0,tn.ye)("presentFullScreen"),Z="present"===(0,J.CG)($.e_).primaryAction?"solid":"plain";return(0,ex.jsxs)(m.k,{children:[(0,ex.jsxs)(tC.h,{isAttached:!0,size:"sm","data-guider-highlight":"present-button-group","data-editor-mode":E===nU.q.SLIDE_VIEW?"slide":"doc",children:[(0,ex.jsx)(C.kH,{closeOnMouseDown:!1,closeOnClick:!1,label:T,shortcut:R,children:(0,ex.jsx)(cl.h,{fontWeight:"normal",size:"sm",variant:Z,onClick:function(){E===nU.q.SLIDE_VIEW?y():j({fullscreen:N})},onMouseDown:nd.br,icon:(0,ex.jsx)(b.G,{icon:_}),"data-present-button":!0,children:L})}),(0,ex.jsxs)(om.v,{children:[(0,ex.jsx)(ov.j,{variant:Z,as:cl.r,icon:(0,ex.jsx)(b.G,{icon:aR.pt})}),(0,ex.jsx)(eT.h,{children:(0,ex.jsxs)(og.q,{zIndex:"popover",children:[E===nU.q.DOC_VIEW&&(0,ex.jsxs)(lx.k,{title:x.ag._({id:"9vUn+H"}),children:[(0,ex.jsx)(ia.s,{icon:(0,ex.jsx)(b.G,{icon:lh.Rk,fixedWidth:!0}),command:(0,C.cE)("Mod+Enter"),onClick:function(){return j({fullscreen:!1})},children:(0,ex.jsx)(h.cC,{id:"LRFe2O"})}),(0,ex.jsx)(ia.s,{icon:(0,ex.jsx)(b.G,{icon:lp.tc,fixedWidth:!0}),command:(0,C.cE)("Mod+Shift+Enter"),onClick:function(){return j({fullscreen:!0})},children:(0,ex.jsx)(h.cC,{id:"OwIqiD"})})]}),E===nU.q.SLIDE_VIEW&&(0,ex.jsx)(ia.s,{icon:(0,ex.jsx)(b.G,{icon:c2.Bg,fixedWidth:!0}),command:"ESC",onClick:y,children:(0,ex.jsx)(h.cC,{id:"5Rfo7J"})}),!s&&P&&G&&(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(ob.R,{}),(0,ex.jsx)(C.kH,{isDisabled:M,label:(0,ex.jsx)(h.cC,{id:"zk6wKo"}),children:(0,ex.jsx)(g.xu,{children:(0,ex.jsx)(ia.s,{onClick:function(){var e;null!=i&&null!==(e=i.accessLinks)&&void 0!==e&&e[0].permission&&d()},isDisabled:!M,icon:(0,ex.jsx)(b.G,{icon:lf.AS,fixedWidth:!0}),children:(0,ex.jsx)(ed.K,{spacing:"0",children:(0,ex.jsx)(h.cC,{id:"z7gRub",components:{0:(0,ex.jsx)(v.x,{}),1:(0,ex.jsx)(v.x,{fontSize:"sm",color:"gray.600"})}})})})})})]}),!s&&P&&z&&(0,ex.jsx)(lO,{isOpen:f,onClose:u,accessLinkUrl:z,onPlayClick:function(){j({fullscreen:!1})}})]})})]})]}),E===nU.q.SLIDE_VIEW&&(0,ex.jsx)(m.k,{ml:E===nU.q.SLIDE_VIEW?2:0,children:(0,ex.jsx)(C.kH,{label:k?"Exit full screen":"Enter full screen",children:(0,ex.jsx)(cl.r,{"aria-label":k?"Exit full screen":"Enter full screen",borderRadius:"md",icon:(0,ex.jsx)(b.G,{icon:k?lu.Qj:ld.TL}),onClick:k?function(){O(!0),I()}:S})})})]})},lk=t(41864),lS=t(35330),lI=t(92779),lP=t(31912),lE=function(e){var n,t,r=e.doc,o=e.showAnalytics,i=e.showSharePublic,s=e.showEmbed,a=e.showButton,c=(0,tX.M)({id:"analyticsModalDisclosure"}),l=c.isOpen,d=c.onClose,u=c.onOpen,f=(0,lS.y)(),p=f.isSharePanelOpen,x=f.onSharePanelOpen,m=f.onSharePanelClose,j=f.view,b=f.setView,y=(0,nK.SE)(),O=y.user,k=y.currentWorkspace,S=(0,td._i)().editor,I=(0,nK.py)("view",r),P=(0,nK.py)("edit",r),E=(0,nK.py)("manage",r),D=(0,n_.z$)();(0,w.useEffect)(function(){return cc.T.on("openSharePanel",function(e){var n=e.view;x(),b(n)})},[x,b]);var A=(0,w.useCallback)(function(){null==D||D.track(n_.AA.DOC_ANALYTICS_VIEWED,{docId:null==r?void 0:r.id,source:"share_panel",type:E?"full":"personal"}),u()},[D,E,null==r?void 0:r.id,u]);if(!I||!O||!r)return null;var T=r.collaborators||[],_=r.channels||[],R=(0,lP.Hs)((0,oG.Z)(T).sort(function(e,n){return e.user.id===O.id?-1:n.user.id===O.id?1:0}).map(function(e){return e.user.id===O.id?"You":e.user.displayName||""}).concat(r.orgAccess?_.map(function(e){return e.name||""}):[])),L=(0,lI.h_)(r,O),z=L?(0,lI.Xp)()[L]:null,M=(0,lI.Gi)(r,k);return null===z?(console.error("[SharePanel] Unknown VisibilityValue for doc",r),null):(0,ex.jsxs)(ex.Fragment,{children:[(void 0===a||a)&&(0,ex.jsx)(C.kH,{label:(0,ex.jsxs)(ex.Fragment,{children:[M&&(0,ex.jsx)(v.x,{fontWeight:"bold",children:(0,ex.jsx)(h.cC,{id:"OS9x6e",values:{GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc}})}),z.title(null==r?void 0:null===(n=r.organization)||void 0===n?void 0:n.name)?(0,ex.jsx)(v.x,{children:z.title(null==r?void 0:null===(t=r.organization)||void 0===t?void 0:t.name)}):null,(0,ex.jsx)(v.x,{fontSize:"xs",children:z.subtitle?z.subtitle(R||""):""})]}),children:(0,ex.jsx)("span",{children:(0,ex.jsx)(cl.h,{"data-guider-highlight":"share-button",onMouseDown:nd.br,icon:(0,ex.jsx)(g.xu,{children:(0,ex.jsx)(lk.aA,{visibility:z,isFromOtherOrg:M})}),isDisabled:!P,onClick:x,children:(0,ex.jsx)(h.cC,{id:"Z8lGw6"})})})}),(0,ex.jsx)(lk.WQ,{doc:r,editor:S,isSharePanelOpen:p,onSharePanelOpen:x,onSharePanelClose:m,onAnalyticsPanelOpen:A,view:j,setView:b,showAnalytics:void 0===o||o,showSharePublic:void 0===i||i,showEmbed:void 0===s||s}),l&&(0,ex.jsx)(ca,{doc:r,onSharePanelOpen:x,onAnalyticsPanelClose:d,isAnalyticsPanelOpen:l,mode:E?"full":"personal"})]})},lD=t(38621),lA=function(e){var n=e.spotlightingByBlock,t=(0,td._i)().editor,r=(0,w.useCallback)(function(){n?null==t||t.commands.turnOffSpotlight():null==t||t.commands.spotlightNextBlock()},[t,n]);return(0,ex.jsx)(m.k,{children:(0,ex.jsx)(C.kH,{closeOnMouseDown:!1,closeOnClick:!1,label:(0,ex.jsxs)(v.x,{whiteSpace:"nowrap",children:[n?"Turn off spotlight":"Turn on spotlight",(0,ex.jsx)(v.x,{as:"span",display:"inline",color:"gray.400",ml:2,children:"S"})]}),children:(0,ex.jsx)(cl.h,{colorScheme:"trueblue",variant:n?"solid":"plain",onClick:function(e){r(),e.target.blur()},icon:(0,ex.jsx)(b.G,{icon:lD.QM}),children:"Spotlight"})})})},lT=t(18504),l_=t(78050),lR=t(4685),lL=t(71007),lz=t(17621),lM=t(2875),lG=(0,w.memo)(function(e){var n=e.isOpen,t=e.onClose,r=e.openThemeEditor,o=e.openThemeEditorWithDefaultTheme,i=e.setDocTheme,s=(0,J.CG)($.Pu),a=(0,w.useCallback)(function(){lM.pw.emit(lM.TI.OPEN_PAGE_SETUP,"background"),null==t||t()},[t]);return(0,ex.jsx)(C.Wk,{isDark:!1,children:(0,ex.jsxs)(tx.d,{returnFocusOnClose:!1,isOpen:n,placement:"right",onClose:t,size:"md",children:[(0,ex.jsx)(tm.Z,{background:"none"}),(0,ex.jsxs)(tv.s,{"data-testid":"doc-theme-drawer","data-doc-theme-drawer":!0,motionProps:{variants:{enter:{x:"0%",transition:{duration:.2}},exit:{x:"100%",transition:{duration:.1}}}},children:[(0,ex.jsx)(sT.x,{pb:4,children:(0,ex.jsx)(lz.v,{title:(0,ex.jsx)(h.cC,{id:"FEr96N"}),openThemeEditorWithDefaultTheme:o,showDrawerCloseButton:!0,currentTheme:s})}),(0,ex.jsx)(tj.f,{overflowX:"hidden","data-theme-picker-scroll-container":!0,children:(0,ex.jsx)(lL.t,{currentTheme:s,openBackgroundPanel:a,setTheme:i,openThemeEditor:r,openThemeEditorWithDefaultTheme:o})})]})]})})});lG.displayName="DocThemeDrawer";var lN=(0,w.memo)(function(){var e,n=(0,eV.p)(),t=(0,td._i)(),r=t.docId,o=t.getCollaborativeEditorInstance,i=(0,tX.M)({id:"themeEditor"}),s=i.isOpen,a=i.onOpen,c=i.onClose,l=(0,tX.M)({id:"themeStyleDrawer"}),d=l.isOpen,u=l.onOpen,f=l.onClose,p=null===(e=o())||void 0===e?void 0:e.state.doc.toJSON(),x=(0,J.CG)($.Pu),v=(0,lR.g)(),g=(0,A.Z)(v,2),j=g[0],b=g[1],C=o(),y=(0,eP.LW)(C,a,b),O=y.openThemeEditor,k=y.openThemeEditorWithDefaultTheme,S=(0,n_.z$)(),I=(0,eP.vi)({docId:r,editor:C}).updateDocThemeWithAccentImages,P=(0,w.useCallback)(function(e){e.id!==x.id&&I(e.id).then(function(){null==S||S.track(n_.AA.DOC_THEME_UPDATED,{doc_id:r,theme_id:e.id})}).catch(function(e){console.error(e),n({title:(0,ex.jsx)(h.cC,{id:"Fulf8b",values:{0:e.message}}),position:"top",status:"error"})})},[S,x.id,r,n,I]);return(0,w.useEffect)(function(){var e=cc.T.on("toggleThemeBlock",u),n=lM.pw.on(lM.TI.OPEN_THEME_DRAWER,u);return function(){e(),n()}},[u]),(0,ex.jsxs)(m.k,{children:[(0,ex.jsx)(lG,{isOpen:d&&!s,onClose:f,openThemeEditor:O,openThemeEditorWithDefaultTheme:k,setDocTheme:P}),(0,ex.jsx)(l_.z,{isOpen:s,onClose:c,state:j,dispatch:b,docContent:p,onThemeCreated:P,disableDrawerTransition:!0})]})}),lZ=(0,w.memo)(function(){var e=(0,S.$gs)().isConnected;return(0,ex.jsx)(C.kH,{label:e?(0,ex.jsx)(h.cC,{id:"JkEyR8"}):(0,ex.jsx)(h.cC,{id:"GvC+mL",components:{0:(0,ex.jsx)(v.x,{}),1:(0,ex.jsx)(v.x,{color:"gray.300"})}}),"aria-label":x.ag._({id:"JkEyR8"}),children:(0,ex.jsx)(g.xu,{children:(0,ex.jsx)(cl.h,{"data-guider-highlight":"toolbar-theme-button",onClick:function(){cc.T.emit("toggleThemeBlock",!0)},isDisabled:!e,icon:(0,ex.jsx)(b.G,{icon:lT.q2}),"data-testid":"toolbar-theme-button",children:(0,ex.jsx)(h.cC,{id:"FEr96N"})})})})});lZ.displayName="ThemeToolbarButton";var lF=function(){return(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(lN,{}),(0,ex.jsx)(lZ,{})]})};lN.displayName="ThemeDrawers";var lW=t(31997),lU=t(74588),lV=t(95472),lB=[.5,.8,.9,1,1.1,1.2,1.5,2],lH=function(e){return"".concat((100*e).toFixed(0),"%")},lq=function(){var e=(0,tn.ye)("presentZoom"),n=(0,td._i)().editor,t=(0,n_.z$)(),r=(0,k.I0)(),o=(0,J.CG)($.SU),i=(0,w.useCallback)(function(e){r((0,$.Ic)({zoomLevel:e})),r((0,$.fT)({enabled:!1})),null==t||t.track(n_.AA.DOC_ZOOMED,{direction:"set",level:e})},[r,t]),s=(0,w.useCallback)(function(){r((0,$.fT)({enabled:!0}))},[r]),a=(0,w.useCallback)(function(){var e=Math.min(n5.v4,o+.1);r((0,$.Ic)({zoomLevel:e})),r((0,$.fT)({enabled:!1})),null==t||t.track(n_.AA.DOC_ZOOMED,{direction:"in",level:e})},[r,t,o]),c=(0,w.useCallback)(function(){var e=Math.max(n5.Ou,o-.1);r((0,$.Ic)({zoomLevel:e})),r((0,$.fT)({enabled:!1})),null==t||t.track(n_.AA.DOC_ZOOMED,{direction:"in",level:e})},[r,t,o]),l=(0,w.useCallback)(function(){var e=n5.aX;r((0,$.Ic)({zoomLevel:e})),r((0,$.fT)({enabled:!1})),null==t||t.track(n_.AA.DOC_ZOOMED,{direction:"reset",level:e})},[r,t]),d=(0,J.CG)(ot.C),u=(0,r8.rJ)();return((0,w.useEffect)(function(){if(e)return r6.F7.on("keydown","PRESENT_BLOCK",function(e){return!(d||!n||(0,lV.KB)(n)||(0,nW.Hx)(e.target))&&((0,r4.ZP)("=")(e)?(a(),e.preventDefault(),!0):(0,r4.ZP)("-")(e)?(c(),e.preventDefault(),!0):(0,r4.ZP)("0")(e)?(l(),e.preventDefault(),!0):!!(0,r4.ZP)("9")(e)&&(s(),e.preventDefault(),!0))})},[d,e,n,a,c,l,s]),e)?(0,ex.jsxs)(tC.h,{spacing:"0",size:"sm",variant:"plain",isAttached:!0,children:[(0,ex.jsx)(C.kH,{closeOnMouseDown:!1,closeOnClick:!1,shortcut:"-",label:x.ag._({id:"FjkaiT"}),children:(0,ex.jsx)(z.h,{"aria-label":x.ag._({id:"FjkaiT"}),fontWeight:"normal",onClick:c,icon:(0,ex.jsx)(b.G,{icon:lW.Kl})})}),(0,ex.jsxs)(om.v,{closeOnSelect:!0,children:[(0,ex.jsx)(C.kH,{label:x.ag._({id:"VZ3UQG"}),children:(0,ex.jsx)(ov.j,{minW:20,as:eh.z,variant:"plain",size:"sm",rightIcon:(0,ex.jsx)(b.G,{icon:lU.eW}),children:u?(0,ex.jsx)(h.cC,{id:"R9Khdg"}):lH(o)})}),(0,ex.jsxs)(og.q,{maxW:"220px",children:[(0,ex.jsx)(oC._,{value:u?"auto":o.toString(),type:"radio",children:(0,ex.jsx)(oy.i,{value:"auto",onClick:s,children:(0,ex.jsxs)(ec.U,{children:[(0,ex.jsxs)(v.x,{children:[(0,ex.jsx)(h.cC,{id:"R9Khdg"})," ",(0,ex.jsx)(v.x,{as:"span",color:"gray.500",children:(0,ex.jsx)(h.cC,{id:"P9Cyl9"})})]}),(0,ex.jsx)(ss.L,{}),(0,ex.jsx)(v.x,{as:"span",opacity:"0.6",children:"9"})]})})}),(0,ex.jsx)(ob.R,{}),(0,ex.jsx)(oC._,{value:u?"auto":o.toString(),type:"radio",children:lB.map(function(e){return(0,ex.jsx)(oy.i,{value:(e/100).toString(),onClick:function(){i(e)},children:(0,ex.jsxs)(ec.U,{children:[(0,ex.jsx)(v.x,{children:lH(e)}),(0,ex.jsx)(ss.L,{}),e===n5.aX&&(0,ex.jsx)(v.x,{as:"span",opacity:"0.6",children:"0"})]})},e)})})]})]}),(0,ex.jsx)(C.kH,{closeOnMouseDown:!1,closeOnClick:!1,shortcut:"+",label:x.ag._({id:"AWOSPo"}),children:(0,ex.jsx)(z.h,{fontWeight:"normal","aria-label":x.ag._({id:"AWOSPo"}),onClick:a,icon:(0,ex.jsx)(b.G,{icon:t6.r8})})})]}):null},lK=(0,w.memo)(function(e){var n,r,o=e.scrollingParentSelector,i=e.toggleCommentsPanel,s=e.isCommentsPanelOpen,a=e.editorWrapperEl,c=e.docEditorType,l=(0,si.a)(["(max-width: 840px)","(min-width: 841px)"]),d=(0,A.Z)(l,1)[0],u=(0,iG.i)({base:!0,lg:!1}),p=(0,rs.LQ)(window.location.href),h=(0,J.CG)($.gh),x=(0,J.CG)(tu.yx),v=(0,td._i)().editor,g=(0,nK.py)("comment",x),j=(0,oo.g)(v).enabled,b="SLIDE_VIEW"!==h,C=(0,J.CG)($.hN),y=c!==tl.Z.COLLABORATIVE,O=c===tl.Z.PUBLIC_STATIC,k=(0,J.CG)($.Tf),S=(0,tn.ye)("aiChat");(0,tn.ye)("pptExport")&&(window.exportToPptx=(n=(0,tf.Z)(th().mark(function e(n){var r;return th().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(v){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.all([t.e(9775),t.e(5743),t.e(3496)]).then(t.bind(t,13448));case 4:return r=e.sent.exportToPptx,e.abrupt("return",r(v,n));case 7:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}));var I=X((0,w.useCallback)(function(e){var n=P.current;return!!n&&(!!(n.querySelector("[data-active]")||n.querySelector('[aria-expanded="true"]'))||e.clientY<100)},[]),!k),P=(0,w.useRef)(null),E=!k||k&&I,D=!!(null==x?void 0:x.publishedSnapshotId),T=!(0,ri.s2)()&&!d&&!p;return v?(0,ex.jsxs)(m.k,{"data-editor-toolbar":!0,ref:P,bg:"linear-gradient(0deg, rgba(0,0,0,0) 0%, rgba(0,0,0,.1) 100%)",position:"absolute",zIndex:"overlay",top:0,left:0,right:0,p:2,alignItems:"center",pr:6,marginTop:E?0:"-100%",pointerEvents:"none",sx:(r={},(0,f.Z)(r,"&:focus-within",{marginTop:0}),(0,f.Z)(r,"> *",{pointerEvents:"auto"}),(0,f.Z)(r,"> #toolbar-spacer",{pointerEvents:"none"}),r),transitionProperty:"margin-top",transitionDuration:"ultra-slow",transitionTimingFunction:"ease-in-out","data-print-hidden":!0,children:[(0,ex.jsx)(cU.a,{}),!O&&(0,ex.jsx)(ec.U,{children:(0,ex.jsx)(cI,{doc:x})}),(0,ex.jsx)(ss.L,{pointerEvents:"none",id:"toolbar-spacer"}),(0,ex.jsxs)(ec.U,{children:[!d&&(0,ex.jsx)(cG,{}),!d&&!b&&(0,ex.jsx)(lq,{}),!d&&!b&&(0,ex.jsx)(ex.Fragment,{children:(0,ex.jsx)(lA,{spotlightingByBlock:j})}),!d&&!y&&C&&(0,ex.jsx)(lF,{}),!d&&!y&&(0,ex.jsx)(lE,{doc:x}),T&&!D&&(0,ex.jsx)(lw,{doc:x,isStaticEditor:y,editorWrapperEl:a,scrollingParentSelector:o}),T&&D&&(0,ex.jsx)(sd,{doc:x}),!y&&g&&(0,ex.jsx)(cF.U,{doc:x,mode:h,isCommentsPanelOpen:s,toggleCommentsPanel:i}),!d&&u&&!y&&C&&S&&(0,ex.jsx)(cW.u,{}),!d&&!y&&(0,ex.jsx)(cp,{doc:x}),!d&&!y&&(0,ex.jsx)(ll,{doc:x,editorWrapperEl:a,scrollingParentSelector:o}),!O&&(0,ex.jsx)(m.k,{children:(0,ex.jsx)(tw.DY,{showRing:!0})})]})]}):null}),lY=t(34684),lQ=t(95993),lX=t(98013),lJ=t(27483),l$=t(81891),l0=t(2702),l1=t(27809),l2=t(84991),l5=t(76451),l3=function(e){(0,W.Z)(r,e);var n,t=(n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=(0,V.Z)(r);if(n){var o=(0,V.Z)(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return(0,U.Z)(this,e)});function r(e){var n;return(0,N.Z)(this,r),t.call(this,{transform:(n=(0,tf.Z)(th().mark(function n(t,r){var o,i,s,a;return th().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!("data"!==t.event)){n.next=3;break}return r.enqueue(t),n.abrupt("return");case 3:s=(i=t.data.content).attrs.id,(a=i.content.find(function(e){return"cardAccentLayoutItem"===e.type}))&&(!a.attrs.background||(null===(o=a.attrs.background)||void 0===o?void 0:o.type)===l5.E.NONE)&&(a.attrs.background=(0,l2.Bv)(e,s),(0,l2.Tm)(i)),r.enqueue(t);case 8:case"end":return n.stop()}},n)})),function(e,t){return n.apply(this,arguments)})})}return(0,Z.Z)(r)}(lQ.GJ),l4=t(21365),l6=t(60081),l8=t(80591),l7=t(4038),l9=t(43862);function de(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function dn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?de(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):de(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var dt=(i=(0,tf.Z)(th().mark(function e(n){var t,r,o,i,s,a,c;return th().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=n.editor,r=n.chain,o=n.node,i=n.imageAttrs,s=n.pos,r.updateAttributesAtPos(s,(0,l8.j6)(o,{uploadStatus:l9.D.Uploading})),a=i.tempUrl,c=i.src,(0,l7.WY)(c,t.storage.mediaUpload.orgId,{onUploadComplete:function(e){(0,l8.Ns)(t,a,e)},onUploadFailed:function(e){(0,l8.f8)(t,a,e,!0)}});case 4:case"end":return e.stop()}},e)})),function(e){return i.apply(this,arguments)}),dr=(s=(0,tf.Z)(th().mark(function e(n){var t,r,o,i,s,a;return th().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.cardId,r=n.editor,console.debug("[AIStream uploadAIImages] for cardId: ",t),o=r.chain(),i=(0,nN.N2)(r.state.doc,function(e){return(0,nF.KH)(e)&&e.attrs.id===t})[0]){e.next=7;break}return console.error("[uploadAIImages] can not find card with id: ",t),e.abrupt("return");case 7:a=(s=i.pos)+i.node.nodeSize,r.state.doc.descendants(function(e,n){if(n<s||n>a)return!0;var t=(0,l8.XU)(e);return!t||(t&&t.uploadStatus===l9.D.Queued&&(console.debug("[AIStream processAIImages]: ".concat(e.type.name," node with AI queries at pos ").concat(n,":"),t),dt({editor:r,chain:o,node:e,imageAttrs:t,pos:n})),!0)}),o.run();case 11:case"end":return e.stop()}},e)})),function(e){return s.apply(this,arguments)}),di=(a=(0,tf.Z)(th().mark(function e(n){var t,r,o,i,s;return th().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.lastCompletedCardId,r=n.editor,o=n.theme,t){e.next=3;break}return e.abrupt("return");case 3:if(console.debug("[AIStream refetchLazyImages] for cardId: ",t),i=(0,nN.N2)(r.state.doc,function(e){return(0,nF.KH)(e)&&e.attrs.id===t})[0]){e.next=8;break}return console.error("[refetchLazyImages] can not find card with id: ",t),e.abrupt("return");case 8:s=i.pos+i.node.nodeSize,r.state.doc.descendants(function(e,n){if(n<0||n>s)return!0;var t=(0,l8.XU)(e);if(t&&"queued"===t.loadImageStatus&&t.loadImageId&&t.loadImageParams){var i=t.loadImageId,a=t.loadImageParams;return(0,l6.B)({loadImageId:i,loadImageParams:a,context:{docId:r.gammaDocId,workspaceId:r.gammaOrgId}}).then(function(n){ds({editor:r,newAttrs:n,loadImageId:i,node:e,theme:o})}),!0}});case 11:case"end":return e.stop()}},e)})),function(e){return a.apply(this,arguments)}),ds=(c=(0,tf.Z)(th().mark(function e(n){var t,r,o,i,s,a,c,l;return th().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.editor,r=n.loadImageId,o=n.newAttrs,i=n.node,s=n.theme,a=n.cardId,c=(0,nN.N2)(t.state.doc,function(e){var n=(0,l8.XU)(e);return!!n&&n.loadImageId===r})[0]){e.next=5;break}return console.error("[AIStream] could not find image in editor with loadImageId=".concat(r,"}")),e.abrupt("return");case 5:l="cardAccentLayoutItem"===i.type.name&&"error"===o.loadImageStatus?dn(dn({},c.node.attrs),{},{background:(0,l2.Bv)(s,a)}):(0,l8.j6)(c.node,o),t.commands.updateAttributesAtPos(c.pos,l);case 7:case"end":return e.stop()}},e)})),function(e){return c.apply(this,arguments)});function da(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function dc(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?da(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):da(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var dl=function(e){(0,W.Z)(o,e);var n,t,r=(n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=(0,V.Z)(o);if(n){var r=(0,V.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,U.Z)(this,e)});function o(e){var n,t,i=e.editor,s=e.theme;(0,N.Z)(this,o);var a=(n=(0,tf.Z)(th().mark(function e(n,r){var o,a,c;return th().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!("data"!==n.event)){e.next=3;break}return r.enqueue(n),e.abrupt("return");case 3:a=(o=n.data).index,c=o.id,t.streamingCardIndex=a,(0,l4.N)(n.data.content,function(e){if("text"!==e.type){var n,r=tO.NB.fromJSON(i.schema,{type:e.type,attrs:e.attrs}),o=(0,l8.XU)(r);if(o&&"queued"===o.loadImageStatus&&o.loadImageId&&o.loadImageParams){var l=o.loadImageId,d=o.loadImageParams;t.imageAttrs[l]||(t.imageAttrs[l]=r.attrs),t.loadImagePromises[l]||(t.loadImagePromises[l]=t.loadImage({editor:i,loadImageId:l,loadImageParams:d,cardIndex:a,cardId:c,theme:s,node:r})),e.attrs=null!==(n=t.loadedImageAttrs[l])&&void 0!==n?n:t.imageAttrs[l]}}}),n.data.cardComplete&&t.streamingCardIndex++,r.enqueue(n);case 8:case"end":return e.stop()}},e)})),function(e,t){return n.apply(this,arguments)});return t=r.call(this,{transform:a}),(0,f.Z)((0,F.Z)(t),"streamingCardIndex",0),(0,f.Z)((0,F.Z)(t),"imageAttrs",{}),(0,f.Z)((0,F.Z)(t),"loadedImageAttrs",{}),(0,f.Z)((0,F.Z)(t),"loadImagePromises",{}),t}return(0,Z.Z)(o,[{key:"loadImage",value:(t=(0,tf.Z)(th().mark(function e(n){var t,r,o,i,s,a,c,l;return th().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.editor,r=n.loadImageId,o=n.loadImageParams,i=n.cardIndex,s=n.cardId,a=n.node,c=n.theme,e.next=3,(0,l6.B)({loadImageId:r,loadImageParams:o,context:{docId:t.gammaDocId,workspaceId:t.gammaOrgId}});case 3:if(l=e.sent,this.streamingCardIndex!==i){e.next=8;break}return this.loadedImageAttrs[r]=(0,l8.j6)(a,l),"cardAccentLayoutItem"===a.type.name&&"error"===l.loadImageStatus&&(this.loadedImageAttrs[r]=dc(dc({},a.attrs),{},{background:(0,l2.Bv)(c,s)})),e.abrupt("return");case 8:requestAnimationFrame(function(){ds({editor:t,loadImageId:r,newAttrs:l,node:a,theme:c,cardId:s})});case 9:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})}]),o}(lQ.GJ),dd=t(91760),du=th().mark(dv);function df(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return dp(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if("Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return dp(e,n)}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==t.return||t.return()}finally{if(a)throw i}}}}function dp(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function dh(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function dx(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?dh(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):dh(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var dm=function(e,n,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(0===n.length)throw Error("Cannot have empty path");for(var o=(0,oG.Z)(n),i=dx({},e),s=i,a=0;n.length>0;){if(!s.content)throw Error("Can't surround a node with children");var c=o.shift();if(0===o.length){var l=s.content.slice(0,c);l.push(t),s.content=l;break}if(a<r){var d=s.content.slice(0);d.splice(c,1,dx({},d[c])),s.content=d,s=s.content[c]}else{var u=s.content.slice(0,c+1);u.splice(c,1,dx({},u[c])),s.content=u,s=s.content[c]}a++}return i};function dv(e){var n,t,r,o,i,s,a,c,l,d,u,f,p,h,x=arguments;return th().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(n=x.length>1&&void 0!==x[1]?x[1]:0,t=x.length>2&&void 0!==x[2]?x[2]:e,r=x.length>3&&void 0!==x[3]?x[3]:[],"text"!==e.type){m.next=14;break}o=e.text.split(" "),i=0;case 6:if(!(i<o.length)){m.next=13;break}return s={type:"text",text:o.slice(0,i+1).join(" ")},m.next=10,dm(t,r,s,n);case 10:i++,m.next=6;break;case 13:case 17:return m.abrupt("return");case 14:if(e.content){m.next=18;break}return m.next=17,dm(t,r,e,n);case 18:a=0,c=df(e.content),m.prev=20,c.s();case 22:if((l=c.n()).done){m.next=45;break}d=l.value,u=[].concat((0,oG.Z)(r),[a]),f=df(dv(d,n,t,u)),m.prev=26,f.s();case 28:if((p=f.n()).done){m.next=34;break}return h=p.value,m.next=32,h;case 32:m.next=28;break;case 34:m.next=39;break;case 36:m.prev=36,m.t0=m.catch(26),f.e(m.t0);case 39:return m.prev=39,f.f(),m.finish(39);case 42:a++;case 43:m.next=22;break;case 45:m.next=50;break;case 47:m.prev=47,m.t1=m.catch(20),c.e(m.t1);case 50:return m.prev=50,c.f(),m.finish(50);case 53:case"end":return m.stop()}},du,null,[[20,47,50,53],[26,36,39,42]])}function dg(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function dj(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?dg(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):dg(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function db(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var dC=function(e){(0,W.Z)(r,e);var n,t=(n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=(0,V.Z)(r);if(n){var o=(0,V.Z)(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return(0,U.Z)(this,e)});function r(e){(0,N.Z)(this,r);var n,o,i=(n=(0,tf.Z)(th().mark(function n(t,r){var o,i,s,a,c,l;return th().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!("done"===t.event||"cancel"===t.event)){n.next=3;break}return r.enqueue(t),n.abrupt("return");case 3:o=(0,J.bh)(),i=null,s=function(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return db(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if("Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return db(e,n)}}(e))){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==t.return||t.return()}finally{if(a)throw i}}}}(dv(t.data.content,1)),n.prev=6,s.s();case 8:if((a=s.n()).done){n.next=19;break}if(c=a.value){n.next=12;break}return n.abrupt("continue",17);case 12:return i&&r.enqueue(i),i={id:t.id,event:"data",data:dj(dj({},t.data),{},{content:c,cardComplete:!1})},l=(0,rn.qn)(e)(o.getState()),n.next=17,dy(l);case 17:n.next=8;break;case 19:n.next=24;break;case 21:n.prev=21,n.t0=n.catch(6),s.e(n.t0);case 24:return n.prev=24,s.f(),n.finish(24);case 27:i&&r.enqueue(dj(dj({},i),{},{data:dj(dj({},i.data),{},{cardComplete:!0})}));case 28:case"end":return n.stop()}},n,null,[[6,21,24,27]])})),function(e,t){return n.apply(this,arguments)});return o=t.call(this,{transform:i}),(0,f.Z)((0,F.Z)(o),"index",0),(0,f.Z)((0,F.Z)(o),"startTime",performance.now()),o}return(0,Z.Z)(r)}(lQ.GJ),dy=function(e){return new Promise(function(n){return dd.iK(n,e)})},dO=t(54113),dw=t(51663),dk=function(e){var n=e.enabled,t=e.type,r=(0,dw.As)(t),o=(0,w.useRef)(!0);(0,w.useEffect)(function(){if(n){var e=r.scroller;if(e){var t=function(){r.isAtBottom(40)?o.current=!0:o.current=!1},i=function(){o.current=!1};return e.addEventListener("wheel",t,{passive:!0}),e.addEventListener("touchend",t,{passive:!0}),e.addEventListener("touchstart",i,{passive:!0}),e.addEventListener("touchmove",i,{passive:!0}),function(){e.removeEventListener("wheel",t),e.removeEventListener("touchend",t),e.removeEventListener("touchstart",i),e.removeEventListener("touchmove",i)}}}},[r,n]);var i=(0,w.useCallback)(function(){if(o.current){var e;null===(e=r.scroller)||void 0===e||e.scrollTo({top:r.scroller.scrollHeight,behavior:"auto"})}},[r]);return(0,iH.Z_)(i,100)},dS=t(73593),dI=t(51180),dP=t(34768),dE=["latency"];function dD(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function dA(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?dD(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):dD(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var dT="[CONTENT_FILTER]",d_=function(){return(0,ex.jsxs)(sg.b,{status:"error",variant:"solid",children:[(0,ex.jsx)(sk.z,{}),(0,ex.jsx)(sb.X,{children:(0,ex.jsxs)(ed.K,{children:[(0,ex.jsx)("strong",{children:(0,ex.jsx)(h.cC,{id:"7g5s/N"})}),(0,ex.jsx)(v.x,{children:(0,ex.jsx)(h.cC,{id:"Xp43Ei"})})]})})]})},dR=function(e){var n=e.editor,t=e.content,r=e.cardId,o=e.cardIndex,i=e.cardComplete,s=(0,nN.N2)(n.state.doc,function(e){return(0,iU.KH)(e)})[0],a=(0,nN.N2)(n.state.doc,function(e){return(0,iU.KH)(e)&&e.attrs.id===r})[0];if(!s)throw Error("Doc does not have a first card");var c=a?{from:a.pos,to:a.pos+a.node.nodeSize}:0===o?{from:s.pos,to:s.pos+s.node.nodeSize}:n.state.doc.nodeSize-3;try{if(n.commands.insertContentAt(c,t,{updateSelection:0===o}),i&&0===o){var l=(0,iv.t)(n.state.doc.resolve(s.pos));l&&n.commands.command(function(e){return e.tr.setSelection(l),!0})}}catch(e){console.warn("[useCreateFromStream] ERROR updating card"),console.warn(e)}},dL=function(e){var n=e.docId,t=e.store,r=e.generateInfo,o=e.editor,i=e.lazyImages;if(!r.lastEventId||!r.streamId||!r.interactionId){console.error("Trying to resume stream for doc (id=".concat(n,") without lastEventId or streamId or interactionId"),{lastEventId:r.lastEventId,streamId:r.streamId,interactionId:r.interactionId});return}l$.a.trackRequestSent(t,{interface:"wizard",streaming:!0,interactionId:r.interactionId,isResuming:!0});var s=(0,lJ.pM)({interactionId:r.interactionId,lastEventId:r.lastEventId,streamId:r.streamId,retries:3}).stream;return(0,lX.Nl)({stream:s,docId:n,interactionId:r.interactionId,lastCompletedCardId:r.lastCompletedCardId,lastCompletedCardIndex:r.lastCompletedCardIndex,options:{lazyImages:i,imageOptions:r.imageOptions,docFormatKey:(0,dS.hx)((0,dS.VA)(o)).key},store:t})},dz=function(e,n){var t,r=(0,J.CG)($.Pu),o=(0,J.qr)(),i=(0,J.TL)(),s=(0,J.CG)($.KV),a=(0,tn.ye)("streamResumingEnabled"),c=(0,tn.ye)("generatorLazyImages"),l=(0,w.useRef)(!1),d=dM({docId:e}),u=d.isStreaming,f=d.onStreamData,p=d.onStreamDone,h=d.onStreamError,x=d.onStreamStart,m=d.onAbortStream,v=dk({enabled:u,type:"editor"}),g=(0,w.useCallback)((t=(0,tf.Z)(th().mark(function t(i){var s,a,c;return th().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:x({editor:n}),a=dG({streamResponse:i,editor:n,store:o,theme:r,docId:e}).getReader(),t.prev=5;case 6:return t.next=8,a.read();case 8:if((s=t.sent).done){t.next=18;break}if(s.value){t.next=11;break}return t.abrupt("continue",6);case 11:if(!l.current){t.next=14;break}return console.log("[AIStream] has aborted -- no longer reading stream"),t.abrupt("break",18);case 14:"data"===(c=s.value).event&&(f({value:c.data,editor:n,streamResponse:i}),v()),t.next=6;break;case 18:t.next=24;break;case 20:return t.prev=20,t.t0=t.catch(5),h({err:t.t0,streamResponse:i,editor:n}),t.abrupt("return");case 24:if(!l.current){t.next=26;break}return t.abrupt("return");case 26:c&&"done"!==c.event&&console.error('[AIStream] incomplete stream: last message received is not `event="done"`',{lastMessage:c}),p({editor:n,streamResponse:i});case 28:case"end":return t.stop()}},t,null,[[5,20]])})),function(e){return t.apply(this,arguments)}),[e,n,f,p,h,x,v,o,r]);(0,dP.v)(function(){if(n&&s&&!u){var t=(0,rn.oH)(e)(o.getState()),r=(0,rn.nl)(o.getState());if(t){"running"===t.status&&g(t);return}if(a&&!r){var i=(0,dS.VA)(n),l=i.generateInfo;if("streaming"!==i.generateStatus){if(new URLSearchParams(window.location.search).get("restream")){var d=dL({docId:e,generateInfo:dA(dA({},{interactionId:l.interactionId,streamId:l.streamId}),{},{lastEventId:"0",lastCompletedCardId:null,imageOptions:l.imageOptions||{provider:"aiGenerated"},lastCompletedCardIndex:null}),editor:n,store:o,lazyImages:c});d&&g(d)}return}var f=(0,$.yx)(o.getState());if((null==f?void 0:f.createdTime)&&Date.now()-new Date(f.createdTime).getTime()>36e5){n.commands.updateAttributesAtPos(0,{generateStatus:"done"});return}var p=dL({docId:e,generateInfo:l,editor:n,store:o,lazyImages:c});p&&g(p)}}},[e,n,o,s,x,h,f,p,a,g,u,c],[n,s]),(0,w.useEffect)(function(){return function(){var t=(0,rn.oH)(e)(o.getState());n&&t&&"running"===t.status&&(l.current=!0,m({editor:n,streamResponse:t}))}},[i,e,m,n,o])},dM=function(e){var n=e.docId,t=(0,eV.p)(),r=(0,J.TL)(),o=(0,J.qr)(),i=(0,tn.ye)("aiWizardUploadImages"),s=(0,w.useState)(!1),a=s[0],c=s[1],l=(0,tn.ye)("debugLogging"),d=(0,w.useRef)(null);(0,w.useEffect)(function(){return function(){d.current&&(t.close(d.current),d.current=null)}},[t]);var u=(0,w.useCallback)(function(){d.current||(d.current=t({id:"ai-generating-toast",isClosable:!1,render:function(){return(0,ex.jsxs)(sg.b,{variant:"light",children:[(0,ex.jsx)(tW.$,{size:"sm",mr:2}),(0,ex.jsxs)(sb.X,{children:[(0,ex.jsx)("strong",{children:(0,ex.jsx)(h.cC,{id:"n2cF1o"})})," ",(0,ex.jsx)(h.cC,{id:"BFGwQA"})]})]})},position:"top",duration:null}))},[t]),f=(0,w.useCallback)(function(e){var n=e.editor;n&&(c(!0),n.commands.setAIGenerationRunning(!0),u())},[u]),p=(0,w.useCallback)(function(e){var n=e.editor,t=e.value;if(e.streamResponse&&n){var r=t.id,o=t.cardComplete,s=t.index;dR({editor:n,content:t.content,cardId:r,cardIndex:s,cardComplete:o}),o&&i&&dr({editor:n,cardId:r})}},[i]),x=(0,w.useCallback)(function(e){var n,i,s,a=e.editor,u=e.streamResponse;if(a&&u){var f=u.id,p=(0,dS.hx)((0,dS.VA)(a)),x=(0,dS.VA)(a).generateInfo;c(!1),a.commands.setAIGenerationRunning(!1),a.commands.updateAttributesAtPos(0,{generateStatus:"done"});var m=(0,l1.NV)(),v=m.debugInfo();l&&console.log("[AIStream] ImageStore DEBUG",{imageStore:m,debug:v}),(0,l1.Uu)(),r((0,rn.G0)({id:f,status:"complete"}));var g=(0,dI.R)(a),j=new TextEncoder().encode(JSON.stringify(a.state.doc.toJSON())),b=g?g/j.byteLength:void 0;l$.a.trackStreamComplete(o,f,{imageProvider:null===(n=x.imageOptions)||void 0===n?void 0:n.provider,numImageSearches:v.requests.length,imageSearches:v.requests,ydocToJsonRatio:b});var C=(0,$.yx)(o.getState());C&&null!==(i=C.docGenerateInput)&&void 0!==i&&i.id?(0,dO.d)((null===(s=x.imageOptions)||void 0===s?void 0:s.provider)==="aiGenerated"?"generateV2WithImages":"generateV2"):(0,dO.d)("wizardCreation"),d.current&&t.update(d.current,{title:(0,ex.jsx)(h.cC,{id:"2/LpWt",values:{0:p.generationLabel||p.label}}),status:"success",position:"top",duration:3e3,isClosable:!0})}},[r,l,o,t]);return{isStreaming:a,onStreamStart:f,onStreamData:p,onStreamError:(0,w.useCallback)(function(e){var i=e.err,s=e.editor,a=e.streamResponse,u=a.id,f=(0,l0.uS)(i),p=f.errorMessage,x=f.errorCode;console.error("StreamError: ",{interactionId:u,errorMessage:p,errorCode:x,stack:i.stack}),l&&console.log("StreamError: (".concat(x,") - ").concat(p),i.stack),c(!1),s.commands.setAIGenerationRunning(!1),s.commands.updateAttributesAtPos(0,{generateStatus:"done"}),(0,l1.Uu)(),r((0,rn.G0)({id:u,status:"error"}));var m=(0,rn.Sn)(u)(o.getState());if(m){var v=m.latency,g=(0,eR.Z)(m,dE);(0,rm.pQ)(dA(dA({},g),{},{errorName:"StreamError",errorMessage:p,errorCode:x,outputMessage:"",latency:v||performance.now()-g.startTime,isResuming:a.isResuming,docId:n}))}d.current&&(p===dT?t.update(d.current,{render:d_,position:"top",duration:null,isClosable:!0}):t.update(d.current,{title:(0,ex.jsx)(h.cC,{id:"sbsGk/"}),status:"error",position:"top",duration:null,isClosable:!0}))},[r,n,l,o,t]),onStreamDone:x,onAbortStream:(0,w.useCallback)(function(e){var n=e.editor,t=e.streamResponse.id;c(!1),n.commands.setAIGenerationRunning(!1),l$.a.trackStreamAbort(o,{interactionId:t,abortReason:"leave-editor"}),r((0,rn.Of)({id:t}))},[r,o])}},dG=function(e){var n=e.streamResponse,t=e.editor,r=e.store,o=e.docId,i=e.theme,s=n.id,a=n.stream,c=!0;return a.pipeThrough(new l3(i)).pipeThrough(new dC(n.id)).pipeThrough(new dl({editor:t,theme:i})).pipeThrough(new lQ.GJ({transform:function(e,n){if("done"===e.event&&"content_filter"===e.finishReason){n.error(Error(dT));return}n.enqueue(e)}})).pipeThrough((0,lX.c1)(function(e){c&&"data"===e.event&&(l$.a.trackStreamStart(r,{interactionId:s,docId:o}),n.isResuming&&(t.commands.deleteCardsAfter(n.lastCompletedCardId||null),n.lastCompletedCardId&&(console.log("[AIStream] refetchLazyImages",n.lastCompletedCardId),di({editor:t,lastCompletedCardId:n.lastCompletedCardId,theme:i}))),c=!1),"data"===e.event&&e.data.cardComplete&&t.commands.updateNestedAttributesAtPos(0,{generateInfo:{lastEventId:e.id,lastCompletedCardId:e.data.id,lastCompletedCardIndex:e.data.index}})}))},dN=t(14198),dZ=function(e){var n=e.toggleToCPanel,t=e.initializeToCPanel,r=e.isToCPanelOpen,o=(0,dN.F)().breakpoints.xl,i=(0,J.CG)($.gh),s=(0,w.useState)(i!==nU.q.SLIDE_VIEW),a=s[0],c=s[1],l=(0,w.useState)(!1),d=l[0];l[1];var u=(0,k.I0)();(0,t_.vm)(function(){t()},[o,n,t,u],[]),(0,t_.vm)(function(){i===nU.q.SLIDE_VIEW?(c(r),n({disableTransition:!1,override:"closed"})):d&&i===nU.q.DOC_VIEW&&n({disableTransition:!1,override:a?"open":"closed"})},[n,r,a,i,d],[i])};function dF(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function dW(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?dF(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):dF(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var dU="doc_archived_warning",dV=function(e,n){var t=(0,eV.p)(),r=(0,S.iX9)(),o=(0,A.Z)(r,1)[0];(0,w.useEffect)(function(){return function(){t.close(dU)}},[]),(0,w.useEffect)(function(){e&&n===tl.Z.COLLABORATIVE&&(e.archived&&!t.isActive(dU)?t({id:dU,title:(0,ex.jsxs)(v.x,{"data-testid":"trash-confirmation-toast",children:[(0,ex.jsx)(h.cC,{id:"fkHPZu"})," ",(0,ex.jsx)(eB.r,{textDecoration:"underline",onClick:function(){var n={id:e.id};o({variables:n,optimisticResponse:{unarchiveDoc:dW(dW({},n),{},{archived:!0,__typename:"Doc"})}})},children:(0,ex.jsx)(h.cC,{id:"7wfwc0"})})]}),status:"warning",position:"top",isClosable:!1,duration:null}):!e.archived&&t.isActive(dU)&&t.close(dU))},[e,n,t,o])},dB=function(){var e=(0,tn.ye)("filmstrip"),n=(0,J.CG)(tu.fh),t=(0,ts.Br)("comment"),r=(0,J.CG)($.gh);return e&&n===tl.Z.COLLABORATIVE&&t&&r===nU.q.DOC_VIEW&&!(0,ri.s2)()},dH=t(20372),dq=t(27910),dK=t(80102),dY=t(50350),dQ=function(){var e=(0,eO.nO)(),n=(0,eO.UV)(),t=(0,iG.i)({base:!1,lg:!0,"2xl":!1}),r=(0,J.CG)($.Hl),o=(0,J.CG)(o5.GX),i=dB(),s=(0,dq.k)(),a=(0,dH.S)((0,f.Z)({base:"0px"},dK.K0,dY.bk))||"0px",c=iN().width;return(0,w.useMemo)(function(){return{"--doc-padding-left":o&&i&&t?"".concat(c,"px"):"0px","--doc-padding-right":r?a:s?"60px":"0px","--present-padding-left":"".concat(e,"px"),"--present-padding-right":"".concat(n,"px"),"--comment-slide-margin":a}},[c,o,e,r,n,s,t,a,i])},dX=t(28615),dJ=t(93665),d$=t(51746),d0=t(95896),d1=function(e){var n=e.launchIntercomUI;return function(e){var t=e.onClose;return(0,ex.jsxs)(m.k,{p:4,color:"white",bg:"yellow.500",borderRadius:"md",alignItems:"center",position:"relative",children:[(0,ex.jsx)(nX.P,{size:"sm",onClick:t,position:"absolute",insetEnd:1,top:1}),(0,ex.jsx)(b.G,{icon:dJ.xH,size:"2x"}),(0,ex.jsxs)(m.k,{direction:"column",ml:3,children:[(0,ex.jsx)(g.xu,{children:(0,ex.jsx)(v.x,{lineHeight:6,fontSize:"sm",children:(0,ex.jsx)(h.cC,{id:"4YARE9",values:{GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc},components:{0:(0,ex.jsx)("b",{})}})})}),(0,ex.jsx)(v.x,{lineHeight:6,fontSize:"sm",pt:2,children:(0,ex.jsx)(h.cC,{id:"Enj8Kw",values:{GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc},components:{0:(0,ex.jsx)(eh.z,{as:eB.r,variant:"link",textDecoration:"underline",fontSize:"sm",onClick:function(){n()},colorScheme:"white"})}})})]})]})}},d2="no-snapshot-warning",d5=function(e,n){var t=(0,d$.G)(),r=(0,eV.p)(),o=(0,d0.z$)(),i=null==e?void 0:e.id,s=n===tl.Z.COLLABORATIVE&&(null==e?void 0:e.currentSnapshotId)===null;(0,w.useEffect)(function(){!s||r.isActive(d2)||(r({id:d2,render:d1({launchIntercomUI:t}),duration:null,position:"top",isClosable:!0}),null==o||o.track(n_.xW.NO_CURRENT_SNAPSHOT,{docId:i}))},[o,i,t,s,r])},d3=function(e){var n=(0,J.TL)(),t=(0,J.CG)(o5.GX),r=(0,w.useRef)(!1);(0,w.useEffect)(function(){!e||r.current||t||(r.current=!0,n((0,o5.dQ)({isOpen:!0})))},[n,t,e])},d4=t(56675),d6=t(21010),d8=t(65185);function d7(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function d9(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?d7(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d7(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var ue=function(e){var n=(0,d4.x)(),t=(0,J.CG)(d8.cn);(0,w.useEffect)(function(){t&&n.cache.updateQuery({query:d6.yE1,variables:{id:e}},function(e){if(!(null!=e&&e.doc))return e;var n=e.doc;return n.titleEdited?e:{doc:d9(d9({},n),{},{title:t})}})},[t,n,e])},un=t(47947),ut=t(46732),ur=function(e,n){var t=(0,ut._)().isUnauthorized;(0,n_.If)(function(r){!0!==t&&void 0!==t&&(r.track(n_.AA.DOC_VIEWED,{doc_id:e}),n===tl.Z.EXAMPLE_STATIC&&r.track(n_.AA.EXAMPLE_VIEWED,{doc_id:e}))},[e,n,t]),(0,un.d)();var r=(0,tn.ye)("realUserMetrics"),o=n===tl.Z.COLLABORATIVE&&r,i=(0,tn.ye)("rumKeystrokeSampleRate");(0,c4.lh)(o,i)},uo=function(e){var n=(0,k.I0)(),t=(0,n_.z$)();(0,w.useEffect)(function(){var r,o=function(){var o=(0,J.bh)().getState();r=(0,$.Q5)(o),(0,c6.I7)(e),n((0,$.lx)({isEditingDisabled:!0})),null==t||t.trackDocEvent(n_.AA.DOC_PRINTED)},i=function(){n((0,$.lx)({isEditingDisabled:!1})),n((0,$.xn)({expandedCardsMap:r}))};return window.addEventListener("beforeprint",o),window.addEventListener("afterprint",i),function(){window.removeEventListener("beforeprint",o),window.removeEventListener("afterprint",i)}},[n,e,t])};function ui(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function us(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ui(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ui(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var ua="doc-root",uc=function(e){var n=e.isConnected;return(0,ex.jsx)(m.k,{flex:1,alignItems:"center",justifyContent:"center",color:"gray.500",fontSize:"2xl",children:n?(0,ex.jsx)(h.cC,{id:"svObPT",values:{GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc}}):(0,ex.jsxs)(m.k,{m:8,alignItems:"center",direction:"row",children:[(0,ex.jsx)(b.G,{icon:p.bK,size:"4x"}),(0,ex.jsx)(v.x,{ml:8,children:(0,ex.jsx)(h.cC,{id:"qercPA",values:{GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc},components:{0:(0,ex.jsx)("strong",{})}})})]})})},ul=function(e){var n=e.doc,t=e.user,r=e.docEditorType,o=(0,I.$m)(n,t),i=(0,k.v9)($.gh),s=r===tl.Z.COLLABORATIVE&&!o,a=s&&i===nU.q.SLIDE_VIEW;return r!==tl.Z.COLLABORATIVE||t?a?(0,ex.jsx)(eb,{}):s?(0,ex.jsx)(D.C,{showTourReplay:!0}):null:(0,ex.jsx)(rH.m,{docWorkspace:null==n?void 0:n.organization})},ud=(0,td.eT)(function(e){var n=e.docEditorType,t=(0,td._i)(),r=t.docId,o=t.isUnauthorized,i=t.setCollaborativeEditorInstance,s=t.editor,a=(0,J.CG)(tu.yx),c=(0,S.$gs)().isConnected,l=(0,nK.SE)().user;(0,P.F3)(),dV(a,n),d5(a,n),dz(r,s),ue(r),ur(r,n),(0,dX.j)(),(0,lY.P)();var d=(0,eD.k)({editor:s,scrollingParentSelector:".".concat(ua)}).editorAnimationsClass;(0,lY.J)(),(0,rQ.Zd)(s,".".concat(ua)),r3(s),(0,tc.V)(),uo(s),(0,I.DD)(a,n===tl.Z.COLLABORATIVE);var u=(0,w.useRef)(null),f=(0,J.TL)(),p=(0,eP.Yy)(),h=(0,w.useMemo)(function(){return(0,nA.vu)(p)},[p]),v=dB();d3(v);var b=dQ(),y=(0,w.useMemo)(function(){return us(us({},h),b)},[h,b]);console.debug("%c[DocEditorComponent] RENDER - ".concat(r),"background-color: gold");var k=(0,eO.Pp)(so.Q),D=k.togglePanel,A=k.isPanelOpen,T=k.initPanel,_=(0,eO.Pp)(t2.s),R=_.togglePanel,L=_.isPanelOpen,z=(0,eO.Pp)(t5.Rr),M=z.togglePanel,G=z.isPanelOpen;(0,t5.QK)({toggleDesignPartnerPanel:M,isDesignPartnerPanelOpen:G,editor:s});var N=(0,eO.Pp)(to);ta({toggleCardNotesPanel:N.togglePanel,isCardNotesPanelOpen:N.isPanelOpen}),dZ({toggleToCPanel:D,isToCPanelOpen:A,initializeToCPanel:T}),(0,w.useEffect)(function(){return function(){f((0,eS.qo)())}},[f]);var Z=(0,w.useCallback)(function(){return!!(s&&s.state.selection.empty)},[s]),F=(0,eO.Xy)(),W=F.leftPanelLifecycle,U=F.rightPanelLifecycle,V=F.globalPanelLifecycle,B=(0,ey.dU)(null==a?void 0:a.organization),H=(0,E.U)(null==a?void 0:a.title,B),q=x.ag._({id:"X6YCwz"}),K=x.ag._({id:"abr3hR"});return(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)("style",{id:"editorStyleOverride",children:"body {overflow: hidden;}"}),(0,ex.jsx)(O(),{children:(0,ex.jsx)("title",{children:H})}),(0,ex.jsx)(t0,{doc:a,editor:s}),(0,ex.jsx)(eI.H9,{isEnabledFn:Z}),o?(0,ex.jsx)(uc,{isConnected:c}):(0,ex.jsxs)(m.k,{id:"doc-main",direction:"row",w:"100%",h:"100%","data-testid":"doc-editor-root",ref:u,children:[(0,ex.jsx)(ew.Av,{panelLifecycle:W}),(0,ex.jsxs)(m.k,{flex:"1",direction:"column",position:"relative",minWidth:"0",h:"100%",children:[(0,ex.jsx)(C.Wk,{isDark:p,children:(0,ex.jsx)(lK,{scrollingParentSelector:".".concat(ua),editorWrapperEl:u.current,docEditorType:n,isToCPanelOpen:A,toggleToCPanel:D,isCommentsPanelOpen:L,toggleCommentsPanel:R})}),(0,ex.jsxs)(g.xu,{flex:"1",overflowY:"auto",overflowX:"hidden",minWidth:"0",h:"100%",className:(0,j.cx)(ua,d,G&&"design-partner-panel-open"),style:{"--ai-editing-label":"'".concat(q,"'"),"--ai-generating-label":"'".concat(K,"'")},sx:y,children:[n===tl.Z.PUBLIC_STATIC?(0,ex.jsx)(r$,{docId:r,snapshotId:null==a?void 0:a.currentSnapshotId,scrollingParentSelector:".".concat(ua),onCreate:i}):n===tl.Z.EXAMPLE_STATIC?(0,ex.jsx)(rY,{docId:r,snapshotId:null==a?void 0:a.currentSnapshotId,scrollingParentSelector:".".concat(ua),onCreate:i}):(0,ex.jsxs)(ek.Mn.Provider,{value:V,children:[(0,ex.jsx)(eE.Ge,{doc:a,docId:r,readOnly:null==a?void 0:a.archived,onCreate:i,scrollingParentSelector:".".concat(ua),animationsExtensionEnabled:!0}),s&&(0,ex.jsx)(nq,{editor:s})]}),(0,ex.jsx)(rM,{editor:s}),(0,ex.jsx)(oB,{editor:s})]})]}),(0,ex.jsx)(ew.U8,{panelLifecycle:U}),(0,ex.jsx)(nT.a,{editorId:"main",children:(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(nD,{editor:s}),(0,ex.jsx)(ul,{doc:a,user:l,docEditorType:n}),v&&(0,ex.jsx)(sr,{})]})})]})]})}),uu=t(56768),uf=t(93031),up=t(59195),uh=t(92488),ux=t(38717),um=t(21496),uv=function(e){var n=e.theme,t=e.onClick,r=e.isChecked,o=e.index,i=e.startIndex;return(0,ex.jsxs)(g.xu,{gridColumnStart:o+1-i,display:i>o?"none":"block",gridRow:1,as:ux.f,p:2,transition:"all 0.2s ease-in-out",bgColor:r?"trueblue.100":"linen.50",textAlign:"left",tabIndex:0,borderRadius:"md",transitionProperty:"common",transitionDuration:"normal",_focus:{boxShadow:r?void 0:"outline"},outline:"none",onClick:t,_hover:{bgColor:r?"trueblue.100":"gray.100"},onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&t()},"data-theme-id":n.id,"data-testid":r?"current-theme-preview":void 0,cursor:"pointer",children:[(0,ex.jsx)(um.n,{theme:n}),(0,ex.jsxs)(ed.K,{direction:"row",spacing:1,pt:1,children:[r&&(0,ex.jsx)(tZ.n,{w:3,h:"auto",mr:1,color:"trueblue.700"}),(0,ex.jsx)(v.x,{fontSize:"sm",noOfLines:1,"data-testid":"theme-name",color:r?"trueblue.700":void 0,children:n.name})]})]})};uv.displayName="DemoDocThemePreview";var ug="linen.50",uj=function(e){var n=e.templateTheme,r=e.setTheme,o=e.currentThemeId,i=(0,k.v9)($.gh)===nU.q.SLIDE_VIEW,s=(0,w.useState)([]),a=s[0],c=s[1],l=(0,w.useState)(!1),d=l[0],u=l[1],f=(0,w.useState)(0),p=f[0],x=f[1],v=(0,iG.i)({base:3,md:4,lg:5})||3;(0,w.useEffect)(function(){t.e(3541).then(t.bind(t,33541)).then(function(e){c(e.GLOBAL_THEMES)})},[]);var g=[].concat((0,oG.Z)(n?[n]:[]),(0,oG.Z)(a.filter(function(e){return e.id!==(null==n?void 0:n.id)}))),j=(0,w.useCallback)(function(e){1===e?x(function(e){return e+1}):x(function(e){return e-1})},[]);return i?(0,ex.jsx)(ex.Fragment,{}):(0,ex.jsx)(eT.h,{children:(0,ex.jsxs)(m.k,{w:"100%",position:"absolute",bottom:0,left:0,bgColor:ug,zIndex:"sticky",direction:"column",borderTop:"3px solid var(--chakra-colors-trueblue-500)",minH:12,p:2,justifyContent:"center",children:[(0,ex.jsx)(m.k,{alignItems:"flex-end",justify:"flex-end",children:(0,ex.jsx)(eh.z,{variant:"ghost",size:"sm",rightIcon:(0,ex.jsx)(b.G,{icon:d?uh.gc:up.on}),onClick:function(){return u(function(e){return!e})},children:d?(0,ex.jsx)(h.cC,{id:"yz7wBu"}):(0,ex.jsx)(h.cC,{id:"x6tIe+"})})}),(0,ex.jsx)(m.k,{justify:"flex-start",align:"flex-start",bgColor:ug,w:"100%",children:d&&(0,ex.jsxs)(ed.K,{direction:"row",align:"center",justify:"center",w:"100%",children:[(0,ex.jsx)(z.h,{"aria-label":"Left",onClick:function(){return j(-1)},variant:"ghost",isDisabled:0===p,icon:(0,ex.jsx)(b.G,{icon:uf.Ey})}),(0,ex.jsx)(r9.r,{w:"100%",flex:1,overflow:"hidden",padding:2,transition:"all 0.2s ease-in-out",templateColumns:["repeat(".concat(v,", calc(100% / ").concat(v," - 1em))")],gap:"0 1em",bgColor:ug,children:g.map(function(e,n){return(0,ex.jsx)(uv,{index:n,startIndex:p,isChecked:e.id===o,theme:e,onClick:function(){r(e)}},e.id)})}),(0,ex.jsx)(z.h,{"aria-label":"Right",variant:"ghost",isDisabled:p+v>g.length,onClick:function(){return j(1)},icon:(0,ex.jsx)(b.G,{icon:uu.yO})})]})})]})})},ub=t(53589),uC=t(68690),uy=t(10344),uO=t(70091),uw=t(88963),uk=[{description:(0,ex.jsx)(h.cC,{id:"gtWy3j"}),shortcut:["←","→"]},{description:(0,ex.jsx)(h.cC,{id:"UCxK2S"}),shortcut:["↑","↓"]},{description:(0,ex.jsx)(h.cC,{id:"IkakN2"}),shortcut:"Esc"},{description:(0,ex.jsx)(h.cC,{id:"CgmvBu"}),shortcut:"S"},{description:(0,ex.jsx)(h.cC,{id:"rEj/lx"}),shortcut:"Enter"},{description:(0,ex.jsx)(h.cC,{id:"dQU33K"}),shortcut:"Mod+Shift+O"},{description:(0,ex.jsx)(h.cC,{id:"K0Oq/D"}),shortcut:"R"}],uS=function(e){var n=lr({editorWrapperEl:e.editorWrapperEl,scrollingParentSelector:e.scrollingParentSelector}),t=n.enterSlideView,r=n.exitSlideView,o=n.setExitedFullscreenByClick,i=n.isFullscreen,s=n.enterFullscreen,a=n.exitFullscreen,c=(0,J.CG)($.gh),l=(0,w.useRef)(c);return(0,w.useEffect)(function(){l.current=c},[c]),(0,ex.jsxs)(ec.U,{children:[(0,ex.jsxs)(tC.h,{isAttached:!0,size:"sm",children:[(0,ex.jsx)(C.kH,{label:c===nU.q.DOC_VIEW?(0,ex.jsx)(h.cC,{id:"ek5OwP",values:{GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc}}):(0,ex.jsx)(h.cC,{id:"43JI0J",values:{GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc}}),children:(0,ex.jsx)(eh.z,{variant:c===nU.q.DOC_VIEW?"solid":"plain",cursor:c===nU.q.SLIDE_VIEW?"pointer":"auto",onClick:function(){c===nU.q.SLIDE_VIEW&&r()},leftIcon:(0,ex.jsx)(b.G,{icon:uC.cw}),children:(0,ex.jsx)(h.cC,{id:"7Zdnlq"})})}),(0,ex.jsx)(C.kH,{label:c===nU.q.SLIDE_VIEW?(0,ex.jsx)(h.cC,{id:"Zfr5aa",values:{GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc}}):(0,ex.jsx)(h.cC,{id:"rK6Cev",values:{GAMMA_ARTIFACT_PROPER_NOUN:eC.Yc}}),children:(0,ex.jsx)(eh.z,{variant:c===nU.q.SLIDE_VIEW?"solid":"plain",cursor:c===nU.q.DOC_VIEW?"pointer":"auto",onClick:function(){c===nU.q.DOC_VIEW&&t({fullscreen:!1})},leftIcon:(0,ex.jsx)(b.G,{icon:ub.bg}),children:(0,ex.jsx)(h.cC,{id:"FOoDGS"})})})]}),c===nU.q.SLIDE_VIEW&&(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(ep.i,{orientation:"vertical"}),(0,ex.jsx)(C.kH,{label:i?(0,ex.jsx)(h.cC,{id:"IkOhTI"}):(0,ex.jsx)(h.cC,{id:"q8ARHN"}),children:(0,ex.jsx)(z.h,{size:"sm","aria-label":i?x.ag._({id:"IkOhTI"}):x.ag._({id:"q8ARHN"}),borderRadius:"md",icon:(0,ex.jsx)(b.G,{icon:i?lu.Qj:ld.TL}),onClick:i?function(){o(!0),a()}:s})}),(0,ex.jsxs)(R.J,{children:[(0,ex.jsx)(L.x,{children:(0,ex.jsx)(eh.z,{size:"sm",variant:"plain",fontWeight:"normal",children:(0,ex.jsx)(h.cC,{id:"77Emn0"})})}),(0,ex.jsxs)(M.y,{border:"1px solid #eee !important",children:[(0,ex.jsx)(uy.Q,{}),(0,ex.jsx)(uO.u,{}),(0,ex.jsx)(G.b,{children:(0,ex.jsx)(uw.A,{list:uk})})]})]})]})]})},uI=(0,w.memo)(function(e){var n=e.scrollingParentSelector,t=e.editorWrapperEl;(0,J.CG)(tu.yx);var r=(0,w.useRef)(null);return(0,ex.jsx)(m.k,{ref:r,bg:"white",borderBottom:"3px solid var(--chakra-colors-trueblue-600)",position:"absolute",zIndex:"overlay",top:0,left:0,right:0,p:2,alignItems:"flex-start",justifyContent:"flex-start",pr:6,children:(0,ex.jsx)(m.k,{direction:"column",w:"100%",children:(0,ex.jsx)(uS,{editorWrapperEl:t,scrollingParentSelector:n})})})}),uP="doc-root",uE=(0,td.eT)(function(e){var n,t=e.docEditorType,r=void 0===t?tl.Z.COLLABORATIVE:t,o=(0,td._i)(),i=o.docId,s=o.setCollaborativeEditorInstance,a=o.editor,c=(0,J.CG)(tu.yx);ur(i,r),(0,dX.j)(),(0,lY.P)(),(0,lY.J)(),(0,rQ.Zd)(a,".".concat(uP)),r3(a),(0,tc.V)(),uo(a),(0,I.DD)(c,r===tl.Z.COLLABORATIVE);var l=(0,w.useRef)(null),d=null==c?void 0:c.theme,u=(0,w.useState)(function(){return d}),f=u[0],p=u[1],h=(0,J.TL)(),x=(0,w.useRef)(!1),v=(0,S.EDv)({variables:{docId:i,snapshotId:null==c?void 0:c.currentSnapshotId},skip:!(null!=c&&c.currentSnapshotId)}).data,j=null==v?void 0:null===(n=v.snapshot)||void 0===n?void 0:n.content.default;console.debug("%c[DemoDocEditorComponent] RENDER - ".concat(i),"background-color: gold"),(0,w.useEffect)(function(){d&&!x.current&&(p(d),x.current=!0)},[d]),(0,w.useEffect)(function(){if(a){var e=null==f?void 0:f.config.accentBackgrounds;if(!e||0===e.length){j&&a.commands.setContent(j);return}a.commands.updateThemeAccentImages(e)}},[a,f,j]);var b=(0,eO.Pp)(so.Q);dZ({toggleToCPanel:b.togglePanel,isToCPanelOpen:b.isPanelOpen,initializeToCPanel:b.initPanel}),(0,w.useEffect)(function(){return function(){h((0,eS.qo)())}},[h]);var C=(0,eO.Xy)(),y=C.leftPanelLifecycle;return C.globalPanelLifecycle,(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)("style",{id:"editorStyleOverride",children:"body {overflow: hidden;}"}),(0,ex.jsx)(O(),{children:(0,ex.jsxs)("title",{children:["".concat(c?(0,cu.$)(c.title)+" | ":""),"Gamma"]})}),(0,ex.jsxs)(m.k,{id:"doc-main",direction:"row",w:"100%",h:"100%","data-testid":"doc-editor-root",ref:l,children:[(0,ex.jsx)(ew.Av,{panelLifecycle:y}),(0,ex.jsxs)(m.k,{flex:"1",direction:"column",position:"relative",minWidth:"0",h:"100%",children:[a&&(0,ex.jsx)(uI,{scrollingParentSelector:".".concat(uP),editorWrapperEl:l.current,setTheme:p,currentThemeId:(null==f?void 0:f.id)||(null==d?void 0:d.id),templateTheme:d}),(0,ex.jsxs)(g.xu,{flex:"1",overflowY:"auto",overflowX:"hidden",minWidth:"0",h:"100%",className:uP,children:[(0,ex.jsx)(r$,{docId:i,snapshotId:null==c?void 0:c.currentSnapshotId,scrollingParentSelector:".".concat(uP),onCreate:s,theme:f,hideMadeWithGammaBadge:!0}),(0,ex.jsx)(oB,{editor:a,showNavigationControls:!0})]})]}),(0,ex.jsx)(nD,{editor:a}),(0,ex.jsx)(uj,{setTheme:p,currentThemeId:(null==f?void 0:f.id)||(null==d?void 0:d.id),templateTheme:d})]})]})}),uD=t(1005),uA=t(86633),uT="body",u_=t(55580),uR=t(56648),uL=t(46663),uz=t(60670),uM=function(e){var n=(0,dw.As)(e),t=(0,w.useState)("up"),r=t[0],o=t[1];return(0,w.useEffect)(function(){var e=document.querySelector(n.scrollSelector);if(e){var t=(null==e?void 0:e.scrollTop)||0,r=function(){var n=(null==e?void 0:e.scrollTop)||0;Math.abs(n-t)>0&&(o(!(n>t)||t>0&&0===n||n>0&&0===t?"up":"down"),t=n>0?n:0)},i=K()(function(){return window.requestAnimationFrame(r)},500,{leading:!0});return null==e||e.addEventListener("scroll",i),function(){return null==e?void 0:e.removeEventListener("scroll",i)}}},[n.scrollSelector]),r},uG=t(26806),uN=["icon","children"];function uZ(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function uF(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?uZ(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):uZ(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var uW=(0,w.memo)(function(){return(0,ex.jsx)(g.xu,{w:"100%",h:"1px",bg:"gray.200",my:2,mx:-2,_first:{display:"none"},_last:{display:"none"}})});uW.displayName="MenuDivider";var uU=(0,w.memo)(function(e){var n=e.icon,t=e.children,r=(0,eR.Z)(e,uN);return(0,ex.jsx)(g.xu,uF(uF({as:"button",w:"100%",textAlign:"left",px:2,py:2,fontWeight:"500",color:"gray.700",transition:"all 0.2s",_hover:{bg:"gray.100"},_focus:{outline:"none"},_active:{bg:"gray.200"},borderRadius:"md"},r),{},{children:(0,ex.jsxs)(ec.U,{children:[n&&(0,ex.jsx)(g.xu,{children:n}),(0,ex.jsx)(g.xu,{children:t})]})}))});uU.displayName="MenuItem";var uV=function(e){var n,t,r=e.isOpen,o=e.onClose,i=e.doc,s=e.editingEnabled,a=(0,nK.SE)().user,c=(0,S.$gs)().isConnected,l=(0,rZ.e)(),d=(0,td._i)().editor,u=(0,cu.$)(null==i?void 0:i.title),f=(null==i?void 0:i.createdTime)&&(0,cQ.Z)((0,cX.Z)(i.createdTime),"PPP"),p=null==i?void 0:i.id,x=(0,tX.M)({id:"analyticsPanelDisclosure"}),g=x.isOpen,j=x.onClose,y=x.onOpen,O=(0,S.LT4)(),k=(0,A.Z)(O,1)[0],I=(0,S.iX9)(),P=(0,A.Z)(I,1)[0],E=(0,n_.z$)(),D=(0,nK.py)("manage",i)&&!!a,T=(0,nK.py)("manage",i)&&!!a,_=(0,tn.ye)("pageSetup")&&s,R=!!(a&&0!==a.workspaceMemberships.length),L=(0,tn.ye)("docFormats"),z=(0,w.useCallback)((0,tf.Z)(th().mark(function e(){var n;return th().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=2;break}return e.abrupt("return");case 2:return n=d.getJSON(),e.next=5,l({docId:p,initialContent:n,source:"editor_toolbar_doc_menu_duplicate",newWindow:!1});case 5:o();case 6:case"end":return e.stop()}},e)})),[p,l,d,o]),M=(0,w.useCallback)(function(){null==E||E.track(n_.AA.DOC_ANALYTICS_VIEWED,{docId:p,source:"toolbar_doc_menu",type:"personal"}),y()},[E,p,y]),G=(0,w.useCallback)(function(e){return function(){if(p){var n={id:p};e?k({variables:n,optimisticResponse:{archiveDoc:uF(uF({},n),{},{archived:e,__typename:"Doc"})}}):P({variables:n,optimisticResponse:{unarchiveDoc:uF(uF({},n),{},{archived:e,__typename:"Doc"})}})}}},[k,p,P]);return(0,ex.jsxs)(ex.Fragment,{children:[i&&(0,ex.jsx)(C.Aj,{isOpen:r,onClose:o,children:(0,ex.jsxs)(m.k,{w:"100%",h:r?"100%":void 0,direction:"column",children:[(0,ex.jsxs)(ec.U,{align:"flex-start",p:6,children:[(0,ex.jsxs)(ed.K,{spacing:0,children:[(0,ex.jsx)(v.x,{fontSize:"2xl",fontWeight:"bold",letterSpacing:"tight",noOfLines:6,children:u}),(0,ex.jsx)(v.x,{fontSize:"sm",color:"gray.500",noOfLines:1,children:(0,ex.jsx)(h.cC,{id:"jlWdji",values:{createdTime:f}})}),(0,ex.jsx)(C.kH,{label:null==i?void 0:null===(n=i.createdBy)||void 0===n?void 0:n.email,children:(0,ex.jsx)(v.x,{display:"inline-block",fontSize:"sm",color:"gray.500",noOfLines:1,children:(0,ex.jsx)(h.cC,{id:"t490IT",values:{0:null==i?void 0:null===(t=i.createdBy)||void 0===t?void 0:t.displayName}})})})]}),(0,ex.jsx)(ss.L,{}),(0,ex.jsx)(nX.P,{mt:-2,onClick:function(e){e.stopPropagation(),o()}})]}),(0,ex.jsxs)(ed.K,{p:3,pt:0,children:[L&&(0,ex.jsx)(c1,{}),(0,ex.jsx)(uW,{}),T&&(0,ex.jsx)(uU,{icon:(0,ex.jsx)(b.G,{icon:t3.nN,fixedWidth:!0}),onClick:function(){o(),cc.T.emit("openSharePanel",{view:"invite"})},children:(0,ex.jsx)(h.cC,{id:"iyga2M"})}),s&&(0,ex.jsx)(uU,{icon:(0,ex.jsx)(b.G,{icon:lT.q2,fixedWidth:!0}),onClick:function(){o(),cc.T.emit("toggleThemeBlock",!0)},"data-testid":"mobile-theme-button",children:(0,ex.jsx)(h.cC,{id:"W15e8B"})}),(0,ex.jsx)(uW,{}),c&&(0,ex.jsxs)(ex.Fragment,{children:[!!a&&T&&(0,ex.jsx)(uU,{icon:(0,ex.jsx)(b.G,{icon:su.M,fixedWidth:!0}),onClick:function(){o(),M()},children:(0,ex.jsx)(h.cC,{id:"qcxxQS"})}),R&&(0,ex.jsx)(uU,{icon:(0,ex.jsx)(b.G,{icon:io.kZ,fixedWidth:!0}),onClick:z,children:(0,ex.jsx)(h.cC,{id:"euc6Ns"})}),D&&(0,ex.jsx)(uU,{icon:(0,ex.jsx)(b.G,{icon:cK.kw,fixedWidth:!0}),onClick:function(){o(),cc.T.emit("openSharePanel",{view:"export"})},children:(0,ex.jsx)(h.cC,{id:"U8WPSi"})}),_&&(0,ex.jsx)(uU,{icon:(0,ex.jsx)(b.G,{icon:cq.gr,fixedWidth:!0}),onClick:function(){o(),cc.T.emit("openPageSetup","cards")},children:(0,ex.jsxs)(ec.U,{children:[(0,ex.jsx)(h.cC,{id:"Kx2GmY"}),(0,ex.jsx)(ss.L,{}),(0,ex.jsx)(cY.C,{colorScheme:"green",ml:2,children:(0,ex.jsx)(h.cC,{id:"isRobC"})})]})}),T&&(0,ex.jsx)(uW,{}),T?i.archived?(0,ex.jsx)(uU,{icon:(0,ex.jsx)(b.G,{icon:cV.Ze,fixedWidth:!0}),onClick:G(!1),children:(0,ex.jsx)(h.cC,{id:"yKu/3Y"})}):(0,ex.jsx)(uU,{"data-testid":"doc-menu-trash-button",color:"red.500",icon:(0,ex.jsx)(b.G,{icon:eZ.$,fixedWidth:!0}),onClick:G(!0),children:(0,ex.jsx)(h.cC,{id:"1C/Yjq"})}):null]})]})]})}),i&&g&&(0,ex.jsx)(ca,{doc:i,isAnalyticsPanelOpen:g,onAnalyticsPanelClose:j,mode:"full"}),_&&(0,ex.jsx)(ls.T,{editor:d}),s&&(0,ex.jsx)(lN,{})]})};function uB(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function uH(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?uB(Object(t),!0).forEach(function(n){(0,f.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):uB(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var uq=function(e){var n,t,r,o=e.doc,i=e.editor,s=e.commentsEnabled,a=e.editingEnabled,c=e.onCommentFeedOpen,l=e.onTocOpen,d=(0,cO.X)(en.H.lastHomeUrl,"/"),u=(0,A.Z)(d,1)[0],f=(0,nK.SE)().user,p=(0,nK.py)("manage",o),h=(null==o?void 0:null===(n=o.comments)||void 0===n?void 0:n.filter(function(e){return e.status===S.Ux9.Open}).length)||0,x=uM("editor"),m=(0,k.v9)($.Pu),g=(0,uG.Jh)(m),j=null!==(t=m.config.bodyColor)&&void 0!==t?t:(0,tS.wj)(m)?"white":"gray.800",C=null!==(r=m.accentColor)&&void 0!==r?r:(0,tS.wj)(m)?"trueblue.300":"trueblue.700",y=(0,w.useCallback)(function(){i&&i.commands.undo()},[i]),O=(0,_.q)(),I=O.isOpen,P=O.onOpen,E=O.onClose;return o?(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(uV,{doc:o,isOpen:I,onClose:E,editingEnabled:a}),(0,ex.jsxs)(ec.U,{p:1,px:2,bg:"gray.50",shadow:"lg",position:"sticky",top:0,transitionProperty:"common",transitionDuration:"normal",transform:"up"==x?"translate(0px,0px)":"translate(0px,-100%)",opacity:"up"==x?1:0,zIndex:"sticky",sx:uH(uH({},(0,uG.Oj)(g,m,!0)),{},{border:"none",filter:"none",borderRadius:0}),color:j,children:[f&&(0,ex.jsx)(re(),{href:u,passHref:!0,legacyBehavior:!0,children:(0,ex.jsx)(z.h,{as:eB.r,"aria-label":"Home",color:j,_hover:{bg:"transparent",color:C},icon:(0,ex.jsx)(b.G,{icon:ch.J9,size:"1x"}),variant:"ghost"})}),(0,ex.jsx)(v.x,{flex:1,fontSize:"sm",noOfLines:1,ml:2,color:j,children:null==o?void 0:o.title}),(0,ex.jsxs)(tC.h,{variant:"ghost",children:[s&&(0,ex.jsx)(eh.z,{color:j,_hover:{bg:"transparent",color:C},fontSize:"sm",onClick:c,leftIcon:(0,ex.jsx)(b.G,{icon:uz.Mz}),children:h}),a&&(0,ex.jsx)(z.h,{color:j,"aria-label":"Undo",onClick:y,_hover:{bg:"transparent",color:C},icon:(0,ex.jsx)(b.G,{icon:uL.X7})}),!a&&(0,ex.jsx)(z.h,{color:j,"aria-label":"Open table of contents",_hover:{bg:"transparent",color:C},onClick:l,icon:(0,ex.jsx)(b.G,{icon:uR.xi})}),(p||a)&&(0,ex.jsx)(z.h,{color:j,"aria-label":"Open toolbar",_hover:{bg:"transparent",color:C},onClick:P,icon:(0,ex.jsx)(b.G,{icon:u_.faEllipsis})})]})]})]}):null},uK=function(e){var n=e.doc,t=e.docEditorType,r=e.commentsEnabled,o=void 0===r||r,i=(0,td._i)(),s=i.docId,a=i.setCollaborativeEditorInstance,c=i.editor,l=(0,_.q)({id:"mobile-comment-feed-panel-drawer"}),d=l.isOpen,u=l.onOpen,f=l.onClose,p=(0,_.q)({id:"mobile-toc-drawer"}),h=p.isOpen,x=p.onOpen,v=p.onClose,g=(0,w.useState)(null),j=g[0],b=g[1];console.debug("%c[MobileEditorWrapper] RENDER - ".concat(s),"background-color: gold");var y=(0,tn.ye)("mobileEditing"),O=(0,nK.py)("edit",n),k=y&&O;return(0,ex.jsxs)(m.k,{ref:(0,w.useCallback)(function(e){return b(e)},[]),direction:"column",flex:1,children:[(0,ex.jsx)(uq,{doc:n,editor:c,onCommentFeedOpen:u,commentsEnabled:!k&&o,editingEnabled:k,onTocOpen:x}),t===tl.Z.PUBLIC_STATIC?(0,ex.jsx)(r$,{docId:s,snapshotId:null==n?void 0:n.currentSnapshotId,scrollingParentSelector:uT,onCreate:a}):t===tl.Z.EXAMPLE_STATIC?(0,ex.jsx)(rY,{docId:s,snapshotId:null==n?void 0:n.currentSnapshotId,scrollingParentSelector:uT,onCreate:a}):(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(eE.Ge,{doc:n,docId:s,readOnly:!k,onCreate:a,scrollingParentSelector:uT}),c&&(0,ex.jsx)(nq,{editor:c})]}),o&&d&&(0,ex.jsx)(C.Aj,{isOpen:d,onClose:f,drawerProps:{autoFocus:!1},children:(0,ex.jsx)(uD.m,{onClose:f,editor:c})}),h&&(0,ex.jsx)(C.Aj,{isOpen:h,onClose:v,children:(0,ex.jsx)(uA.o,{rootElement:j,handleClose:v})}),(0,ex.jsx)(lE,{doc:n,showButton:!1}),(0,ex.jsx)(nT.a,{children:(0,ex.jsx)(rM,{editor:c})})]})},uY=(0,td.eT)(function(e){var n=e.docEditorType,t=(0,td._i)(),r=t.docId,o=t.isUnauthorized,i=t.editor;ur(r,n),dz(r,i),(0,dX.j)();var s=(0,w.useRef)(null),a=(0,J.CG)(tu.yx);console.debug("%c[MobileDocViewerComponent] RENDER - ".concat(r),"background-color: gold");var c=n===tl.Z.COLLABORATIVE;return(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsxs)(O(),{children:[(0,ex.jsxs)("title",{children:["".concat(a?(0,cu.$)(a.title)+" | ":""),"Gamma"]}),(0,ex.jsx)("meta",{name:"viewport",content:"width=device-width, user-scalable=no"})]}),(0,ex.jsx)(lg.Global,{styles:{html:{overflowX:"hidden"},body:{overflow:"hidden scroll",WebkitOverflowScrolling:"touch"}}}),o?(0,ex.jsxs)(m.k,{flex:1,alignItems:"center",justifyContent:"center",color:"gray.500",fontSize:"2xl",p:6,textAlign:"center",children:["It looks like you don't have access to this"," ",eC.Yc,"."]}):(0,ex.jsx)(m.k,{id:"doc-main",direction:"column",w:"100%",h:"100%","data-testid":"doc-editor-root",ref:s,flex:"1",children:(0,ex.jsx)(uK,{doc:a,docEditorType:n,commentsEnabled:c})})]})})},47827:function(e,n,t){t.d(n,{AA:function(){return h},DN:function(){return f},mb:function(){return p}});var r=t(20406),o=t(28526),i=t.n(o),s=t(5632),a=t(2784),c=t(46358),l=t(42879),d=t(62141),u=t(6985),f=(0,a.createContext)({openPageSetup:function(e,n){},openSharePanel:function(e,n){}}),p=function(e,n){var t=(0,s.useRouter)().push,o=(0,c.qr)();return(0,a.useMemo)(function(){var s,a;return{openPageSetup:(s=(0,r.Z)(i().mark(function r(s,a){var c,f;return i().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n){r.next=2;break}return r.abrupt("return");case 2:if(c=function(){return u.T.emit("openPageSetup",a)},!(s!==e)){r.next=9;break}return r.next=6,t((0,l.as)(n,s));case 6:f=o.subscribe(function(){(0,d.ke)(o.getState())===s&&(c(),f())}),r.next=10;break;case 9:c();case 10:case"end":return r.stop()}},r)})),function(e,n){return s.apply(this,arguments)}),openSharePanel:(a=(0,r.Z)(i().mark(function r(s,a){var c,f;return i().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n){r.next=2;break}return r.abrupt("return");case 2:if(c=function(){return u.T.emit("openSharePanel",a)},!(s!==e)){r.next=9;break}return r.next=6,t((0,l.as)(n,s));case 6:f=o.subscribe(function(){(0,d.ke)(o.getState())===s&&(c(),f())}),r.next=10;break;case 9:c();case 10:case"end":return r.stop()}},r)})),function(e,n){return a.apply(this,arguments)})}},[e,t,n,o])},h=function(){return(0,a.useContext)(f)}},28916:function(e,n,t){t.d(n,{V:function(){return i}});var r=t(2784),o="drag-in-progress",i=function(){(0,r.useEffect)(function(){var e=function(){document.body.classList.add(o)},n=function(){document.body.classList.remove(o)};return document.body.addEventListener("dragstart",e,!0),document.body.addEventListener("dragend",n,!0),document.body.addEventListener("drop",n,!0),document.body.addEventListener("mouseup",n,!0),function(){document.body.removeEventListener("dragstart",e,!0),document.body.removeEventListener("dragend",n,!0),document.body.removeEventListener("drop",n,!0),document.body.removeEventListener("mouseup",n,!0)}},[])}}}]);
//# sourceMappingURL=9898-fda8f50ffdb57556.js.map